{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"factoryName": {
			"type": "string",
			"metadata": "Data Factory name",
			"defaultValue": "mcsh-data-factory"
		},
		"AzureMySql1_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'AzureMySql1'"
		},
		"AzureMySql_allEmployee_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'AzureMySql_allEmployee'"
		},
		"Azure_DWH_Dynamic_password": {
			"type": "secureString",
			"metadata": "Secure string for 'password' of 'Azure_DWH_Dynamic'"
		},
		"Azure_DWH_HR_link_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'Azure_DWH_HR_link'"
		},
		"Azure_DWH_Hr_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'Azure_DWH_Hr'"
		},
		"Azure_MySql_DWH_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'Azure_MySql_DWH'"
		},
		"GitHubMcsDWH_credential": {
			"type": "secureString",
			"metadata": "Secure string for 'credential' of 'GitHubMcsDWH'"
		},
		"MCS_FMCG_DWH_MainDB_password": {
			"type": "secureString",
			"metadata": "Secure string for 'password' of 'MCS_FMCG_DWH_MainDB'"
		},
		"MCS_FMCG_DWH_SqlServerConn_password": {
			"type": "secureString",
			"metadata": "Secure string for 'password' of 'MCS_FMCG_DWH_SqlServerConn'"
		},
		"MCS_HR_GreenERP_SC_password": {
			"type": "secureString",
			"metadata": "Secure string for 'password' of 'MCS_HR_GreenERP_SC'"
		},
		"MCS_HR_GreenERP_Source_password": {
			"type": "secureString",
			"metadata": "Secure string for 'password' of 'MCS_HR_GreenERP_Source'"
		},
		"Merchant_DataService_DB_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'Merchant_DataService_DB'"
		},
		"Oracle1_password": {
			"type": "secureString",
			"metadata": "Secure string for 'password' of 'Oracle1'"
		},
		"linkedService1_accountKey": {
			"type": "secureString",
			"metadata": "Secure string for 'accountKey' of 'linkedService1'"
		},
		"ADLS_FMCS_RAW_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://mcsdatalake.dfs.core.windows.net/"
		},
		"AzureDataLakeStorage1_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://mcsdatalake.dfs.core.windows.net/"
		},
		"AzureSqlDatabase1_properties_typeProperties_server": {
			"type": "string",
			"defaultValue": "datawerehouseserver.database.windows.net"
		},
		"AzureSqlDatabase1_properties_typeProperties_database": {
			"type": "string",
			"defaultValue": "mcsholdingdw"
		},
		"AzureSqlDw_properties_typeProperties_server": {
			"type": "string",
			"defaultValue": "datawerehouseserver.database.windows.net"
		},
		"AzureSqlDw_properties_typeProperties_database": {
			"type": "string",
			"defaultValue": "mcsholdingdw"
		},
		"Azure_DWH_Dynamic_properties_typeProperties_server": {
			"type": "string",
			"defaultValue": "mcsholdingdwh.mysql.database.azure.com"
		},
		"Azure_DWH_Dynamic_properties_typeProperties_database": {
			"type": "string",
			"defaultValue": "@{linkedService().database}"
		},
		"Azure_DWH_Dynamic_properties_typeProperties_username": {
			"type": "string",
			"defaultValue": "mcsholdingdwh"
		},
		"GitHubMcsDWH_properties_typeProperties_username": {
			"type": "string",
			"defaultValue": "lchuka1619@gmail.com"
		},
		"MCS_FMCG_DWH_MainDB_properties_typeProperties_server": {
			"type": "string",
			"defaultValue": "192.168.244.16"
		},
		"MCS_FMCG_DWH_MainDB_properties_typeProperties_database": {
			"type": "string",
			"defaultValue": "MAIN_DB"
		},
		"MCS_FMCG_DWH_MainDB_properties_typeProperties_userName": {
			"type": "string",
			"defaultValue": "TumurOchir"
		},
		"MCS_FMCG_DWH_SqlServerConn_properties_typeProperties_server": {
			"type": "string",
			"defaultValue": "192.168.244.16"
		},
		"MCS_FMCG_DWH_SqlServerConn_properties_typeProperties_database": {
			"type": "string",
			"defaultValue": "QVReports"
		},
		"MCS_FMCG_DWH_SqlServerConn_properties_typeProperties_userName": {
			"type": "string",
			"defaultValue": "TumurOchir"
		},
		"MCS_HR_GreenERP_SC_properties_typeProperties_server": {
			"type": "string",
			"defaultValue": "green-erp-db.ca0tieoyjuvl.ap-east-1.rds.amazonaws.com:1521/ORCL"
		},
		"MCS_HR_GreenERP_SC_properties_typeProperties_username": {
			"type": "string",
			"defaultValue": "hrms_prod"
		},
		"MCS_HR_GreenERP_Source_properties_typeProperties_server": {
			"type": "string",
			"defaultValue": "green-erp-db.ca0tieoyjuvl.ap-east-1.rds.amazonaws.com:1521:ORCL"
		},
		"MCS_HR_GreenERP_Source_properties_typeProperties_database": {
			"type": "string",
			"defaultValue": "ORCL"
		},
		"MCS_HR_GreenERP_Source_properties_typeProperties_userName": {
			"type": "string",
			"defaultValue": "V_BI_MCSG"
		},
		"Oracle1_properties_typeProperties_server": {
			"type": "string",
			"defaultValue": "green-erp-db.ca0tieoyjuvl.ap-east-1.rds.amazonaws.com/orcl"
		},
		"Oracle1_properties_typeProperties_username": {
			"type": "string",
			"defaultValue": "hrms_prod"
		},
		"linkedService1_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://mcsdatalake.dfs.core.windows.net/"
		},
		"linkedService_err_properties_typeProperties_serviceEndpoint": {
			"type": "string",
			"defaultValue": "https://mcsdatalake.blob.core.windows.net/"
		},
		"5min Trigger_properties_AG_Order_1d_Ago_Extract_CSV_parameters_windowStart": {
			"type": "string",
			"defaultValue": "@{addhours(trigger().scheduledTime, -24)}"
		},
		"5min Trigger_properties_AG_Order_1d_Ago_Extract_CSV_parameters_windowEnd": {
			"type": "string",
			"defaultValue": "@trigger().scheduledTime"
		},
		"Daily Morning_properties_AG_MainDB_to_Raw_parameters_main_directory": {
			"type": "string",
			"defaultValue": "ag_dwh_sink"
		},
		"Daily Morning_properties_AG_Order_1d_Ago_Extract_CSV_parameters_windowStart": {
			"type": "string",
			"defaultValue": "@{addhours(trigger().scheduledTime, -24)}"
		},
		"Daily Morning_properties_AG_Order_1d_Ago_Extract_CSV_parameters_windowEnd": {
			"type": "string",
			"defaultValue": "@trigger().scheduledTime"
		},
		"Daily Morning_properties_CC_MainDB_to_Raw_parameters_main_directory": {
			"type": "string",
			"defaultValue": "cc_dwh_sink"
		},
		"Daily Morning_properties_TD_MainDB_to_Raw_parameters_main_directory": {
			"type": "string",
			"defaultValue": "td_dwh_sink"
		},
		"Daily Morning_properties_CC_Small_Tables_Full_Extract_parameters_main_directory": {
			"type": "string",
			"defaultValue": "cc_dwh_sink"
		},
		"Daily Morning_properties_TD_Customer_Full_Flow_parameters_src_customer_table": {
			"type": "string",
			"defaultValue": "BigOneFullCustomers_D"
		},
		"Daily Morning_properties_TD_Customer_Full_Flow_parameters_src_tradeshop_gps_table": {
			"type": "string",
			"defaultValue": "TradeshopGPS_TD"
		},
		"Daily Morning_properties_TD_Customer_Full_Flow_parameters_dest_folder": {
			"type": "string",
			"defaultValue": "td_dwh_sink"
		},
		"Daily Morning_properties_TD_Customer_Full_Flow_parameters_dest_customer_file": {
			"type": "string",
			"defaultValue": "td_dwh_full_customer.csv"
		},
		"Daily Morning_properties_TD_Customer_Full_Flow_parameters_dest_gps_file": {
			"type": "string",
			"defaultValue": "td_dwh_full_trade_shop_gps.csv"
		},
		"NightTrigger_properties_pl_evs_allemployee_UpsertTrigger_parameters_windowStart": {
			"type": "string",
			"defaultValue": "utcNow()"
		},
		"NightTrigger_properties_pl_evs_allemployee_UpsertTrigger_parameters_windowEnd": {
			"type": "string",
			"defaultValue": "addMinutes(utcNow(), 35)"
		},
		"Trigger_qd9_properties_GreenERP_HREmployee_parameters_windowStart": {
			"type": "string",
			"defaultValue": "@{addhours(trigger().scheduledTime, -24)}"
		},
		"Trigger_qd9_properties_GreenERP_HREmployee_parameters_windowEnd": {
			"type": "string",
			"defaultValue": "@trigger().scheduledTime"
		}
	},
	"variables": {
		"factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('factoryName'), '/ADLS_Staging_ALLEPLOYEE')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ADLS_Staging_SIGRADE",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "ADLS_Staging_SIGRADE",
								"type": "DataFlowReference",
								"parameters": {
									"cwfilename": "\"SIGRADE\""
								},
								"datasetParameters": {
									"source1": {
										"cwfolder": "GreenErp",
										"cwfilename": "SIGRADE.csv"
									},
									"sink1": {
										"cwfolder": "SIGRADE"
									}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "HR Pipelines/EVS"
				},
				"annotations": [],
				"lastPublishTime": "2025-11-19T10:54:57Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/dataflows/ADLS_Staging_SIGRADE')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ADLS_Staging_HREmployee')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ADLS_Staging",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "ADLS_Staging_employee",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"source1": {
										"cwfolder": "GreenErp",
										"cwfilename": "HREMPLOYEE.csv"
									},
									"sink1": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"windowStart": {
						"type": "String"
					},
					"windowEnd": {
						"type": "String"
					},
					"main_directory": {
						"type": "String",
						"defaultValue": "GreenErp"
					},
					"cwfolder": {
						"type": "string",
						"defaultValue": "GreenErp"
					},
					"cwfilename": {
						"type": "string",
						"defaultValue": "HREMPLOYEE.csv"
					}
				},
				"folder": {
					"name": "HR Pipelines/DW_Mysql"
				},
				"annotations": [],
				"lastPublishTime": "2025-11-27T09:26:11Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/dataflows/ADLS_Staging_employee')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ADLS_Staging_SIDEPARTMENTTYPE')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ADLS_Staging_TBLPOSITION",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "ADLS_Staging_TBLPOSITION",
								"type": "DataFlowReference",
								"parameters": {
									"cwfilename": "\"TBLPOSITION\""
								},
								"datasetParameters": {
									"source1": {
										"cwfolder": "GreenErp",
										"cwfilename": "TBLPOSITION.csv"
									},
									"sink1": {
										"cwfolder": "TBLPOSITION"
									}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "HR Pipelines/DW_Mysql"
				},
				"annotations": [],
				"lastPublishTime": "2025-11-27T09:26:10Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/dataflows/ADLS_Staging_TBLPOSITION')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ADLS_Staging_SIGRADE')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ADLS_Staging_SIGRADE",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "ADLS_Staging_SIGRADE",
								"type": "DataFlowReference",
								"parameters": {
									"cwfilename": "\"SIGRADE\""
								},
								"datasetParameters": {
									"source1": {
										"cwfolder": "GreenErp",
										"cwfilename": "SIGRADE.csv"
									},
									"sink1": {
										"cwfolder": "SIGRADE"
									}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "HR Pipelines/DW_Mysql"
				},
				"annotations": [],
				"lastPublishTime": "2025-11-27T09:26:10Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/dataflows/ADLS_Staging_SIGRADE')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ADLS_Staging_SILEVEL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ADLS_Staging_SILEVEL",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "ADLS_Staging_SILEVEL",
								"type": "DataFlowReference",
								"parameters": {
									"cwfilename": "\"SILEVEL\""
								},
								"datasetParameters": {
									"source1": {
										"cwfolder": "GreenErp",
										"cwfilename": "SILEVEL.csv"
									},
									"sink1": {
										"cwfolder": "SILEVEL"
									}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "HR Pipelines/DW_Mysql"
				},
				"annotations": [],
				"lastPublishTime": "2025-11-27T09:26:10Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/dataflows/ADLS_Staging_SILEVEL')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ADLS_Staging_TBLCOMPANY')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ADLS_Staging_TBLCOMPANY",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "ADLS_Staging_TBLCOMPANY",
								"type": "DataFlowReference",
								"parameters": {
									"cwfilename": "\"TBLCOMPANY\""
								},
								"datasetParameters": {
									"source1": {
										"cwfolder": "GreenErp",
										"cwfilename": "TBLCOMPANY.csv"
									},
									"sink1": {
										"cwfolder": "TBLCOMPANY"
									}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "HR Pipelines/DW_Mysql"
				},
				"annotations": [],
				"lastPublishTime": "2025-11-27T09:26:11Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/dataflows/ADLS_Staging_TBLCOMPANY')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ADLS_Staging_TBLDEPARTMENT')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ADLS_Staging_TBLDEPARTMENT",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "ADLS_Staging_TBLDEPARTMENT",
								"type": "DataFlowReference",
								"parameters": {
									"cwfilename": "\"TBLCOMPANY\""
								},
								"datasetParameters": {
									"source1": {
										"cwfolder": "GreenErp",
										"cwfilename": "TBLDEPARTMENT.csv"
									},
									"sink1": {
										"cwfolder": "TBLDEPARTMENT"
									}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "HR Pipelines/DW_Mysql"
				},
				"annotations": [],
				"lastPublishTime": "2025-11-27T09:26:10Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/dataflows/ADLS_Staging_TBLDEPARTMENT')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ADLS_Staging_TBLPOSITION')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ADLS_Staging_TBLPOSITION",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "ADLS_Staging_TBLPOSITION",
								"type": "DataFlowReference",
								"parameters": {
									"cwfilename": "\"TBLPOSITION\""
								},
								"datasetParameters": {
									"source1": {
										"cwfolder": "GreenErp",
										"cwfilename": "TBLPOSITION.csv"
									},
									"sink1": {
										"cwfolder": "TBLPOSITION"
									}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "HR Pipelines/DW_Mysql"
				},
				"annotations": [],
				"lastPublishTime": "2025-11-27T09:26:11Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/dataflows/ADLS_Staging_TBLPOSITION')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AG_Customer_Full_Flow')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "AG_Customer_Raw_to_Filtered",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "TradeshopGPS_DBToCSV",
								"dependencyConditions": [
									"Completed"
								]
							},
							{
								"activity": "Customer_DBToCSV",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "AG_Customer_Raw_to_Filtered",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"agRawFullCustomerCSV": {
										"csv_fileName": "ag_dwh_full_customer.csv",
										"csv_directory": "ag_dwh_sink"
									},
									"agRawTradeShopGpsCSV": {
										"csv_fileName": "ag_dwh_full_trade_shop_gps.csv",
										"csv_directory": "ag_dwh_sink"
									},
									"agFilteredCSV": {
										"csv_directory": "ag_dwh_filtered",
										"csv_fileName": "ag_dwh_customer_full.csv"
									}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "None",
							"cacheSinks": {
								"firstRowOnly": true
							}
						}
					},
					{
						"name": "AG_Customer_Filtered_to_DWH",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "AG_Customer_Raw_to_Filtered",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "AG_Customer_Filtered_to_DWH",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"agCustomerFiltered": {
										"csv_directory": "ag_dwh_filtered",
										"csv_fileName": "ag_dwh_customer_full.csv"
									},
									"agCustomerDWH": {
										"cw_table": "ag_dwh_customer"
									},
									"agTradeShopDWH": {
										"cw_table": "ag_dwh_trade_shop"
									}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "None",
							"cacheSinks": {
								"firstRowOnly": true
							}
						}
					},
					{
						"name": "Customer_DBToCSV",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": {
									"value": "select\n    CusID,\n    REPLACE(REPLACE(CusName, CHAR(10), ''), CHAR(13), '') AS CusName,\n    REPLACE(REPLACE(REPLACE(cusAddress, CHAR(10), ''), CHAR(13), ''), '\"', '') AS cusAddress,\n    ISISChannelID,\n    OwnerID,\n    REPLACE(REPLACE(OwnerName, CHAR(10), ''), CHAR(13), '') AS OwnerName,\n    REPLACE(REPLACE(INN, CHAR(10), ''), CHAR(13), '') AS INN,\n    TradeShopID,\n    REPLACE(REPLACE(StoreTypeName, CHAR(10), ''), CHAR(13), '') AS StoreTypeName,\n    Phone,\n    CreateDate,\n    UpdateDate\nfrom [dbo].[@{pipeline().parameters.src_customer_table}]",
									"type": "Expression"
								},
								"partitionOption": "None"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"validateDataConsistency": true,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "FMCG_SQLServer_QVReports",
								"type": "DatasetReference",
								"parameters": {
									"cw_table": {
										"value": "@pipeline().parameters.src_customer_table",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ADLS_Raw_CSV",
								"type": "DatasetReference",
								"parameters": {
									"csv_fileName": {
										"value": "@pipeline().parameters.dest_customer_file",
										"type": "Expression"
									},
									"csv_directory": {
										"value": "@pipeline().parameters.dest_folder",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "TradeshopGPS_DBToCSV",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"partitionOption": "None"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"validateDataConsistency": true,
							"logSettings": {
								"enableCopyActivityLog": true,
								"copyActivityLogSettings": {
									"logLevel": "Warning",
									"enableReliableLogging": true
								},
								"logLocationSettings": {
									"linkedServiceName": {
										"referenceName": "ADLS_FMCS_RAW",
										"type": "LinkedServiceReference"
									},
									"path": "fmcg-raw/logs"
								}
							},
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "FMCG_SQLServer_QVReports",
								"type": "DatasetReference",
								"parameters": {
									"cw_table": {
										"value": "@pipeline().parameters.src_tradeshop_gps_table",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ADLS_Raw_CSV",
								"type": "DatasetReference",
								"parameters": {
									"csv_fileName": {
										"value": "@pipeline().parameters.dest_gps_file",
										"type": "Expression"
									},
									"csv_directory": {
										"value": "@pipeline().parameters.dest_folder",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "AG_Customer_DWH_to_DataService",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "AG_Customer_Filtered_to_DWH",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "AG_Customer_DWH_to_DataService",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"agDwhCustomerTable": {
										"cw_table": "ag_dwh_customer"
									},
									"addressFromDataServiceTable": {
										"cw_table": "location"
									},
									"saveToDataServiceDB": {
										"cw_table": "customer_ag_info"
									}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "AG_TradeShop_DWH_to_DataService",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "AG_Customer_Filtered_to_DWH",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "AG_TradeShop_DWH_to_DataService",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"agDwhTradeShopTable": {
										"cw_table": "ag_dwh_trade_shop"
									},
									"addressFromDataServiceTable": {
										"cw_table": "location"
									},
									"saveToDataServiceDB": {
										"cw_table": "trade_shop_ag_info"
									}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"src_customer_table": {
						"type": "string",
						"defaultValue": "BigOneFullCustomers"
					},
					"src_tradeshop_gps_table": {
						"type": "string",
						"defaultValue": "TradeshopGPS_AG"
					},
					"dest_folder": {
						"type": "string",
						"defaultValue": "ag_dwh_sink"
					},
					"dest_customer_file": {
						"type": "string",
						"defaultValue": "ag_dwh_full_customer.csv"
					},
					"dest_gps_file": {
						"type": "string",
						"defaultValue": "ag_dwh_full_trade_shop_gps.csv"
					}
				},
				"folder": {
					"name": "AG Pipelines/Customer"
				},
				"annotations": [],
				"lastPublishTime": "2025-11-11T04:37:21Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/dataflows/AG_Customer_Raw_to_Filtered')]",
				"[concat(variables('factoryId'), '/dataflows/AG_Customer_Filtered_to_DWH')]",
				"[concat(variables('factoryId'), '/datasets/FMCG_SQLServer_QVReports')]",
				"[concat(variables('factoryId'), '/datasets/ADLS_Raw_CSV')]",
				"[concat(variables('factoryId'), '/dataflows/AG_Customer_DWH_to_DataService')]",
				"[concat(variables('factoryId'), '/dataflows/AG_TradeShop_DWH_to_DataService')]",
				"[concat(variables('factoryId'), '/linkedServices/ADLS_FMCS_RAW')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AG_Customer_Full_Flow_SQL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "AG_Customer_Raw_to_Filtered",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "TradeshopGPS_DBToCSV",
								"dependencyConditions": [
									"Completed"
								]
							},
							{
								"activity": "Customer_DBToCSV",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "AG_Customer_Raw_to_Filtered",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"agRawFullCustomerCSV": {
										"csv_fileName": "ag_dwh_full_customer.csv",
										"csv_directory": "ag_dwh_sink"
									},
									"agRawTradeShopGpsCSV": {
										"csv_fileName": "ag_dwh_full_trade_shop_gps.csv",
										"csv_directory": "ag_dwh_sink"
									},
									"agFilteredCSV": {
										"csv_directory": "ag_dwh_filtered",
										"csv_fileName": "ag_dwh_customer_full.csv"
									}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "None",
							"cacheSinks": {
								"firstRowOnly": true
							}
						}
					},
					{
						"name": "Customer_DBToCSV",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": {
									"value": "select\n    CusID,\n    REPLACE(REPLACE(CusName, CHAR(10), ''), CHAR(13), '') AS CusName,\n    REPLACE(REPLACE(REPLACE(cusAddress, CHAR(10), ''), CHAR(13), ''), '\"', '') AS cusAddress,\n    ISISChannelID,\n    OwnerID,\n    REPLACE(REPLACE(OwnerName, CHAR(10), ''), CHAR(13), '') AS OwnerName,\n    REPLACE(REPLACE(INN, CHAR(10), ''), CHAR(13), '') AS INN,\n    TradeShopID,\n    REPLACE(REPLACE(StoreTypeName, CHAR(10), ''), CHAR(13), '') AS StoreTypeName,\n    Phone,\n    CreateDate,\n    UpdateDate\nfrom [dbo].[@{pipeline().parameters.src_customer_table}]",
									"type": "Expression"
								},
								"partitionOption": "None"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"validateDataConsistency": true,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "FMCG_SQLServer_QVReports",
								"type": "DatasetReference",
								"parameters": {
									"cw_table": {
										"value": "@pipeline().parameters.src_customer_table",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ADLS_Raw_CSV",
								"type": "DatasetReference",
								"parameters": {
									"csv_fileName": {
										"value": "@pipeline().parameters.dest_customer_file",
										"type": "Expression"
									},
									"csv_directory": {
										"value": "@pipeline().parameters.dest_folder",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "TradeshopGPS_DBToCSV",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"partitionOption": "None"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"validateDataConsistency": true,
							"logSettings": {
								"enableCopyActivityLog": true,
								"copyActivityLogSettings": {
									"logLevel": "Warning",
									"enableReliableLogging": true
								},
								"logLocationSettings": {
									"linkedServiceName": {
										"referenceName": "ADLS_FMCS_RAW",
										"type": "LinkedServiceReference"
									},
									"path": "fmcg-raw/logs"
								}
							},
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "FMCG_SQLServer_QVReports",
								"type": "DatasetReference",
								"parameters": {
									"cw_table": {
										"value": "@pipeline().parameters.src_tradeshop_gps_table",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ADLS_Raw_CSV",
								"type": "DatasetReference",
								"parameters": {
									"csv_fileName": {
										"value": "@pipeline().parameters.dest_gps_file",
										"type": "Expression"
									},
									"csv_directory": {
										"value": "@pipeline().parameters.dest_folder",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "AG_Customer_Filtered_to_DWH_SQL",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "AG_Customer_Raw_to_Filtered",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "AG_Customer_Filtered_to_DWH_SQL",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"agCustomerFiltered": {
										"csv_directory": "ag_dwh_filtered",
										"csv_fileName": "ag_dwh_customer_full.csv"
									},
									"agCustomerDWH": {
										"cw_table": "ag_dwh_customer",
										"cw_schema": "mch"
									},
									"agTradeShopDWH": {
										"cw_table": "ag_dwh_trade_shop",
										"cw_schema": "mch"
									}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "AG_Customer_DWH_to_DataService_SQL",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "AG_Customer_Filtered_to_DWH_SQL",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "AG_Customer_DWH_to_DataService_SQL",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"agDwhCustomerTable": {
										"cw_table": "ag_dwh_customer",
										"cw_schema": "mch"
									},
									"addressFromDataServiceTable": {
										"cw_table": "location"
									},
									"saveToDataServiceDB": {
										"cw_table": "customer_ag_info"
									}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "AG_TradeShop_DWH_to_DataService_SQL",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "AG_Customer_Filtered_to_DWH_SQL",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "AG_TradeShop_DWH_to_DataService_SQL",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"agDwhTradeShopTable": {
										"cw_table": "ag_dwh_trade_shop",
										"cw_schema": "mch"
									},
									"addressFromDataServiceTable": {
										"cw_table": "location"
									},
									"saveToDataServiceDB": {
										"cw_table": "trade_shop_ag_info"
									}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"src_customer_table": {
						"type": "string",
						"defaultValue": "BigOneFullCustomers"
					},
					"src_tradeshop_gps_table": {
						"type": "string",
						"defaultValue": "TradeshopGPS_AG"
					},
					"dest_folder": {
						"type": "string",
						"defaultValue": "ag_dwh_sink"
					},
					"dest_customer_file": {
						"type": "string",
						"defaultValue": "ag_dwh_full_customer.csv"
					},
					"dest_gps_file": {
						"type": "string",
						"defaultValue": "ag_dwh_full_trade_shop_gps.csv"
					}
				},
				"folder": {
					"name": "AG Pipelines/Customer"
				},
				"annotations": [],
				"lastPublishTime": "2025-11-11T04:37:21Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/dataflows/AG_Customer_Raw_to_Filtered')]",
				"[concat(variables('factoryId'), '/datasets/FMCG_SQLServer_QVReports')]",
				"[concat(variables('factoryId'), '/datasets/ADLS_Raw_CSV')]",
				"[concat(variables('factoryId'), '/dataflows/AG_Customer_Filtered_to_DWH_SQL')]",
				"[concat(variables('factoryId'), '/dataflows/AG_Customer_DWH_to_DataService_SQL')]",
				"[concat(variables('factoryId'), '/dataflows/AG_TradeShop_DWH_to_DataService_SQL')]",
				"[concat(variables('factoryId'), '/linkedServices/ADLS_FMCS_RAW')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AG_Customer_test')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "TradeshopGPS_DBToCSV",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"partitionOption": "None"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"validateDataConsistency": true,
							"logSettings": {
								"enableCopyActivityLog": true,
								"copyActivityLogSettings": {
									"logLevel": "Warning",
									"enableReliableLogging": true
								},
								"logLocationSettings": {
									"linkedServiceName": {
										"referenceName": "ADLS_FMCS_RAW",
										"type": "LinkedServiceReference"
									},
									"path": "fmcg-raw/logs"
								}
							},
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "FMCG_SQLServer_QVReports",
								"type": "DatasetReference",
								"parameters": {
									"cw_table": {
										"value": "@pipeline().parameters.src_tradeshop_gps_table",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ADLS_Raw_CSV",
								"type": "DatasetReference",
								"parameters": {
									"csv_fileName": {
										"value": "@pipeline().parameters.dest_gps_file",
										"type": "Expression"
									},
									"csv_directory": {
										"value": "@pipeline().parameters.dest_folder",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"src_customer_table": {
						"type": "string",
						"defaultValue": "BigOneFullCustomers"
					},
					"src_tradeshop_gps_table": {
						"type": "string",
						"defaultValue": "TradeshopGPS_AG"
					},
					"dest_folder": {
						"type": "string",
						"defaultValue": "ag_dwh_sink"
					},
					"dest_customer_file": {
						"type": "string",
						"defaultValue": "ag_dwh_full_customer.csv"
					},
					"dest_gps_file": {
						"type": "string",
						"defaultValue": "ag_dwh_full_trade_shop_gps.csv"
					}
				},
				"folder": {
					"name": "AG Pipelines/Customer"
				},
				"annotations": [],
				"lastPublishTime": "2025-11-11T04:37:21Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/FMCG_SQLServer_QVReports')]",
				"[concat(variables('factoryId'), '/datasets/ADLS_Raw_CSV')]",
				"[concat(variables('factoryId'), '/linkedServices/ADLS_FMCS_RAW')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AG_IdMaster_Update')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "AG_IdMaster_Update_CustomerId",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "AG_IdMaster_Update_CustomerId",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"tradeshopAgInfoTable": {
										"cw_table": "trade_shop_ag_info"
									},
									"updateAgCustomerInIdMaster": {
										"cw_table": "id_master"
									}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "AG Pipelines/Customer"
				},
				"annotations": [],
				"lastPublishTime": "2025-07-18T03:33:42Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/dataflows/AG_IdMaster_Update_CustomerId')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AG_MainDB_to_Raw')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy RouteDays src to raw",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "FMCG_SQLServer_MainDB",
								"type": "DatasetReference",
								"parameters": {
									"cw_table": "AG_RouteDays"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ADLS_Raw_CSV",
								"type": "DatasetReference",
								"parameters": {
									"csv_fileName": "ag_dwh_route_days.csv",
									"csv_directory": {
										"value": "@pipeline().parameters.main_directory",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Copy SalesReps src to raw",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy RouteDays src to raw",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "FMCG_SQLServer_MainDB",
								"type": "DatasetReference",
								"parameters": {
									"cw_table": "AG_Salereps"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ADLS_Raw_CSV",
								"type": "DatasetReference",
								"parameters": {
									"csv_fileName": "ag_dwh_sales_reps.csv",
									"csv_directory": {
										"value": "@pipeline().parameters.main_directory",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"main_directory": {
						"type": "string",
						"defaultValue": "ag_dwh_sink"
					}
				},
				"folder": {
					"name": "AG Pipelines"
				},
				"annotations": [],
				"lastPublishTime": "2025-11-11T04:37:21Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/FMCG_SQLServer_MainDB')]",
				"[concat(variables('factoryId'), '/datasets/ADLS_Raw_CSV')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AG_Order_1d_Ago_Extract_CSV')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Order_DB_to_Raw",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "dbo.BigOneFull"
							},
							{
								"name": "Destination",
								"value": "fmcg-raw/ag_dwh_sink/@{formatDateTime(pipeline().parameters.windowStart,'yyyy')}_@{formatDateTime(pipeline().parameters.windowStart,'MM')}/order_@{formatDateTime(pipeline().parameters.windowStart,'yyyy')}_@{formatDateTime(pipeline().parameters.windowStart,'MM')}_@{formatDateTime(pipeline().parameters.windowStart,'dd')}.csv"
							}
						],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": {
									"value": "select * from [dbo].[BigOneFull] \nwhere [DDate] >= '@{formatDateTime(pipeline().parameters.windowStart, 'yyyy-MM-dd' )}' \nAND [DDate] < '@{formatDateTime(pipeline().parameters.windowEnd, 'yyyy-MM-dd' )}'",
									"type": "Expression"
								},
								"partitionOption": "None"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"validateDataConsistency": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "FMCG_SQLServer_AG_Order",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "ADLS_Raw_By_Date_CSV",
								"type": "DatasetReference",
								"parameters": {
									"cw_fileName": "order_@{formatDateTime(pipeline().parameters.windowStart,'yyyy')}_@{formatDateTime(pipeline().parameters.windowStart,'MM')}_@{formatDateTime(pipeline().parameters.windowStart,'dd')}.csv",
									"cw_folderPath": {
										"value": "ag_dwh_sink/ag_dwh_order/@{formatDateTime(pipeline().parameters.windowStart,'yyyy')}_@{formatDateTime(pipeline().parameters.windowStart,'MM')}",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Raw_to_Filtered",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Order_DB_to_Raw",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "ADLS_Raw_By_Date_CSV",
								"type": "DatasetReference",
								"parameters": {
									"cw_fileName": "order_@{formatDateTime(pipeline().parameters.windowStart,'yyyy')}_@{formatDateTime(pipeline().parameters.windowStart,'MM')}_@{formatDateTime(pipeline().parameters.windowStart,'dd')}.csv",
									"cw_folderPath": {
										"value": "ag_dwh_sink/ag_dwh_order/@{formatDateTime(pipeline().parameters.windowStart,'yyyy')}_@{formatDateTime(pipeline().parameters.windowStart,'MM')}",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ADLS_Filtered_By_Date_CSV",
								"type": "DatasetReference",
								"parameters": {
									"cw_fileName": "order_@{formatDateTime(pipeline().parameters.windowStart,'yyyy')}_@{formatDateTime(pipeline().parameters.windowStart,'MM')}_@{formatDateTime(pipeline().parameters.windowStart,'dd')}.csv",
									"cw_folderPath": {
										"value": "ag_dwh_filtered/ag_dwh_order/@{formatDateTime(pipeline().parameters.windowStart,'yyyy')}_@{formatDateTime(pipeline().parameters.windowStart,'MM')}",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"windowStart": {
						"type": "String"
					},
					"windowEnd": {
						"type": "String"
					}
				},
				"folder": {
					"name": "AG Pipelines/Order"
				},
				"annotations": [],
				"lastPublishTime": "2025-01-14T11:07:31Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/FMCG_SQLServer_AG_Order')]",
				"[concat(variables('factoryId'), '/datasets/ADLS_Raw_By_Date_CSV')]",
				"[concat(variables('factoryId'), '/datasets/ADLS_Filtered_By_Date_CSV')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AG_Small_Tables_Full_Extract')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy Products src to raw",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "FMCG_SQLServer_QVReports",
								"type": "DatasetReference",
								"parameters": {
									"cw_table": "BigOneFullProducts"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ADLS_Raw_CSV",
								"type": "DatasetReference",
								"parameters": {
									"csv_fileName": "ag_dwh_full_product.csv",
									"csv_directory": {
										"value": "@pipeline().parameters.main_directory",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Copy GC src to raw",
						"description": "copy user category data (Golden Contract) of AG from Source database to Raw storage",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy Products src to raw",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "FMCG_SQLServer_QVReports",
								"type": "DatasetReference",
								"parameters": {
									"cw_table": "GC_History"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ADLS_Raw_CSV",
								"type": "DatasetReference",
								"parameters": {
									"csv_fileName": "ag_dwh_user_category_history.csv",
									"csv_directory": {
										"value": "@pipeline().parameters.main_directory",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Copy GOLDEN_CONTRACTS src to raw",
						"description": "copy user category data (Golden Contract) of AG from Source database to Raw storage",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy GC src to raw",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "FMCG_SQLServer_QVReports",
								"type": "DatasetReference",
								"parameters": {
									"cw_table": "GOLDEN_CONTRACTS"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ADLS_Raw_CSV",
								"type": "DatasetReference",
								"parameters": {
									"csv_fileName": "ag_dwh_user_category.csv",
									"csv_directory": {
										"value": "@pipeline().parameters.main_directory",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"main_directory": {
						"type": "string",
						"defaultValue": "ag_dwh_sink"
					}
				},
				"folder": {
					"name": "AG Pipelines"
				},
				"annotations": [],
				"lastPublishTime": "2025-11-11T04:37:21Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/FMCG_SQLServer_QVReports')]",
				"[concat(variables('factoryId'), '/datasets/ADLS_Raw_CSV')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/CC_Customer_Full_Flow')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "CC_Customer_Raw_to_Filtered",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "TradeshopGPS_DBToCSV",
								"dependencyConditions": [
									"Completed"
								]
							},
							{
								"activity": "Customer_DBToCSV",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "CC_Customer_Raw_to_Filtered",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"ccRawFullCustomerCSV": {
										"csv_fileName": "cc_dwh_full_customer.csv",
										"csv_directory": "cc_dwh_sink"
									},
									"ccRawTradeShopGpsCSV": {
										"csv_fileName": "cc_dwh_full_trade_shop_gps.csv",
										"csv_directory": "cc_dwh_sink"
									},
									"ccFilteredCSV": {
										"csv_directory": "cc_dwh_filtered",
										"csv_fileName": "cc_dwh_customer_full.csv"
									}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "CC_Customer_Filtered_to_DWH",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "CC_Customer_Raw_to_Filtered",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "CC_Customer_Filtered_to_DWH",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"ccCustomerFiltered": {
										"csv_directory": "cc_dwh_filtered",
										"csv_fileName": "cc_dwh_customer_full.csv"
									},
									"ccCustomerDWH": {
										"cw_table": "cc_dwh_customer"
									},
									"ccTradeShopDWH": {
										"cw_table": "cc_dwh_trade_shop"
									}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "Customer_DBToCSV",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": {
									"value": "SELECT\n    CUSID,\n    REPLACE(REPLACE(CusName, CHAR(10), ''), CHAR(13), '') AS CusName,\n    REPLACE(REPLACE(REPLACE(CusAddress, CHAR(10), ''), CHAR(13), ''), '\"', '') AS CusAddress,\n    OwnerID,\n    REPLACE(REPLACE(OwnerName, CHAR(10), ''), CHAR(13), '') AS OwnerName,\n    GoldenFlag,\n    REPLACE(REPLACE(StoreType, CHAR(10), ''), CHAR(13), '') AS StoreType,\n    REPLACE(REPLACE(INN, CHAR(10), ''), CHAR(13), '') AS INN,\n    Phone,\n    REPLACE(REPLACE(BuyingPower, CHAR(10), ''), CHAR(13), '') AS BuyingPower,\n    LocationSegment,\n    REPLACE(REPLACE(Channel, CHAR(10), ''), CHAR(13), '') AS Channel,\n    REPLACE(REPLACE(Image, CHAR(10), ''), CHAR(13), '') AS Image,\n    REPLACE(REPLACE(SubChannel, CHAR(10), ''), CHAR(13), '') AS SubChannel,\n    REPLACE(REPLACE(SalesTeam, CHAR(10), ''), CHAR(13), '') AS SalesTeam,\n    REPLACE(REPLACE(DeliveryArea, CHAR(10), ''), CHAR(13), '') AS DeliveryArea,\n    ChannelID,\n    REPLACE(REPLACE(District, CHAR(10), ''), CHAR(13), '') AS District,\n    REPLACE(REPLACE(Khoroo, CHAR(10), ''), CHAR(13), '') AS Khoroo,\n    CreateDate,\n    UpdateDate\nFROM BigOneFullCustomers_CC_New",
									"type": "Expression"
								},
								"partitionOption": "None"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"validateDataConsistency": true,
							"logSettings": {
								"enableCopyActivityLog": true,
								"copyActivityLogSettings": {
									"logLevel": "Warning",
									"enableReliableLogging": true
								},
								"logLocationSettings": {
									"linkedServiceName": {
										"referenceName": "ADLS_FMCS_RAW",
										"type": "LinkedServiceReference"
									},
									"path": "fmcg-raw/logs"
								}
							},
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "FMCG_SQLServer_QVReports",
								"type": "DatasetReference",
								"parameters": {
									"cw_table": {
										"value": "@pipeline().parameters.src_customer_table",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ADLS_Raw_CSV",
								"type": "DatasetReference",
								"parameters": {
									"csv_fileName": {
										"value": "@pipeline().parameters.dest_customer_file",
										"type": "Expression"
									},
									"csv_directory": {
										"value": "@pipeline().parameters.dest_folder",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "TradeshopGPS_DBToCSV",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"partitionOption": "None"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"validateDataConsistency": true,
							"logSettings": {
								"enableCopyActivityLog": true,
								"copyActivityLogSettings": {
									"logLevel": "Warning",
									"enableReliableLogging": true
								},
								"logLocationSettings": {
									"linkedServiceName": {
										"referenceName": "ADLS_FMCS_RAW",
										"type": "LinkedServiceReference"
									},
									"path": "fmcg-raw/logs"
								}
							},
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "FMCG_SQLServer_QVReports",
								"type": "DatasetReference",
								"parameters": {
									"cw_table": {
										"value": "@pipeline().parameters.src_tradeshop_gps_table",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ADLS_Raw_CSV",
								"type": "DatasetReference",
								"parameters": {
									"csv_fileName": {
										"value": "@pipeline().parameters.dest_gps_file",
										"type": "Expression"
									},
									"csv_directory": {
										"value": "@pipeline().parameters.dest_folder",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "CC_Customer_DWH_to_DataService",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "CC_Customer_Filtered_to_DWH",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "CC_Customer_DWH_to_DataService",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"ccDwhCustomerTable": {
										"cw_table": "cc_dwh_customer"
									},
									"addressFromDataServiceTable": {
										"cw_table": "location"
									},
									"saveToDataServiceDB": {
										"cw_table": "customer_cc_info"
									}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "CC_TradeShop_DWH_to_DataService",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "CC_Customer_Filtered_to_DWH",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "CC_TradeShop_DWH_to_DataService",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"ccDwhTradeShopTable": {
										"cw_table": "cc_dwh_trade_shop"
									},
									"addressFromDataServiceTable": {
										"cw_table": "location"
									},
									"saveToMerchantDB": {
										"cw_table": "trade_shop_cc_info"
									}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"src_customer_table": {
						"type": "string",
						"defaultValue": "BigOneFullCustomers_CC_New"
					},
					"src_tradeshop_gps_table": {
						"type": "string",
						"defaultValue": "TradeshopGPS_CC"
					},
					"dest_folder": {
						"type": "string",
						"defaultValue": "cc_dwh_sink"
					},
					"dest_customer_file": {
						"type": "string",
						"defaultValue": "cc_dwh_full_customer.csv"
					},
					"dest_gps_file": {
						"type": "string",
						"defaultValue": "cc_dwh_full_trade_shop_gps.csv"
					}
				},
				"folder": {
					"name": "CC Pipelines/Customer"
				},
				"annotations": [],
				"lastPublishTime": "2025-11-11T04:37:21Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/dataflows/CC_Customer_Raw_to_Filtered')]",
				"[concat(variables('factoryId'), '/dataflows/CC_Customer_Filtered_to_DWH')]",
				"[concat(variables('factoryId'), '/datasets/FMCG_SQLServer_QVReports')]",
				"[concat(variables('factoryId'), '/datasets/ADLS_Raw_CSV')]",
				"[concat(variables('factoryId'), '/dataflows/CC_Customer_DWH_to_DataService')]",
				"[concat(variables('factoryId'), '/dataflows/CC_TradeShop_DWH_to_DataService')]",
				"[concat(variables('factoryId'), '/linkedServices/ADLS_FMCS_RAW')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/CC_MainDB_to_Raw')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy RouteDays src to raw",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "FMCG_SQLServer_MainDB",
								"type": "DatasetReference",
								"parameters": {
									"cw_table": "CC_RouteDays"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ADLS_Raw_CSV",
								"type": "DatasetReference",
								"parameters": {
									"csv_fileName": "cc_dwh_route_days.csv",
									"csv_directory": {
										"value": "@pipeline().parameters.main_directory",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Copy SalesReps src to raw",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy RouteDays src to raw",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "FMCG_SQLServer_MainDB",
								"type": "DatasetReference",
								"parameters": {
									"cw_table": "CC_Salereps"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ADLS_Raw_CSV",
								"type": "DatasetReference",
								"parameters": {
									"csv_fileName": "cc_dwh_sales_reps.csv",
									"csv_directory": {
										"value": "@pipeline().parameters.main_directory",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"main_directory": {
						"type": "string",
						"defaultValue": "cc_dwh_sink"
					}
				},
				"folder": {
					"name": "CC Pipelines"
				},
				"annotations": [],
				"lastPublishTime": "2025-11-11T04:37:21Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/FMCG_SQLServer_MainDB')]",
				"[concat(variables('factoryId'), '/datasets/ADLS_Raw_CSV')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/CC_Small_Tables_Full_Extract')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy Products src to raw",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "FMCG_SQLServer_QVReports",
								"type": "DatasetReference",
								"parameters": {
									"cw_table": "BigOneFullProducts_CC"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ADLS_Raw_CSV",
								"type": "DatasetReference",
								"parameters": {
									"csv_fileName": "cc_dwh_full_product.csv",
									"csv_directory": {
										"value": "@pipeline().parameters.main_directory",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"main_directory": {
						"type": "string",
						"defaultValue": "cc_dwh_sink"
					}
				},
				"folder": {
					"name": "CC Pipelines"
				},
				"annotations": [],
				"lastPublishTime": "2025-11-11T04:37:21Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/FMCG_SQLServer_QVReports')]",
				"[concat(variables('factoryId'), '/datasets/ADLS_Raw_CSV')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/CopyPipeline_xii')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ForEach_xii",
						"type": "ForEach",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@pipeline().parameters.cw_items",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "Copy_xii",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [
										{
											"name": "Source",
											"value": "HRMS_PROD.@{item().source.table}"
										},
										{
											"name": "Destination",
											"value": "HRMS_PROD.@{item().destination.table}"
										}
									],
									"typeProperties": {
										"source": {
											"type": "OracleSource",
											"partitionOption": "None"
										},
										"sink": {
											"type": "AzureSqlSink",
											"writeBehavior": {
												"value": "@item().copySink.writeBehavior",
												"type": "Expression"
											},
											"sqlWriterUseTableLock": {
												"value": "@item().copySink.sqlWriterUseTableLock",
												"type": "Expression"
											},
											"upsertSettings": {
												"useTempDB": true,
												"keys": {
													"value": "@item().upsertSettings.keys",
													"type": "Expression"
												}
											},
											"tableOption": "autoCreate",
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"validateDataConsistency": false,
										"logSettings": {
											"enableCopyActivityLog": true,
											"copyActivityLogSettings": {
												"logLevel": "Warning",
												"enableReliableLogging": false
											},
											"logLocationSettings": {
												"linkedServiceName": {
													"referenceName": "linkedService_err",
													"type": "LinkedServiceReference"
												},
												"path": "error"
											}
										},
										"translator": {
											"value": "@item().copyActivity.translator",
											"type": "Expression"
										}
									},
									"inputs": [
										{
											"referenceName": "SourceDataset_xii",
											"type": "DatasetReference",
											"parameters": {
												"cw_table": "@item().source.table"
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DestinationDataset_xii",
											"type": "DatasetReference",
											"parameters": {
												"cw_table": "@item().destination.table"
											}
										}
									]
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"cw_items": {
						"type": "Array",
						"defaultValue": [
							{
								"source": {
									"table": "SIGRADE"
								},
								"destination": {
									"table": "SIGRADE"
								},
								"copySink": {
									"writeBehavior": "upsert",
									"sqlWriterUseTableLock": false
								},
								"copyActivity": {
									"translator": {
										"type": "TabularTranslator",
										"mappings": [
											{
												"source": {
													"name": "GRADEID",
													"type": "Int64"
												},
												"sink": {
													"name": "GRADEID",
													"type": "Int64",
													"physicalType": "bigint"
												}
											},
											{
												"source": {
													"name": "CODE",
													"type": "String"
												},
												"sink": {
													"name": "CODE",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "GRADENO",
													"type": "Int64"
												},
												"sink": {
													"name": "GRADENO",
													"type": "Int64",
													"physicalType": "bigint"
												}
											},
											{
												"source": {
													"name": "NAME",
													"type": "String"
												},
												"sink": {
													"name": "NAME",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "ISACTIVE",
													"type": "String"
												},
												"sink": {
													"name": "ISACTIVE",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "CREATED",
													"type": "String"
												},
												"sink": {
													"name": "CREATED",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "CREATEDBY",
													"type": "String"
												},
												"sink": {
													"name": "CREATEDBY",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "UPDATED",
													"type": "String"
												},
												"sink": {
													"name": "UPDATED",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "UPDATEDBY",
													"type": "String"
												},
												"sink": {
													"name": "UPDATEDBY",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "IPADDRESS",
													"type": "String"
												},
												"sink": {
													"name": "IPADDRESS",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "MACADDRESS",
													"type": "String"
												},
												"sink": {
													"name": "MACADDRESS",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "TSTAMP",
													"type": "DateTime"
												},
												"sink": {
													"name": "TSTAMP",
													"type": "DateTime",
													"physicalType": "datetime2"
												}
											},
											{
												"source": {
													"name": "MASTERID",
													"type": "Int64"
												},
												"sink": {
													"name": "MASTERID",
													"type": "Int64",
													"physicalType": "bigint"
												}
											},
											{
												"source": {
													"name": "ISMASTER",
													"type": "String"
												},
												"sink": {
													"name": "ISMASTER",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "GRADETYPEID",
													"type": "Int64"
												},
												"sink": {
													"name": "GRADETYPEID",
													"type": "Int64",
													"physicalType": "bigint"
												}
											}
										],
										"typeConversion": true,
										"typeConversionSettings": {
											"allowDataTruncation": true,
											"treatBooleanAsNumber": false
										}
									}
								},
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"GRADEID"
									]
								}
							},
							{
								"source": {
									"table": "SILEVEL"
								},
								"destination": {
									"table": "SILEVEL"
								},
								"copySink": {
									"writeBehavior": "upsert",
									"sqlWriterUseTableLock": false
								},
								"copyActivity": {
									"translator": {
										"type": "TabularTranslator",
										"mappings": [
											{
												"source": {
													"name": "LEVELID",
													"type": "Int64"
												},
												"sink": {
													"name": "LEVELID",
													"type": "Int64",
													"physicalType": "bigint"
												}
											},
											{
												"source": {
													"name": "CODE",
													"type": "String"
												},
												"sink": {
													"name": "CODE",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "NAME",
													"type": "String"
												},
												"sink": {
													"name": "NAME",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "ISACTIVE",
													"type": "String"
												},
												"sink": {
													"name": "ISACTIVE",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "CREATED",
													"type": "String"
												},
												"sink": {
													"name": "CREATED",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "CREATEDBY",
													"type": "String"
												},
												"sink": {
													"name": "CREATEDBY",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "UPDATED",
													"type": "String"
												},
												"sink": {
													"name": "UPDATED",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "UPDATEDBY",
													"type": "String"
												},
												"sink": {
													"name": "UPDATEDBY",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "IPADDRESS",
													"type": "String"
												},
												"sink": {
													"name": "IPADDRESS",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "MACADDRESS",
													"type": "String"
												},
												"sink": {
													"name": "MACADDRESS",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "TSTAMP",
													"type": "DateTime"
												},
												"sink": {
													"name": "TSTAMP",
													"type": "DateTime",
													"physicalType": "datetime2"
												}
											},
											{
												"source": {
													"name": "MASTERID",
													"type": "Int64"
												},
												"sink": {
													"name": "MASTERID",
													"type": "Int64",
													"physicalType": "bigint"
												}
											},
											{
												"source": {
													"name": "ISMASTER",
													"type": "String"
												},
												"sink": {
													"name": "ISMASTER",
													"type": "String",
													"physicalType": "nvarchar"
												}
											}
										],
										"typeConversion": true,
										"typeConversionSettings": {
											"allowDataTruncation": true,
											"treatBooleanAsNumber": false
										}
									}
								},
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"LEVELID"
									]
								}
							},
							{
								"source": {
									"table": "TBLCOMPANY"
								},
								"destination": {
									"table": "TBLCOMPANY"
								},
								"copySink": {
									"writeBehavior": "upsert",
									"sqlWriterUseTableLock": false
								},
								"copyActivity": {
									"translator": {
										"type": "TabularTranslator",
										"mappings": [
											{
												"source": {
													"name": "COMPANYID",
													"type": "String"
												},
												"sink": {
													"name": "COMPANYID",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "NAME",
													"type": "String"
												},
												"sink": {
													"name": "NAME",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "ADDRESS",
													"type": "String"
												},
												"sink": {
													"name": "ADDRESS",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "CREATED",
													"type": "String"
												},
												"sink": {
													"name": "CREATED",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "CREATEDBY",
													"type": "String"
												},
												"sink": {
													"name": "CREATEDBY",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "UPDATED",
													"type": "String"
												},
												"sink": {
													"name": "UPDATED",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "UPDATEDBY",
													"type": "String"
												},
												"sink": {
													"name": "UPDATEDBY",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "IPADDRESS",
													"type": "String"
												},
												"sink": {
													"name": "IPADDRESS",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "MACADDRESS",
													"type": "String"
												},
												"sink": {
													"name": "MACADDRESS",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "TSTAMP",
													"type": "DateTime"
												},
												"sink": {
													"name": "TSTAMP",
													"type": "DateTime",
													"physicalType": "datetime2"
												}
											},
											{
												"source": {
													"name": "BUSINESSTYPEID",
													"type": "Int64"
												},
												"sink": {
													"name": "BUSINESSTYPEID",
													"type": "Int64",
													"physicalType": "bigint"
												}
											},
											{
												"source": {
													"name": "PARENTID",
													"type": "String"
												},
												"sink": {
													"name": "PARENTID",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "REPGROUPID",
													"type": "String"
												},
												"sink": {
													"name": "REPGROUPID",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "PHONE",
													"type": "String"
												},
												"sink": {
													"name": "PHONE",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "FAX",
													"type": "String"
												},
												"sink": {
													"name": "FAX",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "INTCOMPANYID",
													"type": "Int64"
												},
												"sink": {
													"name": "INTCOMPANYID",
													"type": "Int64",
													"physicalType": "bigint"
												}
											},
											{
												"source": {
													"name": "JDECOMPANY",
													"type": "String"
												},
												"sink": {
													"name": "JDECOMPANY",
													"type": "String",
													"physicalType": "nvarchar"
												}
											}
										],
										"typeConversion": true,
										"typeConversionSettings": {
											"allowDataTruncation": true,
											"treatBooleanAsNumber": false
										}
									}
								},
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"COMPANYID"
									]
								}
							},
							{
								"source": {
									"table": "TBLDEPARTMENT"
								},
								"destination": {
									"table": "TBLDEPARTMENT"
								},
								"copySink": {
									"writeBehavior": "upsert",
									"sqlWriterUseTableLock": null
								},
								"copyActivity": {
									"translator": {
										"type": "TabularTranslator",
										"mappings": [
											{
												"source": {
													"name": "DEPID",
													"type": "String"
												},
												"sink": {
													"name": "DEPID",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "DEPCODE",
													"type": "String"
												},
												"sink": {
													"name": "DEPCODE",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "NAME",
													"type": "String"
												},
												"sink": {
													"name": "NAME",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "ISACTIVE",
													"type": "String"
												},
												"sink": {
													"name": "ISACTIVE",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "PARENTID",
													"type": "String"
												},
												"sink": {
													"name": "PARENTID",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "CREATED",
													"type": "String"
												},
												"sink": {
													"name": "CREATED",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "CREATEDBY",
													"type": "String"
												},
												"sink": {
													"name": "CREATEDBY",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "UPDATED",
													"type": "String"
												},
												"sink": {
													"name": "UPDATED",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "UPDATEDBY",
													"type": "String"
												},
												"sink": {
													"name": "UPDATEDBY",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "IPADDRESS",
													"type": "String"
												},
												"sink": {
													"name": "IPADDRESS",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "MACADDRESS",
													"type": "String"
												},
												"sink": {
													"name": "MACADDRESS",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "TSTAMP",
													"type": "DateTime"
												},
												"sink": {
													"name": "TSTAMP",
													"type": "DateTime",
													"physicalType": "datetime2"
												}
											},
											{
												"source": {
													"name": "COMPANYID",
													"type": "String"
												},
												"sink": {
													"name": "COMPANYID",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "DEPTYPEID",
													"type": "Int64"
												},
												"sink": {
													"name": "DEPTYPEID",
													"type": "Int64",
													"physicalType": "bigint"
												}
											},
											{
												"source": {
													"name": "PATH",
													"type": "String"
												},
												"sink": {
													"name": "PATH",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "PARENTPATH",
													"type": "String"
												},
												"sink": {
													"name": "PARENTPATH",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "REPGROUPID",
													"type": "String"
												},
												"sink": {
													"name": "REPGROUPID",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "INTDEPID",
													"type": "Int64"
												},
												"sink": {
													"name": "INTDEPID",
													"type": "Int64",
													"physicalType": "bigint"
												}
											},
											{
												"source": {
													"name": "INTPARENTID",
													"type": "Int64"
												},
												"sink": {
													"name": "INTPARENTID",
													"type": "Int64",
													"physicalType": "bigint"
												}
											},
											{
												"source": {
													"name": "DEPTYPE",
													"type": "String"
												},
												"sink": {
													"name": "DEPTYPE",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "LDAPPATH",
													"type": "String"
												},
												"sink": {
													"name": "LDAPPATH",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "ISPROVINCE",
													"type": "String"
												},
												"sink": {
													"name": "ISPROVINCE",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "ESTABLISHEDDATE",
													"type": "String"
												},
												"sink": {
													"name": "ESTABLISHEDDATE",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "SHOWONORGCHART",
													"type": "String"
												},
												"sink": {
													"name": "SHOWONORGCHART",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "FAPURPOSEID",
													"type": "Int64"
												},
												"sink": {
													"name": "FAPURPOSEID",
													"type": "Int64",
													"physicalType": "bigint"
												}
											}
										],
										"typeConversion": true,
										"typeConversionSettings": {
											"allowDataTruncation": true,
											"treatBooleanAsNumber": false
										}
									}
								},
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"DEPID"
									]
								}
							},
							{
								"source": {
									"table": "TBLEMPEMPLHIST"
								},
								"destination": {
									"table": "TBLEMPEMPLHIST"
								},
								"copySink": {
									"writeBehavior": "upsert",
									"sqlWriterUseTableLock": null
								},
								"copyActivity": {
									"translator": {
										"type": "TabularTranslator",
										"mappings": [
											{
												"source": {
													"name": "HISTORYID",
													"type": "Int64"
												},
												"sink": {
													"name": "HISTORYID",
													"type": "Int64",
													"physicalType": "bigint"
												}
											},
											{
												"source": {
													"name": "EMPID",
													"type": "Int64"
												},
												"sink": {
													"name": "EMPID",
													"type": "Int64",
													"physicalType": "bigint"
												}
											},
											{
												"source": {
													"name": "BEGINDATE",
													"type": "String"
												},
												"sink": {
													"name": "BEGINDATE",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "ENDDATE",
													"type": "String"
												},
												"sink": {
													"name": "ENDDATE",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "ORDERID",
													"type": "Int64"
												},
												"sink": {
													"name": "ORDERID",
													"type": "Int64",
													"physicalType": "bigint"
												}
											},
											{
												"source": {
													"name": "ORDERTYPE",
													"type": "String"
												},
												"sink": {
													"name": "ORDERTYPE",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "COMPANYID",
													"type": "String"
												},
												"sink": {
													"name": "COMPANYID",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "DEPID",
													"type": "String"
												},
												"sink": {
													"name": "DEPID",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "POSITIONID",
													"type": "Int64"
												},
												"sink": {
													"name": "POSITIONID",
													"type": "Int64",
													"physicalType": "bigint"
												}
											},
											{
												"source": {
													"name": "GRADEID",
													"type": "Int64"
												},
												"sink": {
													"name": "GRADEID",
													"type": "Int64",
													"physicalType": "bigint"
												}
											},
											{
												"source": {
													"name": "LEVELID",
													"type": "Int64"
												},
												"sink": {
													"name": "LEVELID",
													"type": "Int64",
													"physicalType": "bigint"
												}
											},
											{
												"source": {
													"name": "BASEWAGE",
													"type": "Decimal",
													"scale": 4,
													"precision": 18
												},
												"sink": {
													"name": "BASEWAGE",
													"type": "Decimal",
													"physicalType": "decimal"
												}
											},
											{
												"source": {
													"name": "BASEWAGECURRCODE",
													"type": "String"
												},
												"sink": {
													"name": "BASEWAGECURRCODE",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "TSTAMP",
													"type": "DateTime"
												},
												"sink": {
													"name": "TSTAMP",
													"type": "DateTime",
													"physicalType": "datetime2"
												}
											},
											{
												"source": {
													"name": "CREATED",
													"type": "String"
												},
												"sink": {
													"name": "CREATED",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "CREATEDBY",
													"type": "String"
												},
												"sink": {
													"name": "CREATEDBY",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "UPDATED",
													"type": "String"
												},
												"sink": {
													"name": "UPDATED",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "UPDATEDBY",
													"type": "String"
												},
												"sink": {
													"name": "UPDATEDBY",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "IPADDRESS",
													"type": "String"
												},
												"sink": {
													"name": "IPADDRESS",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "MACADDRESS",
													"type": "String"
												},
												"sink": {
													"name": "MACADDRESS",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "ORDERNO",
													"type": "String"
												},
												"sink": {
													"name": "ORDERNO",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "ISMANUALHIST",
													"type": "String"
												},
												"sink": {
													"name": "ISMANUALHIST",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "ISNOTLOCALHIST",
													"type": "String"
												},
												"sink": {
													"name": "ISNOTLOCALHIST",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "LEGALENTITYID",
													"type": "Int64"
												},
												"sink": {
													"name": "LEGALENTITYID",
													"type": "Int64",
													"physicalType": "bigint"
												}
											},
											{
												"source": {
													"name": "OLDDEPNAME",
													"type": "String"
												},
												"sink": {
													"name": "OLDDEPNAME",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "JOBID",
													"type": "Int64"
												},
												"sink": {
													"name": "JOBID",
													"type": "Int64",
													"physicalType": "bigint"
												}
											},
											{
												"source": {
													"name": "NOTE",
													"type": "String"
												},
												"sink": {
													"name": "NOTE",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "INSURETYPEID",
													"type": "Int64"
												},
												"sink": {
													"name": "INSURETYPEID",
													"type": "Int64",
													"physicalType": "bigint"
												}
											},
											{
												"source": {
													"name": "LABOURCONDITION",
													"type": "String"
												},
												"sink": {
													"name": "LABOURCONDITION",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "ISMULT",
													"type": "String"
												},
												"sink": {
													"name": "ISMULT",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "MULTYEAR",
													"type": "Decimal",
													"scale": 4,
													"precision": 18
												},
												"sink": {
													"name": "MULTYEAR",
													"type": "Decimal",
													"physicalType": "decimal"
												}
											},
											{
												"source": {
													"name": "HISTREASON",
													"type": "String"
												},
												"sink": {
													"name": "HISTREASON",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "HISTREASONNAMES",
													"type": "String"
												},
												"sink": {
													"name": "HISTREASONNAMES",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "TOTALWAGE",
													"type": "Decimal",
													"scale": 4,
													"precision": 18
												},
												"sink": {
													"name": "TOTALWAGE",
													"type": "Decimal",
													"physicalType": "decimal"
												}
											},
											{
												"source": {
													"name": "EVOLVEWAGE",
													"type": "Decimal",
													"scale": 4,
													"precision": 18
												},
												"sink": {
													"name": "EVOLVEWAGE",
													"type": "Decimal",
													"physicalType": "decimal"
												}
											},
											{
												"source": {
													"name": "CALCPERCENT",
													"type": "Decimal",
													"scale": 4,
													"precision": 18
												},
												"sink": {
													"name": "CALCPERCENT",
													"type": "Decimal",
													"physicalType": "decimal"
												}
											},
											{
												"source": {
													"name": "GRADETYPEID",
													"type": "Int64"
												},
												"sink": {
													"name": "GRADETYPEID",
													"type": "Int64",
													"physicalType": "bigint"
												}
											},
											{
												"source": {
													"name": "LEVELNO",
													"type": "Int64"
												},
												"sink": {
													"name": "LEVELNO",
													"type": "Int64",
													"physicalType": "bigint"
												}
											},
											{
												"source": {
													"name": "FTEMAINID",
													"type": "Int64"
												},
												"sink": {
													"name": "FTEMAINID",
													"type": "Int64",
													"physicalType": "bigint"
												}
											}
										],
										"typeConversion": true,
										"typeConversionSettings": {
											"allowDataTruncation": true,
											"treatBooleanAsNumber": false
										}
									}
								},
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"HISTORYID"
									]
								}
							},
							{
								"source": {
									"table": "TBLEMPLOYEE"
								},
								"destination": {
									"table": "TBLEMPLOYEE"
								},
								"copySink": {
									"writeBehavior": "upsert",
									"sqlWriterUseTableLock": null
								},
								"copyActivity": {
									"translator": {
										"type": "TabularTranslator",
										"mappings": [
											{
												"source": {
													"name": "EMPID",
													"type": "Decimal",
													"scale": 0,
													"precision": 20
												},
												"sink": {
													"name": "EMPID",
													"type": "Decimal",
													"physicalType": "decimal"
												}
											},
											{
												"source": {
													"name": "CODE",
													"type": "String"
												},
												"sink": {
													"name": "CODE",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "FAMILYNAME",
													"type": "String"
												},
												"sink": {
													"name": "FAMILYNAME",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "LASTNAME",
													"type": "String"
												},
												"sink": {
													"name": "LASTNAME",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "FIRSTNAME",
													"type": "String"
												},
												"sink": {
													"name": "FIRSTNAME",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "GENDER",
													"type": "String"
												},
												"sink": {
													"name": "GENDER",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "BIRTHDATE",
													"type": "String"
												},
												"sink": {
													"name": "BIRTHDATE",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "BIRTHCOUNTRYID",
													"type": "Int64"
												},
												"sink": {
													"name": "BIRTHCOUNTRYID",
													"type": "Int64",
													"physicalType": "bigint"
												}
											},
											{
												"source": {
													"name": "BIRTHDIVISIONID",
													"type": "Int64"
												},
												"sink": {
													"name": "BIRTHDIVISIONID",
													"type": "Int64",
													"physicalType": "bigint"
												}
											},
											{
												"source": {
													"name": "BIRTHDISTRICTID",
													"type": "Int64"
												},
												"sink": {
													"name": "BIRTHDISTRICTID",
													"type": "Int64",
													"physicalType": "bigint"
												}
											},
											{
												"source": {
													"name": "BIRTHPLACE",
													"type": "String"
												},
												"sink": {
													"name": "BIRTHPLACE",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "COUNTRYID",
													"type": "Int64"
												},
												"sink": {
													"name": "COUNTRYID",
													"type": "Int64",
													"physicalType": "bigint"
												}
											},
											{
												"source": {
													"name": "DIVISIONID",
													"type": "Int64"
												},
												"sink": {
													"name": "DIVISIONID",
													"type": "Int64",
													"physicalType": "bigint"
												}
											},
											{
												"source": {
													"name": "DISTRICTID",
													"type": "Int64"
												},
												"sink": {
													"name": "DISTRICTID",
													"type": "Int64",
													"physicalType": "bigint"
												}
											},
											{
												"source": {
													"name": "NATIONALITYID",
													"type": "Int64"
												},
												"sink": {
													"name": "NATIONALITYID",
													"type": "Int64",
													"physicalType": "bigint"
												}
											},
											{
												"source": {
													"name": "SOCIALORIGINID",
													"type": "Int64"
												},
												"sink": {
													"name": "SOCIALORIGINID",
													"type": "Int64",
													"physicalType": "bigint"
												}
											},
											{
												"source": {
													"name": "MARITALSTATUS",
													"type": "String"
												},
												"sink": {
													"name": "MARITALSTATUS",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "BLOODGROUP",
													"type": "String"
												},
												"sink": {
													"name": "BLOODGROUP",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "REGNO",
													"type": "String"
												},
												"sink": {
													"name": "REGNO",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "PASSNO",
													"type": "String"
												},
												"sink": {
													"name": "PASSNO",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "FORPASSNO",
													"type": "String"
												},
												"sink": {
													"name": "FORPASSNO",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "EMDNO",
													"type": "String"
												},
												"sink": {
													"name": "EMDNO",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "NDDNO",
													"type": "String"
												},
												"sink": {
													"name": "NDDNO",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "ADDR1",
													"type": "String"
												},
												"sink": {
													"name": "ADDR1",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "ADDR2",
													"type": "String"
												},
												"sink": {
													"name": "ADDR2",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "HOMEPHONE",
													"type": "String"
												},
												"sink": {
													"name": "HOMEPHONE",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "MOBILEPHONE",
													"type": "String"
												},
												"sink": {
													"name": "MOBILEPHONE",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "WORKPHONE",
													"type": "String"
												},
												"sink": {
													"name": "WORKPHONE",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "WORKPHONEEXT",
													"type": "String"
												},
												"sink": {
													"name": "WORKPHONEEXT",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "FAX",
													"type": "String"
												},
												"sink": {
													"name": "FAX",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "EMAIL",
													"type": "String"
												},
												"sink": {
													"name": "EMAIL",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "POSTADDRESS",
													"type": "String"
												},
												"sink": {
													"name": "POSTADDRESS",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "CONTACTNAME",
													"type": "String"
												},
												"sink": {
													"name": "CONTACTNAME",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "CONTACTPHONE",
													"type": "String"
												},
												"sink": {
													"name": "CONTACTPHONE",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "WITHPICTURE",
													"type": "String"
												},
												"sink": {
													"name": "WITHPICTURE",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "STATUS",
													"type": "String"
												},
												"sink": {
													"name": "STATUS",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "CREATED",
													"type": "String"
												},
												"sink": {
													"name": "CREATED",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "CREATEDBY",
													"type": "String"
												},
												"sink": {
													"name": "CREATEDBY",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "UPDATED",
													"type": "String"
												},
												"sink": {
													"name": "UPDATED",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "UPDATEDBY",
													"type": "String"
												},
												"sink": {
													"name": "UPDATEDBY",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "IPADDRESS",
													"type": "String"
												},
												"sink": {
													"name": "IPADDRESS",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "MACADDRESS",
													"type": "String"
												},
												"sink": {
													"name": "MACADDRESS",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "TSTAMP",
													"type": "DateTime"
												},
												"sink": {
													"name": "TSTAMP",
													"type": "DateTime",
													"physicalType": "datetime2"
												}
											},
											{
												"source": {
													"name": "COMPANYID",
													"type": "String"
												},
												"sink": {
													"name": "COMPANYID",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "STATUSDATE",
													"type": "String"
												},
												"sink": {
													"name": "STATUSDATE",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "LASTNAMELENGTH",
													"type": "Decimal",
													"scale": 0,
													"precision": 38
												},
												"sink": {
													"name": "LASTNAMELENGTH",
													"type": "Decimal",
													"physicalType": "decimal"
												}
											},
											{
												"source": {
													"name": "EMAIL2",
													"type": "String"
												},
												"sink": {
													"name": "EMAIL2",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "CONTACTNAME2",
													"type": "String"
												},
												"sink": {
													"name": "CONTACTNAME2",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "CONTACTPHONE2",
													"type": "String"
												},
												"sink": {
													"name": "CONTACTPHONE2",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "ISBLACKLISTED",
													"type": "String"
												},
												"sink": {
													"name": "ISBLACKLISTED",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "BLACKLISTREASON",
													"type": "String"
												},
												"sink": {
													"name": "BLACKLISTREASON",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "BLACKLISTEDDATE",
													"type": "String"
												},
												"sink": {
													"name": "BLACKLISTEDDATE",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "ISFOREIGNER",
													"type": "String"
												},
												"sink": {
													"name": "ISFOREIGNER",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "CONTACTID",
													"type": "Int64"
												},
												"sink": {
													"name": "CONTACTID",
													"type": "Int64",
													"physicalType": "bigint"
												}
											},
											{
												"source": {
													"name": "MILITARYSERVED",
													"type": "String"
												},
												"sink": {
													"name": "MILITARYSERVED",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "TRAININGSPORT",
													"type": "String"
												},
												"sink": {
													"name": "TRAININGSPORT",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "INTEREST",
													"type": "String"
												},
												"sink": {
													"name": "INTEREST",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "APPID",
													"type": "Int64"
												},
												"sink": {
													"name": "APPID",
													"type": "Int64",
													"physicalType": "bigint"
												}
											},
											{
												"source": {
													"name": "MILITARYNO",
													"type": "String"
												},
												"sink": {
													"name": "MILITARYNO",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "RELATIVEID",
													"type": "Int64"
												},
												"sink": {
													"name": "RELATIVEID",
													"type": "Int64",
													"physicalType": "bigint"
												}
											},
											{
												"source": {
													"name": "RELATIVEID2",
													"type": "Int64"
												},
												"sink": {
													"name": "RELATIVEID2",
													"type": "Int64",
													"physicalType": "bigint"
												}
											},
											{
												"source": {
													"name": "MILITARYCLOSETYPE",
													"type": "String"
												},
												"sink": {
													"name": "MILITARYCLOSETYPE",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "MILITARYCOMMENT",
													"type": "String"
												},
												"sink": {
													"name": "MILITARYCOMMENT",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "LINKEDIN",
													"type": "String"
												},
												"sink": {
													"name": "LINKEDIN",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "FACEBOOK",
													"type": "String"
												},
												"sink": {
													"name": "FACEBOOK",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "TWITTER",
													"type": "String"
												},
												"sink": {
													"name": "TWITTER",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "ISSPYOATH",
													"type": "String"
												},
												"sink": {
													"name": "ISSPYOATH",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "SPYOATHDATE",
													"type": "String"
												},
												"sink": {
													"name": "SPYOATHDATE",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "ISGOVERNMENTOATH",
													"type": "String"
												},
												"sink": {
													"name": "ISGOVERNMENTOATH",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "GOVERNMENTOATHDATE",
													"type": "String"
												},
												"sink": {
													"name": "GOVERNMENTOATHDATE",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "ISMILITARYOATH",
													"type": "String"
												},
												"sink": {
													"name": "ISMILITARYOATH",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "MILITARYOATHDATE",
													"type": "String"
												},
												"sink": {
													"name": "MILITARYOATHDATE",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "LINKID",
													"type": "String"
												},
												"sink": {
													"name": "LINKID",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "ISRESIDENT",
													"type": "String"
												},
												"sink": {
													"name": "ISRESIDENT",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "CIVILID",
													"type": "String"
												},
												"sink": {
													"name": "CIVILID",
													"type": "String",
													"physicalType": "nvarchar"
												}
											}
										],
										"typeConversion": true,
										"typeConversionSettings": {
											"allowDataTruncation": true,
											"treatBooleanAsNumber": false
										}
									}
								},
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"EMPID"
									]
								}
							},
							{
								"source": {
									"table": "TBLPOSITION"
								},
								"destination": {
									"table": "TBLPOSITION"
								},
								"copySink": {
									"writeBehavior": "upsert",
									"sqlWriterUseTableLock": null
								},
								"copyActivity": {
									"translator": {
										"type": "TabularTranslator",
										"mappings": [
											{
												"source": {
													"name": "POSITIONID",
													"type": "Int64"
												},
												"sink": {
													"name": "POSITIONID",
													"type": "Int64",
													"physicalType": "bigint"
												}
											},
											{
												"source": {
													"name": "COMPANYID",
													"type": "String"
												},
												"sink": {
													"name": "COMPANYID",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "DEPID",
													"type": "String"
												},
												"sink": {
													"name": "DEPID",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "POSGROUPID",
													"type": "Int64"
												},
												"sink": {
													"name": "POSGROUPID",
													"type": "Int64",
													"physicalType": "bigint"
												}
											},
											{
												"source": {
													"name": "CODE",
													"type": "String"
												},
												"sink": {
													"name": "CODE",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "NAME",
													"type": "String"
												},
												"sink": {
													"name": "NAME",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "EMPLOYMENTTYPEID",
													"type": "Int64"
												},
												"sink": {
													"name": "EMPLOYMENTTYPEID",
													"type": "Int64",
													"physicalType": "bigint"
												}
											},
											{
												"source": {
													"name": "GRADEID",
													"type": "Int64"
												},
												"sink": {
													"name": "GRADEID",
													"type": "Int64",
													"physicalType": "bigint"
												}
											},
											{
												"source": {
													"name": "DIRECTPOSITIONID",
													"type": "Int64"
												},
												"sink": {
													"name": "DIRECTPOSITIONID",
													"type": "Int64",
													"physicalType": "bigint"
												}
											},
											{
												"source": {
													"name": "NONDIRECTPOSITIONID",
													"type": "Int64"
												},
												"sink": {
													"name": "NONDIRECTPOSITIONID",
													"type": "Int64",
													"physicalType": "bigint"
												}
											},
											{
												"source": {
													"name": "REPORTPOSITIONID",
													"type": "Int64"
												},
												"sink": {
													"name": "REPORTPOSITIONID",
													"type": "Int64",
													"physicalType": "bigint"
												}
											},
											{
												"source": {
													"name": "GOAL",
													"type": "String"
												},
												"sink": {
													"name": "GOAL",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "CHARACTERISTIC",
													"type": "String"
												},
												"sink": {
													"name": "CHARACTERISTIC",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "VACANCYDAYS",
													"type": "Int64"
												},
												"sink": {
													"name": "VACANCYDAYS",
													"type": "Int64",
													"physicalType": "bigint"
												}
											},
											{
												"source": {
													"name": "LABOURCONDITION",
													"type": "String"
												},
												"sink": {
													"name": "LABOURCONDITION",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "ISACTIVE",
													"type": "String"
												},
												"sink": {
													"name": "ISACTIVE",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "CREATED",
													"type": "String"
												},
												"sink": {
													"name": "CREATED",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "CREATEDBY",
													"type": "String"
												},
												"sink": {
													"name": "CREATEDBY",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "UPDATED",
													"type": "String"
												},
												"sink": {
													"name": "UPDATED",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "UPDATEDBY",
													"type": "String"
												},
												"sink": {
													"name": "UPDATEDBY",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "IPADDRESS",
													"type": "String"
												},
												"sink": {
													"name": "IPADDRESS",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "MACADDRESS",
													"type": "String"
												},
												"sink": {
													"name": "MACADDRESS",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "TSTAMP",
													"type": "DateTime"
												},
												"sink": {
													"name": "TSTAMP",
													"type": "DateTime",
													"physicalType": "datetime2"
												}
											},
											{
												"source": {
													"name": "JOBDESCID",
													"type": "Int64"
												},
												"sink": {
													"name": "JOBDESCID",
													"type": "Int64",
													"physicalType": "bigint"
												}
											},
											{
												"source": {
													"name": "JOBID",
													"type": "Int64"
												},
												"sink": {
													"name": "JOBID",
													"type": "Int64",
													"physicalType": "bigint"
												}
											},
											{
												"source": {
													"name": "TYPE",
													"type": "String"
												},
												"sink": {
													"name": "TYPE",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "POSITIONOCCID",
													"type": "Int64"
												},
												"sink": {
													"name": "POSITIONOCCID",
													"type": "Int64",
													"physicalType": "bigint"
												}
											},
											{
												"source": {
													"name": "POSLEVEL",
													"type": "Int64"
												},
												"sink": {
													"name": "POSLEVEL",
													"type": "Int64",
													"physicalType": "bigint"
												}
											},
											{
												"source": {
													"name": "JDECOSTCENTER",
													"type": "String"
												},
												"sink": {
													"name": "JDECOSTCENTER",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "JDE_F0006_CO",
													"type": "String"
												},
												"sink": {
													"name": "JDE_F0006_CO",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "JDE_F0006_RP01",
													"type": "String"
												},
												"sink": {
													"name": "JDE_F0006_RP01",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "JDE_F0006_RP02",
													"type": "String"
												},
												"sink": {
													"name": "JDE_F0006_RP02",
													"type": "String",
													"physicalType": "nvarchar"
												}
											},
											{
												"source": {
													"name": "POSCATEGORYID",
													"type": "Int64"
												},
												"sink": {
													"name": "POSCATEGORYID",
													"type": "Int64",
													"physicalType": "bigint"
												}
											}
										],
										"typeConversion": true,
										"typeConversionSettings": {
											"allowDataTruncation": true,
											"treatBooleanAsNumber": false
										}
									}
								},
								"upsertSettings": {
									"useTempDB": true,
									"keys": [
										"POSITIONID"
									]
								}
							}
						]
					}
				},
				"folder": {
					"name": "HR Pipelines/DW"
				},
				"annotations": [],
				"lastPublishTime": "2025-11-27T09:26:11Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/SourceDataset_xii')]",
				"[concat(variables('factoryId'), '/datasets/DestinationDataset_xii')]",
				"[concat(variables('factoryId'), '/linkedServices/linkedService_err')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/GreenERP_ALLEMPLOYEE_Raw')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy_qd9",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"partitionOption": "None"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings",
									"copyBehavior": "FlattenHierarchy"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "HR_GreenERP_DS",
								"type": "DatasetReference",
								"parameters": {
									"tableName": "TBLEMPLOYEE"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ADLS_Raw_GreenErp_CSV",
								"type": "DatasetReference",
								"parameters": {
									"cw_fileName": "ALLEMPLOYEE.csv",
									"cw_folderPath": "@pipeline().parameters.main_directory"
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"windowStart": {
						"type": "String"
					},
					"windowEnd": {
						"type": "String"
					},
					"main_directory": {
						"type": "String",
						"defaultValue": "GreenErp"
					}
				},
				"folder": {
					"name": "HR Pipelines/EVS"
				},
				"annotations": [],
				"lastPublishTime": "2025-11-19T10:54:57Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/HR_GreenERP_DS')]",
				"[concat(variables('factoryId'), '/datasets/ADLS_Raw_GreenErp_CSV')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/GreenERP_AllEmployee')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "EmployeeProfile_From_GreenHR",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "EmployeeProfile_From_GreenHR",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"sourceEmployees": {},
									"existingEmployees": {},
									"Employee": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"windowStart": {
						"type": "String"
					},
					"windowEnd": {
						"type": "String"
					},
					"main_directory": {
						"type": "String",
						"defaultValue": "GreenErp"
					}
				},
				"folder": {
					"name": "HR Pipelines/EVS"
				},
				"annotations": [],
				"lastPublishTime": "2025-11-24T11:00:03Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/dataflows/EmployeeProfile_From_GreenHR')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/GreenERP_HREmployee')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy_qd9",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"partitionOption": "None"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings",
									"copyBehavior": "FlattenHierarchy"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"logSettings": {
								"enableCopyActivityLog": true,
								"copyActivityLogSettings": {
									"logLevel": "Info",
									"enableReliableLogging": false
								},
								"logLocationSettings": {
									"linkedServiceName": {
										"referenceName": "linkedService_err",
										"type": "LinkedServiceReference"
									},
									"path": "tblemployee"
								}
							},
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "HR_GreenERP_DS",
								"type": "DatasetReference",
								"parameters": {
									"tableName": "TBLEMPLOYEE"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ADLS_Raw_GreenErp_CSV",
								"type": "DatasetReference",
								"parameters": {
									"cw_fileName": "HREMPLOYEE.csv",
									"cw_folderPath": "@pipeline().parameters.main_directory"
								}
							}
						]
					},
					{
						"name": "ADLS_Staging",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "Copy_qd9",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "ADLS_Staging_employee",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"source1": {
										"cwfolder": "GreenErp",
										"cwfilename": "HREMPLOYEE.csv"
									},
									"sink1": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"windowStart": {
						"type": "String"
					},
					"windowEnd": {
						"type": "String"
					},
					"main_directory": {
						"type": "String",
						"defaultValue": "GreenErp"
					},
					"cwfolder": {
						"type": "string",
						"defaultValue": "GreenErp"
					},
					"cwfilename": {
						"type": "string",
						"defaultValue": "HREMPLOYEE.csv"
					}
				},
				"folder": {
					"name": "HR Pipelines/DW"
				},
				"annotations": [],
				"lastPublishTime": "2025-11-27T09:26:10Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/HR_GreenERP_DS')]",
				"[concat(variables('factoryId'), '/datasets/ADLS_Raw_GreenErp_CSV')]",
				"[concat(variables('factoryId'), '/dataflows/ADLS_Staging_employee')]",
				"[concat(variables('factoryId'), '/linkedServices/linkedService_err')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/GreenERP_SIDEPARTMENTTYPE')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy_qd9",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"partitionOption": "None"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings",
									"copyBehavior": "FlattenHierarchy"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "HR_GreenERP_DS",
								"type": "DatasetReference",
								"parameters": {
									"tableName": "SIDEPARTMENTTYPE"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ADLS_Raw_GreenErp_CSV",
								"type": "DatasetReference",
								"parameters": {
									"cw_fileName": "SIDEPARTMENTTYPE.csv",
									"cw_folderPath": "@pipeline().parameters.main_directory"
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"windowStart": {
						"type": "String"
					},
					"windowEnd": {
						"type": "String"
					},
					"main_directory": {
						"type": "String",
						"defaultValue": "GreenErp"
					}
				},
				"folder": {
					"name": "HR Pipelines/DW_Mysql"
				},
				"annotations": [],
				"lastPublishTime": "2025-11-27T09:26:10Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/HR_GreenERP_DS')]",
				"[concat(variables('factoryId'), '/datasets/ADLS_Raw_GreenErp_CSV')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/GreenERP_SIGRADE')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy_qd9",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"partitionOption": "None"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings",
									"copyBehavior": "FlattenHierarchy"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "HR_GreenERP_DS",
								"type": "DatasetReference",
								"parameters": {
									"tableName": "SIGRADE"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ADLS_Raw_GreenErp_CSV",
								"type": "DatasetReference",
								"parameters": {
									"cw_fileName": "SIGRADE.csv",
									"cw_folderPath": "@pipeline().parameters.main_directory"
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"windowStart": {
						"type": "String"
					},
					"windowEnd": {
						"type": "String"
					},
					"main_directory": {
						"type": "String",
						"defaultValue": "GreenErp"
					}
				},
				"folder": {
					"name": "HR Pipelines/DW_Mysql"
				},
				"annotations": [],
				"lastPublishTime": "2025-11-27T09:26:10Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/HR_GreenERP_DS')]",
				"[concat(variables('factoryId'), '/datasets/ADLS_Raw_GreenErp_CSV')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/GreenERP_SILEVEL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy_qd9",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"partitionOption": "None"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings",
									"copyBehavior": "FlattenHierarchy"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "HR_GreenERP_DS",
								"type": "DatasetReference",
								"parameters": {
									"tableName": "SILEVEL"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ADLS_Raw_GreenErp_CSV",
								"type": "DatasetReference",
								"parameters": {
									"cw_fileName": "SILEVEL.csv",
									"cw_folderPath": "@pipeline().parameters.main_directory"
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"windowStart": {
						"type": "String"
					},
					"windowEnd": {
						"type": "String"
					},
					"main_directory": {
						"type": "String",
						"defaultValue": "GreenErp"
					}
				},
				"folder": {
					"name": "HR Pipelines/DW_Mysql"
				},
				"annotations": [],
				"lastPublishTime": "2025-11-27T09:26:10Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/HR_GreenERP_DS')]",
				"[concat(variables('factoryId'), '/datasets/ADLS_Raw_GreenErp_CSV')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/GreenERP_TBLCOMPANY')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy_qd9",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"partitionOption": "None"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings",
									"copyBehavior": "FlattenHierarchy"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "HR_GreenERP_DS",
								"type": "DatasetReference",
								"parameters": {
									"tableName": "TBLCOMPANY"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ADLS_Raw_GreenErp_CSV",
								"type": "DatasetReference",
								"parameters": {
									"cw_fileName": "TBLCOMPANY.csv",
									"cw_folderPath": "@pipeline().parameters.main_directory"
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"windowStart": {
						"type": "String"
					},
					"windowEnd": {
						"type": "String"
					},
					"main_directory": {
						"type": "String",
						"defaultValue": "GreenErp"
					}
				},
				"folder": {
					"name": "HR Pipelines/DW_Mysql"
				},
				"annotations": [],
				"lastPublishTime": "2025-11-27T09:26:10Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/HR_GreenERP_DS')]",
				"[concat(variables('factoryId'), '/datasets/ADLS_Raw_GreenErp_CSV')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/GreenERP_TBLDEPARTMENT')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy_qd9",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"partitionOption": "None"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings",
									"copyBehavior": "FlattenHierarchy"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "HR_GreenERP_DS",
								"type": "DatasetReference",
								"parameters": {
									"tableName": "TBLDEPARTMENT"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ADLS_Raw_GreenErp_CSV",
								"type": "DatasetReference",
								"parameters": {
									"cw_fileName": "TBLDEPARTMENT.csv",
									"cw_folderPath": "@pipeline().parameters.main_directory"
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"windowStart": {
						"type": "String"
					},
					"windowEnd": {
						"type": "String"
					},
					"main_directory": {
						"type": "String",
						"defaultValue": "GreenErp"
					}
				},
				"folder": {
					"name": "HR Pipelines/DW_Mysql"
				},
				"annotations": [],
				"lastPublishTime": "2025-11-27T09:26:10Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/HR_GreenERP_DS')]",
				"[concat(variables('factoryId'), '/datasets/ADLS_Raw_GreenErp_CSV')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/GreenERP_TBLEMPEMPLHIST')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy_qd9",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"partitionOption": "None"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings",
									"copyBehavior": "FlattenHierarchy"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "HR_GreenERP_DS",
								"type": "DatasetReference",
								"parameters": {
									"tableName": "TBLEMPEMPLHIST"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ADLS_Raw_GreenErp_CSV",
								"type": "DatasetReference",
								"parameters": {
									"cw_fileName": "TBLEMPEMPLHIST.csv",
									"cw_folderPath": "@pipeline().parameters.main_directory"
								}
							}
						]
					},
					{
						"name": "ADLS_Staging_copy1",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "Copy_qd9",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "ADLS_Staging_copy1",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"source1": {
										"cwfolder": "GreenErp",
										"cwfilename": "TBLEMPEMPLHIST.csv"
									},
									"sink1": {
										"cwfolder": "TBLEMPEMPLHIST"
									}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"windowStart": {
						"type": "String"
					},
					"windowEnd": {
						"type": "String"
					},
					"main_directory": {
						"type": "String",
						"defaultValue": "GreenErp"
					}
				},
				"folder": {
					"name": "HR Pipelines/DW_Mysql"
				},
				"annotations": [],
				"lastPublishTime": "2025-11-27T09:26:10Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/HR_GreenERP_DS')]",
				"[concat(variables('factoryId'), '/datasets/ADLS_Raw_GreenErp_CSV')]",
				"[concat(variables('factoryId'), '/dataflows/ADLS_Staging_copy1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/GreenERP_TBLPOSITION')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy_qd9",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"partitionOption": "None"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings",
									"copyBehavior": "FlattenHierarchy"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "HR_GreenERP_DS",
								"type": "DatasetReference",
								"parameters": {
									"tableName": "TBLPOSITION"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ADLS_Raw_GreenErp_CSV",
								"type": "DatasetReference",
								"parameters": {
									"cw_fileName": "TBLPOSITION.csv",
									"cw_folderPath": "@pipeline().parameters.main_directory"
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"windowStart": {
						"type": "String"
					},
					"windowEnd": {
						"type": "String"
					},
					"main_directory": {
						"type": "String",
						"defaultValue": "GreenErp"
					}
				},
				"folder": {
					"name": "HR Pipelines/DW_Mysql"
				},
				"annotations": [],
				"lastPublishTime": "2025-11-27T09:26:10Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/HR_GreenERP_DS')]",
				"[concat(variables('factoryId'), '/datasets/ADLS_Raw_GreenErp_CSV')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/IPConfig')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Web1",
						"type": "WebActivity",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"method": "GET",
							"headers": {},
							"url": "https://ifconfig.me/ip"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "HR Pipelines"
				},
				"annotations": [],
				"lastPublishTime": "2025-11-20T09:40:22Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/TD_Customer_Full_Flow')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Customer_DBToCSV",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": {
									"value": "select\n    CusID,\n    REPLACE(REPLACE(CusName, CHAR(10), ''), CHAR(13), '') AS CusName,\n    REPLACE(REPLACE(REPLACE(cusAddress, CHAR(10), ''), CHAR(13), ''), '\"', '') AS cusAddress,\n    ISISChannelID,\n    OwnerID,\n    REPLACE(REPLACE(OwnerName, CHAR(10), ''), CHAR(13), '') AS OwnerName,\n    REPLACE(REPLACE(INN, CHAR(10), ''), CHAR(13), '') AS INN,\n    REPLACE(REPLACE(CusType, CHAR(10), ''), CHAR(13), '') AS StoreTypeName,\n    REPLACE(REPLACE(Region, CHAR(10), ''), CHAR(13), '') AS  Region,\n    REPLACE(REPLACE(SumNer, CHAR(10), ''), CHAR(13), '') AS SumNer,\n    CreateDate,\n    UpdateDate\nfrom BigOneFullCustomers_D",
									"type": "Expression"
								},
								"partitionOption": "None"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"validateDataConsistency": true,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "FMCG_SQLServer_QVReports",
								"type": "DatasetReference",
								"parameters": {
									"cw_table": {
										"value": "@pipeline().parameters.src_customer_table",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ADLS_Raw_CSV",
								"type": "DatasetReference",
								"parameters": {
									"csv_fileName": {
										"value": "@pipeline().parameters.dest_customer_file",
										"type": "Expression"
									},
									"csv_directory": {
										"value": "@pipeline().parameters.dest_folder",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "TradeshopGPS_DBToCSV",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Customer_DBToCSV",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"partitionOption": "None"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"validateDataConsistency": true,
							"logSettings": {
								"enableCopyActivityLog": true,
								"copyActivityLogSettings": {
									"logLevel": "Warning",
									"enableReliableLogging": true
								},
								"logLocationSettings": {
									"linkedServiceName": {
										"referenceName": "ADLS_FMCS_RAW",
										"type": "LinkedServiceReference"
									},
									"path": "fmcg-raw/logs"
								}
							},
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "FMCG_SQLServer_QVReports",
								"type": "DatasetReference",
								"parameters": {
									"cw_table": {
										"value": "@pipeline().parameters.src_tradeshop_gps_table",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ADLS_Raw_CSV",
								"type": "DatasetReference",
								"parameters": {
									"csv_fileName": {
										"value": "@pipeline().parameters.dest_gps_file",
										"type": "Expression"
									},
									"csv_directory": {
										"value": "@pipeline().parameters.dest_folder",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"src_customer_table": {
						"type": "string",
						"defaultValue": "BigOneFullCustomers_D"
					},
					"src_tradeshop_gps_table": {
						"type": "string",
						"defaultValue": "TradeshopGPS_TD"
					},
					"dest_folder": {
						"type": "string",
						"defaultValue": "td_dwh_sink"
					},
					"dest_customer_file": {
						"type": "string",
						"defaultValue": "td_dwh_full_customer.csv"
					},
					"dest_gps_file": {
						"type": "string",
						"defaultValue": "td_dwh_full_trade_shop_gps.csv"
					}
				},
				"folder": {
					"name": "TD Pipelines/Customer"
				},
				"annotations": [],
				"lastPublishTime": "2025-11-11T04:37:21Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/FMCG_SQLServer_QVReports')]",
				"[concat(variables('factoryId'), '/datasets/ADLS_Raw_CSV')]",
				"[concat(variables('factoryId'), '/linkedServices/ADLS_FMCS_RAW')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/TD_MainDB_to_Raw')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy RouteDays src to raw",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "FMCG_SQLServer_MainDB",
								"type": "DatasetReference",
								"parameters": {
									"cw_table": "TD_RouteDays"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ADLS_Raw_CSV",
								"type": "DatasetReference",
								"parameters": {
									"csv_fileName": "td_dwh_route_days.csv",
									"csv_directory": {
										"value": "@pipeline().parameters.main_directory",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Copy SalesReps src to raw",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy RouteDays src to raw",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "FMCG_SQLServer_MainDB",
								"type": "DatasetReference",
								"parameters": {
									"cw_table": "TD_Salereps"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ADLS_Raw_CSV",
								"type": "DatasetReference",
								"parameters": {
									"csv_fileName": "td_dwh_sales_reps.csv",
									"csv_directory": {
										"value": "@pipeline().parameters.main_directory",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"main_directory": {
						"type": "string",
						"defaultValue": "td_dwh_sink"
					}
				},
				"folder": {
					"name": "TD Pipelines"
				},
				"annotations": [],
				"lastPublishTime": "2025-11-11T04:37:21Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/FMCG_SQLServer_MainDB')]",
				"[concat(variables('factoryId'), '/datasets/ADLS_Raw_CSV')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/TD_Small_Tables_Full_Extract')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy Products src to raw",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "FMCG_SQLServer_QVReports",
								"type": "DatasetReference",
								"parameters": {
									"cw_table": "BigOneFullProducts_D"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ADLS_Raw_CSV",
								"type": "DatasetReference",
								"parameters": {
									"csv_fileName": "td_dwh_full_product.csv",
									"csv_directory": {
										"value": "@pipeline().parameters.main_directory",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"main_directory": {
						"type": "string",
						"defaultValue": "td_dwh_sink"
					}
				},
				"folder": {
					"name": "TD Pipelines"
				},
				"annotations": [],
				"lastPublishTime": "2025-11-11T04:37:21Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/FMCG_SQLServer_QVReports')]",
				"[concat(variables('factoryId'), '/datasets/ADLS_Raw_CSV')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/dwh_pl_company')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "dataflow1",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "dwh_df_company",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"source1": {
										"tableName": "TBLCOMPANY",
										"schema": "HRMS_PROD"
									},
									"sink1": {
										"tableName": "dim_company",
										"schema": "dwh_hr"
									}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "HR Pipelines/DW"
				},
				"annotations": [],
				"lastPublishTime": "2025-11-27T09:26:10Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/dataflows/dwh_df_company')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/dwh_pl_department')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "dwh_df_department",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "dwh_df_department",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"source1": {
										"tableName": "TBLDEPARTMENT",
										"schema": "HRMS_PROD"
									},
									"source2": {
										"tableName": "dim_company",
										"schema": "dwh_hr"
									},
									"sink1": {
										"tableName": "dim_department",
										"schema": "dwh_hr"
									}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "HR Pipelines/DW"
				},
				"annotations": [],
				"lastPublishTime": "2025-11-27T09:26:10Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/dataflows/dwh_df_department')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/dwh_pl_employee')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "dwh_df_employee",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "dwh_df_employee",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"source1": {
										"tableName": "TBLEMPLOYEE",
										"schema": "HRMS_PROD"
									},
									"source2": {
										"tableName": "dim_company",
										"schema": "dwh_hr"
									},
									"sink1": {
										"tableName": "dim_employee",
										"schema": "dwh_hr"
									}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "HR Pipelines/DW"
				},
				"annotations": [],
				"lastPublishTime": "2025-11-27T09:26:10Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/dataflows/dwh_df_employee')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/dwh_pl_employee_history')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "dwh_df_employee_history",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "dwh_df_employee_history",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"employeeHist": {
										"tableName": "TBLEMPEMPLHIST",
										"schema": "HRMS_PROD"
									},
									"company": {
										"tableName": "dim_company",
										"schema": "dwh_hr"
									},
									"employee": {
										"tableName": "dim_employee",
										"schema": "dwh_hr"
									},
									"department": {
										"tableName": "dim_department",
										"schema": "dwh_hr"
									},
									"position": {
										"tableName": "dim_position",
										"schema": "dwh_hr"
									},
									"grade": {
										"tableName": "dim_grade",
										"schema": "dwh_hr"
									},
									"level": {
										"tableName": "dim_level",
										"schema": "dwh_hr"
									},
									"sink1": {
										"tableName": "fact_employee_history",
										"schema": "dwh_hr"
									}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "HR Pipelines/DW"
				},
				"annotations": [],
				"lastPublishTime": "2025-11-27T09:26:10Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/dataflows/dwh_df_employee_history')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/dwh_pl_position')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "dwh_df_position",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "dwh_df_position",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"source1": {
										"tableName": "TBLPOSITION",
										"schema": "HRMS_PROD"
									},
									"source2": {
										"tableName": "dim_company",
										"schema": "dwh_hr"
									},
									"sink1": {
										"tableName": "dim_position",
										"schema": "dwh_hr"
									}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine",
							"continuationSettings": {
								"customizedCheckpointKey": "911d8120-6961-490d-9ec0-29f116b1cc9b"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "HR Pipelines/DW"
				},
				"annotations": [],
				"lastPublishTime": "2025-11-27T09:26:10Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/dataflows/dwh_df_position')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/dwh_pl_sigrade')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "dwh_df_sigrade",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "dwh_df_sigrade",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"source1": {
										"tableName": "SIGRADE",
										"schema": "HRMS_PROD"
									},
									"sink1": {
										"tableName": "dim_grade",
										"schema": "dwh_hr"
									}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "HR Pipelines/DW"
				},
				"annotations": [],
				"lastPublishTime": "2025-11-27T09:26:10Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/dataflows/dwh_df_sigrade')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/dwh_pl_silevel')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "dwh_df_silevel",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "dwh_df_silevel",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"source1": {
										"tableName": "SILEVEL",
										"schema": "HRMS_PROD"
									},
									"sinkDimLevel": {
										"tableName": "dim_level",
										"schema": "dwh_hr"
									}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "HR Pipelines/DW"
				},
				"annotations": [],
				"lastPublishTime": "2025-11-27T09:26:11Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/dataflows/dwh_df_silevel')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/pipeline1')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "EmployeeProfile_deletes",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "EmployeeProfile_deletes",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"existingSource0": {},
									"deleteOldSource0": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"annotations": [],
				"lastPublishTime": "2025-11-25T09:03:50Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/dataflows/EmployeeProfile_deletes')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_evs_allemployee_UpsertTrigger')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy_xy6",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "newQuery0"
							},
							{
								"name": "Destination",
								"value": "evs//evs"
							}
						],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "select \n    FIRSTNAME as \"fn\",\n    LASTNAME as \"ln\",\n    REGNO as \"rn\",\n    COMPANYID as \"oid\",\n    PNAME as \"po\",\n    GNAME as \"gname\",\n    STATUS as \"status\",\n    EMPID as \"empid\",\n    STATUSDATE as \"status_date\",\n    ISFOREIGNER as \"is_foreigner\"\nfrom HRMS_PROD.V_BI_HREMPLOYEE \nwhere COMPANYID in  ('MCSCC', 'TD', 'TEL', 'AG', 'MG', 'ES', 'BMS', 'MCSES') \nand STATUS <> ''",
								"partitionOption": "None"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings",
									"metadata": [
										{
											"name": "dfs",
											"value": "sdf"
										}
									]
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"validateDataConsistency": false,
							"logSettings": {
								"enableCopyActivityLog": true,
								"copyActivityLogSettings": {
									"logLevel": "Warning",
									"enableReliableLogging": false
								},
								"logLocationSettings": {
									"linkedServiceName": {
										"referenceName": "linkedService_err",
										"type": "LinkedServiceReference"
									},
									"path": "error"
								}
							},
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SourceDataset_xy6",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Evs_csv",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "df_evs_allemployee_upsert",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "Copy_xy6",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "df_evs_allemployee_upsert",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"sourceEmployees": {},
									"existingAllSources": {},
									"upsertEmployees": {},
									"archiveToDataLake": {
										"fileName": "evs_archive.csv",
										"folderName": "archive"
									},
									"logSkippedMigrated": {
										"fileName": "evs_skip.csv",
										"folderName": "skipped"
									}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"windowStart": {
						"type": "String"
					},
					"windowEnd": {
						"type": "String"
					}
				},
				"folder": {
					"name": "HR Pipelines/EVS"
				},
				"annotations": [],
				"lastPublishTime": "2025-11-27T04:29:42Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/SourceDataset_xy6')]",
				"[concat(variables('factoryId'), '/datasets/Evs_csv')]",
				"[concat(variables('factoryId'), '/dataflows/df_evs_allemployee_upsert')]",
				"[concat(variables('factoryId'), '/linkedServices/linkedService_err')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_evs_allemployee_stopped')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy_xy6",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "newQuery0"
							},
							{
								"name": "Destination",
								"value": "evs//evs"
							}
						],
						"typeProperties": {
							"source": {
								"type": "OracleSource",
								"oracleReaderQuery": "select \n    FIRSTNAME as \"fn\",\n    LASTNAME as \"ln\",\n    REGNO as \"rn\",\n    COMPANYID as \"oid\",\n    PNAME as \"po\",\n    GNAME as \"gname\",\n    STATUS as \"status\",\n    EMPID as \"empid\",\n    STATUSDATE as \"status_date\",\n    ISFOREIGNER as \"is_foreigner\"\nfrom HRMS_PROD.V_BI_HREMPLOYEE \nwhere COMPANYID in  ('MCSCC', 'TD', 'TEL', 'AG', 'MG', 'ES', 'BMS', 'MCSES') \nand STATUS <> ''",
								"partitionOption": "None"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings",
									"metadata": [
										{
											"name": "dfs",
											"value": "sdf"
										}
									]
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"validateDataConsistency": false,
							"logSettings": {
								"enableCopyActivityLog": true,
								"copyActivityLogSettings": {
									"logLevel": "Warning",
									"enableReliableLogging": false
								},
								"logLocationSettings": {
									"linkedServiceName": {
										"referenceName": "linkedService_err",
										"type": "LinkedServiceReference"
									},
									"path": "error"
								}
							},
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SourceDataset_xy6",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Evs_csv",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "df_evs_allemployee",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "Copy_xy6",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "df_evs_allemployee",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"sourceEmployees": {},
									"existingAllSources": {},
									"insertNewEmployees": {},
									"archiveToDataLake": {
										"csv_fileName": "evs_log",
										"csv_directory": "error"
									}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"windowStart": {
						"type": "String"
					},
					"windowEnd": {
						"type": "String"
					}
				},
				"folder": {
					"name": "HR Pipelines/EVS"
				},
				"annotations": [],
				"lastPublishTime": "2025-11-27T04:33:58Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/SourceDataset_xy6')]",
				"[concat(variables('factoryId'), '/datasets/Evs_csv')]",
				"[concat(variables('factoryId'), '/dataflows/df_evs_allemployee')]",
				"[concat(variables('factoryId'), '/linkedServices/linkedService_err')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/test')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "dwh_df_employee_history_copy1",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "dwh_df_employee_history_copy1",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"employee": {
										"tableName": "dim_employee",
										"schema": "dwh_hr"
									},
									"sink1": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"annotations": [],
				"lastPublishTime": "2025-11-23T03:23:20Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/dataflows/dwh_df_employee_history_copy1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/to_DWH_SIGRADE')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "SIGRADE_From_Staging_to_DWH",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "SIGRADE_From_Staging_to_DWH",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"source1": {
										"cwfolder": "SIGRADE"
									},
									"sink1": {
										"cwtablename": "dim_grade"
									}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "HR Pipelines/DW_Mysql"
				},
				"annotations": [],
				"lastPublishTime": "2025-11-27T09:26:10Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/dataflows/SIGRADE_From_Staging_to_DWH')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/to_DWH_SILEVEL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "SILEVEL_From_Staging_to_DWH",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "SILEVEL_From_Staging_to_DWH",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"source1": {
										"cwfolder": "SILEVEL"
									},
									"sink1": {
										"cwtablename": "dim_level"
									}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "HR Pipelines/DW_Mysql"
				},
				"annotations": [],
				"lastPublishTime": "2025-11-27T09:26:10Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/dataflows/SILEVEL_From_Staging_to_DWH')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/to_DWH_TBLCOMPANY')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "TBLCOMPANY_From_Staging_to_DWH",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "TBLCOMPANY_From_Staging_to_DWH",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"source1": {
										"cwfolder": "TBLCOMPANY"
									},
									"sink1": {
										"cwtablename": "dim_company"
									}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "HR Pipelines/DW_Mysql"
				},
				"annotations": [],
				"lastPublishTime": "2025-11-27T09:26:10Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/dataflows/TBLCOMPANY_From_Staging_to_DWH')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/to_DWH_TBLDEPARTMENT')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "From_Staging_to_DWH_TBLDEPARTMENT",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "From_Staging_to_DWH_TBLDEPARTMENT",
								"type": "DataFlowReference",
								"parameters": {
									"cwfolder": "\"TBLDEPARTMENT\"",
									"cwtablename": "\"dim_department\""
								},
								"datasetParameters": {
									"source1": {
										"cwfolder": "TBLDEPARTMENT"
									},
									"source2": {
										"cwtablename": "dim_company"
									},
									"sink1": {
										"cwtablename": "dim_department"
									}
								},
								"linkedServiceParameters": {
									"sink1": {
										"schemaLinkedService": {
											"cwtablename": "dim_department"
										}
									}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "HR Pipelines/DW_Mysql"
				},
				"annotations": [],
				"lastPublishTime": "2025-11-27T09:26:10Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/dataflows/From_Staging_to_DWH_TBLDEPARTMENT')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/to_DWH_TBLEMPEMPLHIST')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "TBLEMPEMPLHIST_From_Staging_to_DWH",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "TBLEMPEMPLHIST_From_Staging_to_DWH",
								"type": "DataFlowReference",
								"parameters": {
									"cwfolder": "\"TBLEMPEMPLHIST\""
								},
								"datasetParameters": {
									"source1": {
										"cwfolder": "TBLEMPEMPLHIST"
									},
									"source2": {
										"cwtablename": "dim_employee"
									},
									"source3": {
										"cwtablename": "dim_company"
									},
									"source4": {
										"cwtablename": "dim_department"
									},
									"source5": {
										"cwtablename": "dim_position"
									},
									"source6": {
										"cwtablename": "dim_grade"
									},
									"source7": {
										"cwtablename": "dim_level"
									},
									"sink1": {
										"cwtablename": "fact_employee_history"
									}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "HR Pipelines/DW_Mysql"
				},
				"annotations": [],
				"lastPublishTime": "2025-11-27T09:26:10Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/dataflows/TBLEMPEMPLHIST_From_Staging_to_DWH')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/to_DWH_TBLEmployee')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Employee_From_Staging_to_DWH",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "Employee_From_Staging_to_DWH",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"source1": {
										"cwfolder": "TBLEMPLOYEE"
									},
									"sink1": {
										"cwtablename": "dim_employee"
									}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine",
							"runConcurrently": true,
							"continueOnError": true
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "HR Pipelines/DW_Mysql"
				},
				"annotations": [],
				"lastPublishTime": "2025-11-27T09:26:10Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/dataflows/Employee_From_Staging_to_DWH')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/to_DWH_TBLPOSITION')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "TBLPOSITION_From_Staging_to_DWH",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "TBLPOSITION_From_Staging_to_DWH",
								"type": "DataFlowReference",
								"parameters": {
									"cwfolder": "\"TBLPOSITION\"",
									"cwtablename": "\"dim_position\""
								},
								"datasetParameters": {
									"source1": {
										"cwfolder": "TBLPOSITION"
									},
									"source2": {},
									"sink1": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "HR Pipelines/DW_Mysql"
				},
				"annotations": [],
				"lastPublishTime": "2025-11-27T09:26:11Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/dataflows/TBLPOSITION_From_Staging_to_DWH')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ADLS_Filtered_By_Date_CSV')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "ADLS_FMCS_RAW",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"cw_fileName": {
						"type": "String"
					},
					"cw_folderPath": {
						"type": "String"
					}
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@dataset().cw_fileName",
							"type": "Expression"
						},
						"folderPath": {
							"value": "@dataset().cw_folderPath",
							"type": "Expression"
						},
						"fileSystem": "fmcg-filtered"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/ADLS_FMCS_RAW')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ADLS_Filtered_CSV')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "ADLS_FMCS_RAW",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"csv_directory": {
						"type": "string"
					},
					"csv_fileName": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@dataset().csv_fileName",
							"type": "Expression"
						},
						"folderPath": {
							"value": "@dataset().csv_directory",
							"type": "Expression"
						},
						"fileSystem": "fmcg-filtered"
					},
					"columnDelimiter": ",",
					"compressionCodec": null,
					"compressionLevel": "Optimal",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/ADLS_FMCS_RAW')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ADLS_GreenErp_Staging')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureDataLakeStorage1",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"cw_fileName": {
						"type": "string"
					},
					"cw_folderPath": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@dataset().cw_fileName",
							"type": "Expression"
						},
						"folderPath": {
							"value": "@dataset().cw_folderPath",
							"type": "Expression"
						},
						"fileSystem": "hr-staging"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureDataLakeStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ADLS_Raw_By_Date_CSV')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "ADLS_FMCS_RAW",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"cw_fileName": {
						"type": "String"
					},
					"cw_folderPath": {
						"type": "String"
					}
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@dataset().cw_fileName",
							"type": "Expression"
						},
						"folderPath": {
							"value": "@dataset().cw_folderPath",
							"type": "Expression"
						},
						"fileSystem": "fmcg-raw"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/ADLS_FMCS_RAW')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ADLS_Raw_CSV')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "ADLS_FMCS_RAW",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"csv_fileName": {
						"type": "string"
					},
					"csv_directory": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@dataset().csv_fileName",
							"type": "Expression"
						},
						"folderPath": {
							"value": "@dataset().csv_directory",
							"type": "Expression"
						},
						"fileSystem": "fmcg-raw"
					},
					"columnDelimiter": ",",
					"compressionCodec": null,
					"compressionLevel": "Fastest",
					"encodingName": "UTF-8",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/ADLS_FMCS_RAW')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ADLS_Raw_Evs_csv')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureDataLakeStorage1",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"fileName": {
						"type": "String"
					},
					"folderName": {
						"type": "String"
					}
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@dataset().fileName",
							"type": "Expression"
						},
						"folderPath": {
							"value": "@dataset().folderName",
							"type": "Expression"
						},
						"fileSystem": "evs"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": [
					{
						"name": "fn",
						"type": "String"
					},
					{
						"name": "ln",
						"type": "String"
					},
					{
						"name": "rn",
						"type": "String"
					},
					{
						"name": "oid",
						"type": "String"
					},
					{
						"name": "po",
						"type": "String"
					},
					{
						"name": "gname",
						"type": "String"
					},
					{
						"name": "status",
						"type": "String"
					},
					{
						"name": "empid",
						"type": "String"
					},
					{
						"name": "status_date",
						"type": "String"
					},
					{
						"name": "is_foreigner",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureDataLakeStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ADLS_Raw_GreenErp_CSV')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureDataLakeStorage1",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"cw_fileName": {
						"type": "string"
					},
					"cw_folderPath": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@dataset().cw_fileName",
							"type": "Expression"
						},
						"folderPath": {
							"value": "@dataset().cw_folderPath",
							"type": "Expression"
						},
						"fileSystem": "hr-raw"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureDataLakeStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ADLS_Staging')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureDataLakeStorage1",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"cwfolder": {
						"type": "String",
						"defaultValue": "TBLDEPARTMENT"
					}
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": {
							"value": "@dataset().cwfolder",
							"type": "Expression"
						},
						"fileSystem": "hr-staging"
					},
					"compressionCodec": "snappy"
				},
				"schema": [
					{
						"name": "DEPID",
						"type": "INT_16"
					},
					{
						"name": "DEPCODE",
						"type": "UTF8"
					},
					{
						"name": "NAME",
						"type": "UTF8"
					},
					{
						"name": "ISACTIVE",
						"type": "BOOLEAN"
					},
					{
						"name": "PARENTID",
						"type": "UTF8"
					},
					{
						"name": "CREATED",
						"type": "UTF8"
					},
					{
						"name": "UPDATED",
						"type": "UTF8"
					},
					{
						"name": "COMPANYID",
						"type": "UTF8"
					},
					{
						"name": "DEPTYPEID",
						"type": "INT_16"
					},
					{
						"name": "PATH",
						"type": "UTF8"
					},
					{
						"name": "PARENTPATH",
						"type": "UTF8"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureDataLakeStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ADLS_Staging_Employee')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureDataLakeStorage1",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"cwfolder": {
						"type": "String",
						"defaultValue": "TBLEMPLOYEE"
					}
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": {
							"value": "@dataset().cwfolder",
							"type": "Expression"
						},
						"fileSystem": "hr-staging"
					},
					"compressionCodec": "snappy"
				},
				"schema": [
					{
						"name": "EMPID",
						"type": "UTF8"
					},
					{
						"name": "CODE",
						"type": "UTF8"
					},
					{
						"name": "FAMILYNAME",
						"type": "UTF8"
					},
					{
						"name": "LASTNAME",
						"type": "UTF8"
					},
					{
						"name": "FIRSTNAME",
						"type": "UTF8"
					},
					{
						"name": "GENDER",
						"type": "UTF8"
					},
					{
						"name": "BIRTHDATE",
						"type": "UTF8"
					},
					{
						"name": "BIRTHCOUNTRYID",
						"type": "UTF8"
					},
					{
						"name": "BIRTHDIVISIONID",
						"type": "UTF8"
					},
					{
						"name": "BIRTHDISTRICTID",
						"type": "UTF8"
					},
					{
						"name": "BIRTHPLACE",
						"type": "UTF8"
					},
					{
						"name": "COUNTRYID",
						"type": "UTF8"
					},
					{
						"name": "DIVISIONID",
						"type": "UTF8"
					},
					{
						"name": "DISTRICTID",
						"type": "UTF8"
					},
					{
						"name": "NATIONALITYID",
						"type": "UTF8"
					},
					{
						"name": "SOCIALORIGINID",
						"type": "UTF8"
					},
					{
						"name": "MARITALSTATUS",
						"type": "UTF8"
					},
					{
						"name": "BLOODGROUP",
						"type": "UTF8"
					},
					{
						"name": "REGNO",
						"type": "UTF8"
					},
					{
						"name": "PASSNO",
						"type": "UTF8"
					},
					{
						"name": "FORPASSNO",
						"type": "UTF8"
					},
					{
						"name": "EMDNO",
						"type": "UTF8"
					},
					{
						"name": "NDDNO",
						"type": "UTF8"
					},
					{
						"name": "ADDR1",
						"type": "UTF8"
					},
					{
						"name": "ADDR2",
						"type": "UTF8"
					},
					{
						"name": "HOMEPHONE",
						"type": "UTF8"
					},
					{
						"name": "MOBILEPHONE",
						"type": "UTF8"
					},
					{
						"name": "WORKPHONE",
						"type": "UTF8"
					},
					{
						"name": "WORKPHONEEXT",
						"type": "UTF8"
					},
					{
						"name": "FAX",
						"type": "UTF8"
					},
					{
						"name": "EMAIL",
						"type": "UTF8"
					},
					{
						"name": "POSTADDRESS",
						"type": "UTF8"
					},
					{
						"name": "CONTACTNAME",
						"type": "UTF8"
					},
					{
						"name": "CONTACTPHONE",
						"type": "UTF8"
					},
					{
						"name": "WITHPICTURE",
						"type": "UTF8"
					},
					{
						"name": "STATUS",
						"type": "UTF8"
					},
					{
						"name": "CREATED",
						"type": "UTF8"
					},
					{
						"name": "CREATEDBY",
						"type": "UTF8"
					},
					{
						"name": "UPDATED",
						"type": "UTF8"
					},
					{
						"name": "UPDATEDBY",
						"type": "UTF8"
					},
					{
						"name": "IPADDRESS",
						"type": "UTF8"
					},
					{
						"name": "MACADDRESS",
						"type": "UTF8"
					},
					{
						"name": "TSTAMP",
						"type": "UTF8"
					},
					{
						"name": "COMPANYID",
						"type": "UTF8"
					},
					{
						"name": "STATUSDATE",
						"type": "UTF8"
					},
					{
						"name": "LASTNAMELENGTH",
						"type": "UTF8"
					},
					{
						"name": "EMAIL2",
						"type": "UTF8"
					},
					{
						"name": "CONTACTNAME2",
						"type": "UTF8"
					},
					{
						"name": "CONTACTPHONE2",
						"type": "UTF8"
					},
					{
						"name": "ISBLACKLISTED",
						"type": "UTF8"
					},
					{
						"name": "BLACKLISTREASON",
						"type": "UTF8"
					},
					{
						"name": "BLACKLISTEDDATE",
						"type": "UTF8"
					},
					{
						"name": "ISFOREIGNER",
						"type": "UTF8"
					},
					{
						"name": "CONTACTID",
						"type": "UTF8"
					},
					{
						"name": "MILITARYSERVED",
						"type": "UTF8"
					},
					{
						"name": "TRAININGSPORT",
						"type": "UTF8"
					},
					{
						"name": "INTEREST",
						"type": "UTF8"
					},
					{
						"name": "APPID",
						"type": "UTF8"
					},
					{
						"name": "MILITARYNO",
						"type": "UTF8"
					},
					{
						"name": "RELATIVEID",
						"type": "UTF8"
					},
					{
						"name": "RELATIVEID2",
						"type": "UTF8"
					},
					{
						"name": "MILITARYCLOSETYPE",
						"type": "UTF8"
					},
					{
						"name": "MILITARYCOMMENT",
						"type": "UTF8"
					},
					{
						"name": "LINKEDIN",
						"type": "UTF8"
					},
					{
						"name": "FACEBOOK",
						"type": "UTF8"
					},
					{
						"name": "TWITTER",
						"type": "UTF8"
					},
					{
						"name": "ISSPYOATH",
						"type": "UTF8"
					},
					{
						"name": "SPYOATHDATE",
						"type": "UTF8"
					},
					{
						"name": "ISGOVERNMENTOATH",
						"type": "UTF8"
					},
					{
						"name": "GOVERNMENTOATHDATE",
						"type": "UTF8"
					},
					{
						"name": "ISMILITARYOATH",
						"type": "UTF8"
					},
					{
						"name": "MILITARYOATHDATE",
						"type": "UTF8"
					},
					{
						"name": "LINKID",
						"type": "UTF8"
					},
					{
						"name": "ISRESIDENT",
						"type": "UTF8"
					},
					{
						"name": "CIVILID",
						"type": "UTF8"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureDataLakeStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ADLS_Staging_GreenERP')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureDataLakeStorage1",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"cw_fileName": {
						"type": "String"
					},
					"cw_folderPath": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@dataset().cw_fileName",
							"type": "Expression"
						},
						"folderPath": {
							"value": "@dataset().cw_folderPath",
							"type": "Expression"
						},
						"fileSystem": "hr-staging"
					},
					"compressionCodec": "snappy"
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureDataLakeStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ADLS_Staging_SIGRADE')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureDataLakeStorage1",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"cwfolder": {
						"type": "String",
						"defaultValue": "SIGRADE"
					}
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": {
							"value": "@dataset().cwfolder",
							"type": "Expression"
						},
						"fileSystem": "hr-staging"
					},
					"compressionCodec": "snappy"
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureDataLakeStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ADLS_Staging_SILEVEL')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureDataLakeStorage1",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"cwfolder": {
						"type": "String",
						"defaultValue": "SILEVEL"
					}
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": {
							"value": "@dataset().cwfolder",
							"type": "Expression"
						},
						"fileSystem": "hr-staging"
					},
					"compressionCodec": "snappy"
				},
				"schema": [
					{
						"name": "LEVELID",
						"type": "INT_16"
					},
					{
						"name": "CODE",
						"type": "UTF8"
					},
					{
						"name": "NAME",
						"type": "UTF8"
					},
					{
						"name": "ISACTIVE",
						"type": "BOOLEAN"
					},
					{
						"name": "CREATED",
						"type": "UTF8"
					},
					{
						"name": "UPDATED",
						"type": "UTF8"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureDataLakeStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ADLS_Staging_TBLCOMPANY')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureDataLakeStorage1",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"cwfolder": {
						"type": "String",
						"defaultValue": "TBLCOMPANY"
					}
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": {
							"value": "@dataset().cwfolder",
							"type": "Expression"
						},
						"fileSystem": "hr-staging"
					},
					"compressionCodec": "snappy"
				},
				"schema": [
					{
						"name": "COMPANYID",
						"type": "UTF8"
					},
					{
						"name": "NAME",
						"type": "UTF8"
					},
					{
						"name": "CREATED",
						"type": "UTF8"
					},
					{
						"name": "UPDATED",
						"type": "UTF8"
					},
					{
						"name": "PARENTID",
						"type": "UTF8"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureDataLakeStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ADLS_Staging_TBLDEPARTMENT')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureDataLakeStorage1",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"cwfolder": {
						"type": "String",
						"defaultValue": "TBLDEPARTMENT"
					}
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": {
							"value": "@dataset().cwfolder",
							"type": "Expression"
						},
						"fileSystem": "hr-staging"
					},
					"compressionCodec": "snappy"
				},
				"schema": [
					{
						"name": "DEPID",
						"type": "INT_16"
					},
					{
						"name": "DEPCODE",
						"type": "UTF8"
					},
					{
						"name": "NAME",
						"type": "UTF8"
					},
					{
						"name": "ISACTIVE",
						"type": "BOOLEAN"
					},
					{
						"name": "PARENTID",
						"type": "UTF8"
					},
					{
						"name": "CREATED",
						"type": "UTF8"
					},
					{
						"name": "UPDATED",
						"type": "UTF8"
					},
					{
						"name": "COMPANYID",
						"type": "UTF8"
					},
					{
						"name": "DEPTYPEID",
						"type": "INT_16"
					},
					{
						"name": "PATH",
						"type": "UTF8"
					},
					{
						"name": "PARENTPATH",
						"type": "UTF8"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureDataLakeStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ADLS_Staging_TBLEMPEMPLHIST')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureDataLakeStorage1",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"cwfolder": {
						"type": "String",
						"defaultValue": "TBLEMPEMPLHIST"
					}
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": {
							"value": "@dataset().cwfolder",
							"type": "Expression"
						},
						"fileSystem": "hr-staging"
					},
					"compressionCodec": "snappy"
				},
				"schema": [
					{
						"name": "COMPANYID",
						"type": "UTF8"
					},
					{
						"name": "NAME",
						"type": "UTF8"
					},
					{
						"name": "CREATED",
						"type": "UTF8"
					},
					{
						"name": "UPDATED",
						"type": "UTF8"
					},
					{
						"name": "PARENTID",
						"type": "UTF8"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureDataLakeStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ADLS_Staging_TBLPOSITION')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureDataLakeStorage1",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"cwfolder": {
						"type": "String"
					}
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": {
							"value": "@dataset().cwfolder",
							"type": "Expression"
						},
						"fileSystem": "hr-staging"
					},
					"compressionCodec": "snappy"
				},
				"schema": [
					{
						"name": "POSITIONID",
						"type": "INT_16"
					},
					{
						"name": "COMPANYID",
						"type": "UTF8"
					},
					{
						"name": "DEPID",
						"type": "INT_16"
					},
					{
						"name": "POSGROUPID",
						"type": "INT_16"
					},
					{
						"name": "CODE",
						"type": "UTF8"
					},
					{
						"name": "NAME",
						"type": "UTF8"
					},
					{
						"name": "EMPLOYMENTTYPEID",
						"type": "INT_16"
					},
					{
						"name": "GRADEID",
						"type": "INT_16"
					},
					{
						"name": "VACANCYDAYS",
						"type": "INT_16"
					},
					{
						"name": "LABOURCONDITION",
						"type": "UTF8"
					},
					{
						"name": "ISACTIVE",
						"type": "BOOLEAN"
					},
					{
						"name": "CREATED",
						"type": "UTF8"
					},
					{
						"name": "UPDATED",
						"type": "UTF8"
					},
					{
						"name": "JOBDESCID",
						"type": "INT_16"
					},
					{
						"name": "JOBID",
						"type": "INT_16"
					},
					{
						"name": "TYPE",
						"type": "UTF8"
					},
					{
						"name": "POSITIONOCCID",
						"type": "INT_16"
					},
					{
						"name": "POSLEVEL",
						"type": "INT_16"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureDataLakeStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ADLS_Staging_copy1')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureDataLakeStorage1",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"cwfolder": {
						"type": "String",
						"defaultValue": "TBLCOMPANY"
					}
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": {
							"value": "@dataset().cwfolder",
							"type": "Expression"
						},
						"fileSystem": "hr-staging"
					},
					"compressionCodec": "snappy"
				},
				"schema": [
					{
						"name": "COMPANYID",
						"type": "UTF8"
					},
					{
						"name": "NAME",
						"type": "UTF8"
					},
					{
						"name": "CREATED",
						"type": "UTF8"
					},
					{
						"name": "UPDATED",
						"type": "UTF8"
					},
					{
						"name": "PARENTID",
						"type": "UTF8"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureDataLakeStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AzureMySqlTable1_Employee')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Azure_DWH_HR_link",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"cwtablename": {
						"type": "String",
						"defaultValue": "dim_employee"
					}
				},
				"annotations": [],
				"type": "AzureMySqlTable",
				"schema": [
					{
						"name": "employee_key",
						"type": "bigint",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "source_system_code",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "source_employee_id",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "company_id",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "employee_code",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "registration_number",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "family_name",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "last_name",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "first_name",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "gender",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "birth_date",
						"type": "date",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "nationality_id",
						"type": "int",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "employment_status",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "effective_start_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "effective_end_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "is_current_record",
						"type": "tinyint",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "source_created_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "source_updated_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "dw_created_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "dw_updated_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "etl_batch_id",
						"type": "bigint",
						"precision": 0,
						"scale": 0
					}
				],
				"typeProperties": {
					"tableName": {
						"value": "@dataset().cwtablename",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/Azure_DWH_HR_link')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AzureMySqlTable1_POSITION')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Azure_DWH_HR_link",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"cwtablename": {
						"type": "String",
						"defaultValue": "dim_position"
					}
				},
				"annotations": [],
				"type": "AzureMySqlTable",
				"schema": [
					{
						"name": "position_key",
						"type": "int",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "source_system_code",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "source_position_id",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "company_key",
						"type": "int",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "position_code",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "position_name",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "position_category",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "position_level",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "is_management",
						"type": "int",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "is_active",
						"type": "int",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "effective_start_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "effective_end_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "is_current_record",
						"type": "int",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "dw_created_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "dw_updated_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					}
				],
				"typeProperties": {
					"tableName": {
						"value": "@dataset().cwtablename",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/Azure_DWH_HR_link')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AzureMySqlTable_COMPANY')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Azure_DWH_HR_link",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"cwtablename": {
						"type": "String",
						"defaultValue": "dim_company"
					}
				},
				"annotations": [],
				"type": "AzureMySqlTable",
				"schema": [
					{
						"name": "company_key",
						"type": "int",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "company_code",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "company_name",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "is_active",
						"type": "bit",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "source_system_code",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "source_created_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "source_updated_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "dw_created_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "dw_updated_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					}
				],
				"typeProperties": {
					"tableName": {
						"value": "@dataset().cwtablename",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/Azure_DWH_HR_link')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AzureMySqlTable_Department')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Azure_DWH_HR_link",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"cwtablename": {
						"type": "String",
						"defaultValue": "dim_department"
					}
				},
				"annotations": [],
				"type": "AzureMySqlTable",
				"schema": [
					{
						"name": "department_key",
						"type": "int",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "source_system_code",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "source_department_id",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "company_key",
						"type": "int",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "department_code",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "department_name",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "parent_department_key",
						"type": "int",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "department_level",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "is_active",
						"type": "tinyint",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "effective_start_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "effective_end_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "is_current_record",
						"type": "tinyint",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "dw_created_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "dw_updated_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					}
				],
				"typeProperties": {
					"tableName": {
						"value": "@dataset().cwtablename",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/Azure_DWH_HR_link')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AzureMySqlTable_EMPLOYEE')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Azure_DWH_HR_link",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"cwtablename": {
						"type": "String",
						"defaultValue": "dim_employee"
					}
				},
				"annotations": [],
				"type": "AzureMySqlTable",
				"schema": [
					{
						"name": "employee_key",
						"type": "bigint",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "source_system_code",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "source_employee_id",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "company_id",
						"type": "int",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "employee_code",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "registration_number",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "family_name",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "last_name",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "first_name",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "gender",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "birth_date",
						"type": "date",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "nationality_id",
						"type": "int",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "employment_status",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "effective_start_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "effective_end_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "is_current_record",
						"type": "tinyint",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "source_created_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "source_updated_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "dw_created_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "dw_updated_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "etl_batch_id",
						"type": "bigint",
						"precision": 0,
						"scale": 0
					}
				],
				"typeProperties": {
					"tableName": {
						"value": "@dataset().cwtablename",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/Azure_DWH_HR_link')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AzureMySqlTable_Fact_employee_hist')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Azure_DWH_HR_link",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"cwtablename": {
						"type": "String",
						"defaultValue": "fact_employee_history"
					}
				},
				"annotations": [],
				"type": "AzureMySqlTable",
				"schema": [
					{
						"name": "history_fact_key",
						"type": "bigint",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "employee_key",
						"type": "bigint",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "company_key",
						"type": "int",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "department_key",
						"type": "int",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "position_key",
						"type": "int",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "grade_key",
						"type": "int",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "level_key",
						"type": "int",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "begin_date",
						"type": "date",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "end_date",
						"type": "date",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "source_system_code",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "source_history_id",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "source_employee_id",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "source_order_id",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "order_type",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "order_number",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "level_number",
						"type": "int",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "base_wage",
						"type": "decimal",
						"precision": 18,
						"scale": 2
					},
					{
						"name": "base_wage_currency",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "insurance_type_id",
						"type": "int",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "labour_condition",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "is_current_position",
						"type": "tinyint",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "is_active_employment",
						"type": "tinyint",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "source_created_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "source_updated_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "dw_created_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "dw_updated_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "etl_batch_id",
						"type": "bigint",
						"precision": 0,
						"scale": 0
					}
				],
				"typeProperties": {
					"tableName": {
						"value": "@dataset().cwtablename",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/Azure_DWH_HR_link')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AzureMySqlTable_Grade')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Azure_DWH_HR_link",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"cwtablename": {
						"type": "String",
						"defaultValue": "dim_grade"
					}
				},
				"annotations": [],
				"type": "AzureMySqlTable",
				"schema": [
					{
						"name": "grade_key",
						"type": "int",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "grade_id",
						"type": "int",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "code",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "grade_no",
						"type": "int",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "name",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "source_system_code",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "source_created_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "source_updated_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "dw_created_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "dw_updated_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					}
				],
				"typeProperties": {
					"tableName": {
						"value": "@dataset().cwtablename",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/Azure_DWH_HR_link')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AzureMySqlTable_SIGRADE')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Azure_DWH_HR_link",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"cwtablename": {
						"type": "String",
						"defaultValue": "dim_grade"
					}
				},
				"annotations": [],
				"type": "AzureMySqlTable",
				"schema": [
					{
						"name": "company_key",
						"type": "int",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "company_code",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "company_name",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "is_active",
						"type": "bit",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "source_system_code",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "source_created_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "source_updated_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "dw_created_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "dw_updated_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					}
				],
				"typeProperties": {
					"tableName": {
						"value": "@dataset().cwtablename",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/Azure_DWH_HR_link')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AzureMySqlTable_SILEVEL')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Azure_DWH_HR_link",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"cwtablename": {
						"type": "String",
						"defaultValue": "dim_level"
					}
				},
				"annotations": [],
				"type": "AzureMySqlTable",
				"schema": [
					{
						"name": "level_key",
						"type": "int",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "level_id",
						"type": "int",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "code",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "name",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "source_system_code",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "source_created_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "source_updated_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "dw_created_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "dw_updated_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					}
				],
				"typeProperties": {
					"tableName": {
						"value": "@dataset().cwtablename",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/Azure_DWH_HR_link')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Azure_DWH_HR')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Azure_DWH_HR_link",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureMySqlTable",
				"schema": [
					{
						"name": "employee_key",
						"type": "bigint",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "source_system_code",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "source_employee_id",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "company_id",
						"type": "int",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "employee_code",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "registration_number",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "family_name",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "last_name",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "first_name",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "gender",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "birth_date",
						"type": "date",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "nationality_id",
						"type": "int",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "employment_status",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "effective_start_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "effective_end_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "is_current_record",
						"type": "tinyint",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "source_created_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "source_updated_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "source_created_by",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "source_updated_by",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "dw_created_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "dw_updated_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "etl_batch_id",
						"type": "bigint",
						"precision": 0,
						"scale": 0
					}
				],
				"typeProperties": {
					"tableName": "dim_employee"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/Azure_DWH_HR_link')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Azure_DWH_HR_copy1')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Azure_DWH_HR_link",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureMySqlTable",
				"schema": [
					{
						"name": "employee_key",
						"type": "bigint",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "source_system_code",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "source_employee_id",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "company_id",
						"type": "int",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "employee_code",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "registration_number",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "family_name",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "last_name",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "first_name",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "gender",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "birth_date",
						"type": "date",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "nationality_id",
						"type": "int",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "employment_status",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "effective_start_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "effective_end_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "is_current_record",
						"type": "tinyint",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "source_created_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "source_updated_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "source_created_by",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "source_updated_by",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "dw_created_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "dw_updated_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "etl_batch_id",
						"type": "bigint",
						"precision": 0,
						"scale": 0
					}
				],
				"typeProperties": {
					"tableName": "fact_employee_history"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/Azure_DWH_HR_link')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DWH_Mysql')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Azure_MySql_DWH",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"cw_table": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "AzureMySqlTable",
				"schema": [],
				"typeProperties": {
					"tableName": {
						"value": "@dataset().cw_table",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/Azure_MySql_DWH')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DataService_TestMerchant')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Merchant_DataService_DB",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"cw_table": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "AzureMySqlTable",
				"schema": [],
				"typeProperties": {
					"tableName": {
						"value": "@dataset().cw_table",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/Merchant_DataService_DB')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Dataset_Sink')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureSqlDatabase1",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"tableName": {
						"type": "string"
					},
					"schema": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": {
						"value": "@dataset().schema",
						"type": "Expression"
					},
					"table": {
						"value": "@dataset().tableName",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureSqlDatabase1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Dataset_Source')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureSqlDatabase1",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"tableName": {
						"type": "string"
					},
					"schema": {
						"type": "String"
					}
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "COMPANYID",
						"type": "nvarchar"
					},
					{
						"name": "NAME",
						"type": "nvarchar"
					},
					{
						"name": "ADDRESS",
						"type": "nvarchar"
					},
					{
						"name": "CREATED",
						"type": "nvarchar"
					},
					{
						"name": "CREATEDBY",
						"type": "nvarchar"
					},
					{
						"name": "UPDATED",
						"type": "nvarchar"
					},
					{
						"name": "UPDATEDBY",
						"type": "nvarchar"
					},
					{
						"name": "IPADDRESS",
						"type": "nvarchar"
					},
					{
						"name": "MACADDRESS",
						"type": "nvarchar"
					},
					{
						"name": "TSTAMP",
						"type": "datetime2",
						"scale": 6
					},
					{
						"name": "BUSINESSTYPEID",
						"type": "bigint",
						"precision": 19
					},
					{
						"name": "PARENTID",
						"type": "nvarchar"
					},
					{
						"name": "REPGROUPID",
						"type": "nvarchar"
					},
					{
						"name": "PHONE",
						"type": "nvarchar"
					},
					{
						"name": "FAX",
						"type": "nvarchar"
					},
					{
						"name": "INTCOMPANYID",
						"type": "bigint",
						"precision": 19
					},
					{
						"name": "JDECOMPANY",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": {
						"value": "@dataset().schema",
						"type": "Expression"
					},
					"table": {
						"value": "@dataset().tableName",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureSqlDatabase1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DelimitedText1')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureDataLakeStorage1",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "test",
						"fileSystem": "error"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureDataLakeStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DestinationDataset_xii')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureSqlDatabase1",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"cw_table": {
						"type": "String"
					}
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "HRMS_PROD",
					"table": {
						"value": "@dataset().cw_table",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureSqlDatabase1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Dwh_Sql')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureSqlDw",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"cw_table": {
						"type": "string"
					},
					"cw_schema": {
						"type": "String"
					}
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": {
						"value": "@dataset().cw_schema",
						"type": "Expression"
					},
					"table": {
						"value": "@dataset().cw_table",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureSqlDw')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Employee')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureDataLakeStorage1",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"cwfolder": {
						"type": "string",
						"defaultValue": "GreenErp"
					},
					"cwfilename": {
						"type": "string",
						"defaultValue": "HREMPLOYEE.csv"
					}
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@dataset().cwfilename",
							"type": "Expression"
						},
						"folderPath": {
							"value": "@dataset().cwfolder",
							"type": "Expression"
						},
						"fileSystem": "hr-raw"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": [
					{
						"name": "EMPID",
						"type": "String"
					},
					{
						"name": "CODE",
						"type": "String"
					},
					{
						"name": "FAMILYNAME",
						"type": "String"
					},
					{
						"name": "LASTNAME",
						"type": "String"
					},
					{
						"name": "FIRSTNAME",
						"type": "String"
					},
					{
						"name": "GENDER",
						"type": "String"
					},
					{
						"name": "BIRTHDATE",
						"type": "String"
					},
					{
						"name": "BIRTHCOUNTRYID",
						"type": "String"
					},
					{
						"name": "BIRTHDIVISIONID",
						"type": "String"
					},
					{
						"name": "BIRTHDISTRICTID",
						"type": "String"
					},
					{
						"name": "BIRTHPLACE",
						"type": "String"
					},
					{
						"name": "COUNTRYID",
						"type": "String"
					},
					{
						"name": "DIVISIONID",
						"type": "String"
					},
					{
						"name": "DISTRICTID",
						"type": "String"
					},
					{
						"name": "NATIONALITYID",
						"type": "String"
					},
					{
						"name": "SOCIALORIGINID",
						"type": "String"
					},
					{
						"name": "MARITALSTATUS",
						"type": "String"
					},
					{
						"name": "BLOODGROUP",
						"type": "String"
					},
					{
						"name": "REGNO",
						"type": "String"
					},
					{
						"name": "PASSNO",
						"type": "String"
					},
					{
						"name": "FORPASSNO",
						"type": "String"
					},
					{
						"name": "EMDNO",
						"type": "String"
					},
					{
						"name": "NDDNO",
						"type": "String"
					},
					{
						"name": "ADDR1",
						"type": "String"
					},
					{
						"name": "ADDR2",
						"type": "String"
					},
					{
						"name": "HOMEPHONE",
						"type": "String"
					},
					{
						"name": "MOBILEPHONE",
						"type": "String"
					},
					{
						"name": "WORKPHONE",
						"type": "String"
					},
					{
						"name": "WORKPHONEEXT",
						"type": "String"
					},
					{
						"name": "FAX",
						"type": "String"
					},
					{
						"name": "EMAIL",
						"type": "String"
					},
					{
						"name": "POSTADDRESS",
						"type": "String"
					},
					{
						"name": "CONTACTNAME",
						"type": "String"
					},
					{
						"name": "CONTACTPHONE",
						"type": "String"
					},
					{
						"name": "WITHPICTURE",
						"type": "String"
					},
					{
						"name": "STATUS",
						"type": "String"
					},
					{
						"name": "CREATED",
						"type": "String"
					},
					{
						"name": "CREATEDBY",
						"type": "String"
					},
					{
						"name": "UPDATED",
						"type": "String"
					},
					{
						"name": "UPDATEDBY",
						"type": "String"
					},
					{
						"name": "IPADDRESS",
						"type": "String"
					},
					{
						"name": "MACADDRESS",
						"type": "String"
					},
					{
						"name": "TSTAMP",
						"type": "String"
					},
					{
						"name": "COMPANYID",
						"type": "String"
					},
					{
						"name": "STATUSDATE",
						"type": "String"
					},
					{
						"name": "LASTNAMELENGTH",
						"type": "String"
					},
					{
						"name": "EMAIL2",
						"type": "String"
					},
					{
						"name": "CONTACTNAME2",
						"type": "String"
					},
					{
						"name": "CONTACTPHONE2",
						"type": "String"
					},
					{
						"name": "ISBLACKLISTED",
						"type": "String"
					},
					{
						"name": "BLACKLISTREASON",
						"type": "String"
					},
					{
						"name": "BLACKLISTEDDATE",
						"type": "String"
					},
					{
						"name": "ISFOREIGNER",
						"type": "String"
					},
					{
						"name": "CONTACTID",
						"type": "String"
					},
					{
						"name": "MILITARYSERVED",
						"type": "String"
					},
					{
						"name": "TRAININGSPORT",
						"type": "String"
					},
					{
						"name": "INTEREST",
						"type": "String"
					},
					{
						"name": "APPID",
						"type": "String"
					},
					{
						"name": "MILITARYNO",
						"type": "String"
					},
					{
						"name": "RELATIVEID",
						"type": "String"
					},
					{
						"name": "RELATIVEID2",
						"type": "String"
					},
					{
						"name": "MILITARYCLOSETYPE",
						"type": "String"
					},
					{
						"name": "MILITARYCOMMENT",
						"type": "String"
					},
					{
						"name": "LINKEDIN",
						"type": "String"
					},
					{
						"name": "FACEBOOK",
						"type": "String"
					},
					{
						"name": "TWITTER",
						"type": "String"
					},
					{
						"name": "ISSPYOATH",
						"type": "String"
					},
					{
						"name": "SPYOATHDATE",
						"type": "String"
					},
					{
						"name": "ISGOVERNMENTOATH",
						"type": "String"
					},
					{
						"name": "GOVERNMENTOATHDATE",
						"type": "String"
					},
					{
						"name": "ISMILITARYOATH",
						"type": "String"
					},
					{
						"name": "MILITARYOATHDATE",
						"type": "String"
					},
					{
						"name": "LINKID",
						"type": "String"
					},
					{
						"name": "ISRESIDENT",
						"type": "String"
					},
					{
						"name": "CIVILID",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureDataLakeStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Evs_csv')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "linkedService_err",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": "evs.csv",
						"container": "evs"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/linkedService_err')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Evs_employee')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureMySql_allEmployee",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureMySqlTable",
				"schema": [
					{
						"name": "id",
						"type": "int",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "fn",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "rn",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "ln",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "oid",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "po",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "gname",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "empid",
						"type": "int",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "im",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "source",
						"type": "varchar",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "created_at",
						"type": "timestamp",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "updated_at",
						"type": "timestamp",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "status_date",
						"type": "datetime",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "status",
						"type": "int",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "gname_number",
						"type": "int",
						"precision": 0,
						"scale": 0
					},
					{
						"name": "is_foreigner",
						"type": "int",
						"precision": 0,
						"scale": 0
					}
				],
				"typeProperties": {
					"tableName": "employee_profile"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureMySql_allEmployee')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/FMCG_SQLServer_AG_Order')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "MCS_FMCG_DWH_SqlServerConn",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "SqlServerTable",
				"schema": [],
				"typeProperties": {
					"schema": "dbo",
					"table": "BigOneFull"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/MCS_FMCG_DWH_SqlServerConn')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/FMCG_SQLServer_MainDB')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "MCS_FMCG_DWH_MainDB",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"cw_table": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "SqlServerTable",
				"schema": [],
				"typeProperties": {
					"schema": "dbo",
					"table": {
						"value": "@dataset().cw_table",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/MCS_FMCG_DWH_MainDB')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/FMCG_SQLServer_QVReports')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "MCS_FMCG_DWH_SqlServerConn",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"cw_table": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "SqlServerTable",
				"schema": [],
				"typeProperties": {
					"schema": "dbo",
					"table": {
						"value": "@dataset().cw_table",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/MCS_FMCG_DWH_SqlServerConn')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/HR_GreenERP_DS')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "MCS_HR_GreenERP_SC",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"tableName": {
						"type": "string",
						"defaultValue": "HREMPLOYEE"
					}
				},
				"annotations": [],
				"type": "OracleTable",
				"schema": [],
				"typeProperties": {
					"schema": "HRMS_PROD",
					"table": {
						"value": "@dataset().tableName",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/MCS_HR_GreenERP_SC')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/SourceDataset_xii')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "MCS_HR_GreenERP_SC",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"cw_table": {
						"type": "String"
					}
				},
				"annotations": [],
				"type": "OracleTable",
				"schema": [],
				"typeProperties": {
					"schema": "HRMS_PROD",
					"table": {
						"value": "@dataset().cw_table",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/MCS_HR_GreenERP_SC')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/SourceDataset_xy6')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "MCS_HR_GreenERP_SC",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "OracleTable",
				"schema": [],
				"typeProperties": {
					"table": "newQuery0"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/MCS_HR_GreenERP_SC')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/TBLEMPEMPLHIST_csv')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureDataLakeStorage1",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"cwfolder": {
						"type": "string",
						"defaultValue": "GreenErp"
					},
					"cwfilename": {
						"type": "string",
						"defaultValue": "TBLPOSITION.csv"
					}
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@dataset().cwfilename",
							"type": "Expression"
						},
						"folderPath": {
							"value": "@dataset().cwfolder",
							"type": "Expression"
						},
						"fileSystem": "hr-raw"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureDataLakeStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/csv_SIGRADE')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureDataLakeStorage1",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"cwfolder": {
						"type": "string",
						"defaultValue": "GreenErp"
					},
					"cwfilename": {
						"type": "string",
						"defaultValue": "SIGRADE.csv"
					}
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@dataset().cwfilename",
							"type": "Expression"
						},
						"folderPath": {
							"value": "@dataset().cwfolder",
							"type": "Expression"
						},
						"fileSystem": "hr-raw"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureDataLakeStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/csv_SILEVEL')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureDataLakeStorage1",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"cwfolder": {
						"type": "string",
						"defaultValue": "GreenErp"
					},
					"cwfilename": {
						"type": "string",
						"defaultValue": "SILEVEL.csv"
					}
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@dataset().cwfilename",
							"type": "Expression"
						},
						"folderPath": {
							"value": "@dataset().cwfolder",
							"type": "Expression"
						},
						"fileSystem": "hr-raw"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureDataLakeStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ADLS_FMCS_RAW')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureBlobFS",
				"typeProperties": {
					"url": "[parameters('ADLS_FMCS_RAW_properties_typeProperties_url')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/AzureDataLakeStorage1')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureBlobFS",
				"typeProperties": {
					"url": "[parameters('AzureDataLakeStorage1_properties_typeProperties_url')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/AzureMySql1')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureMySql",
				"typeProperties": {
					"connectionString": "[parameters('AzureMySql1_connectionString')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/AzureMySql_allEmployee')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureMySql",
				"typeProperties": {
					"connectionString": "[parameters('AzureMySql_allEmployee_connectionString')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/AzureSqlDatabase1')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureSqlDatabase",
				"typeProperties": {
					"server": "[parameters('AzureSqlDatabase1_properties_typeProperties_server')]",
					"database": "[parameters('AzureSqlDatabase1_properties_typeProperties_database')]",
					"encrypt": "optional",
					"trustServerCertificate": false,
					"authenticationType": "SystemAssignedManagedIdentity"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/AzureSqlDw')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureSqlDatabase",
				"typeProperties": {
					"server": "[parameters('AzureSqlDw_properties_typeProperties_server')]",
					"database": "[parameters('AzureSqlDw_properties_typeProperties_database')]",
					"encrypt": "mandatory",
					"trustServerCertificate": false,
					"authenticationType": "SystemAssignedManagedIdentity"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Azure_DWH_Dynamic')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"parameters": {
					"database": {
						"type": "String",
						"defaultValue": "hr"
					}
				},
				"annotations": [],
				"type": "MySql",
				"typeProperties": {
					"server": "[parameters('Azure_DWH_Dynamic_properties_typeProperties_server')]",
					"port": 3306,
					"database": "[parameters('Azure_DWH_Dynamic_properties_typeProperties_database')]",
					"username": "[parameters('Azure_DWH_Dynamic_properties_typeProperties_username')]",
					"sslMode": 1,
					"useSystemTrustStore": 0,
					"password": {
						"type": "SecureString",
						"value": "[parameters('Azure_DWH_Dynamic_password')]"
					},
					"driverVersion": "v2"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Azure_DWH_HR_link')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureMySql",
				"typeProperties": {
					"connectionString": "[parameters('Azure_DWH_HR_link_connectionString')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Azure_DWH_Hr')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureMySql",
				"typeProperties": {
					"connectionString": "[parameters('Azure_DWH_Hr_connectionString')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Azure_MySql_DWH')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureMySql",
				"typeProperties": {
					"connectionString": "[parameters('Azure_MySql_DWH_connectionString')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/GitHubMcsDWH')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "GitHub",
				"typeProperties": {
					"username": "[parameters('GitHubMcsDWH_properties_typeProperties_username')]",
					"credential": {
						"type": "SecureString",
						"value": "[parameters('GitHubMcsDWH_credential')]"
					},
					"encryptedCredential": "ew0KICAiVmVyc2lvbiI6ICIyMDE3LTExLTMwIiwNCiAgIlByb3RlY3Rpb25Nb2RlIjogIktleSIsDQogICJTZWNyZXRDb250ZW50VHlwZSI6ICJQbGFpbnRleHQiLA0KICAiQ3JlZGVudGlhbElkIjogIkRBVEFGQUNUT1JZQDVDMTQ1NDlFLTMzQUItNERGRS1COEIwLUI2NDg0Qzc1QjAxNF85ZmUyYmIzMS1kOWJhLTRlZmMtYTg2My1jNDhhYzljOTgxZmIiDQp9"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/MCS_FMCG_DWH_MainDB')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "SqlServer",
				"typeProperties": {
					"server": "[parameters('MCS_FMCG_DWH_MainDB_properties_typeProperties_server')]",
					"database": "[parameters('MCS_FMCG_DWH_MainDB_properties_typeProperties_database')]",
					"encrypt": "optional",
					"trustServerCertificate": false,
					"authenticationType": "SQL",
					"userName": "[parameters('MCS_FMCG_DWH_MainDB_properties_typeProperties_userName')]",
					"password": {
						"type": "SecureString",
						"value": "[parameters('MCS_FMCG_DWH_MainDB_password')]"
					}
				},
				"connectVia": {
					"referenceName": "mcscc-vpnserver",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/integrationRuntimes/mcscc-vpnserver')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/MCS_FMCG_DWH_SqlServerConn')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "SqlServer",
				"typeProperties": {
					"server": "[parameters('MCS_FMCG_DWH_SqlServerConn_properties_typeProperties_server')]",
					"database": "[parameters('MCS_FMCG_DWH_SqlServerConn_properties_typeProperties_database')]",
					"encrypt": "optional",
					"trustServerCertificate": false,
					"authenticationType": "SQL",
					"userName": "[parameters('MCS_FMCG_DWH_SqlServerConn_properties_typeProperties_userName')]",
					"password": {
						"type": "SecureString",
						"value": "[parameters('MCS_FMCG_DWH_SqlServerConn_password')]"
					}
				},
				"connectVia": {
					"referenceName": "mcscc-vpnserver",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/integrationRuntimes/mcscc-vpnserver')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/MCS_HR_GreenERP_SC')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "MCS_HR_GreenERP_SC\n",
				"annotations": [],
				"type": "Oracle",
				"version": "2.0",
				"typeProperties": {
					"server": "[parameters('MCS_HR_GreenERP_SC_properties_typeProperties_server')]",
					"authenticationType": "Basic",
					"username": "[parameters('MCS_HR_GreenERP_SC_properties_typeProperties_username')]",
					"password": {
						"type": "SecureString",
						"value": "[parameters('MCS_HR_GreenERP_SC_password')]"
					},
					"encryptionClient": "accepted",
					"encryptionTypesClient": "(AES128, AES192, AES256, 3DES112, 3DES168)",
					"cryptoChecksumClient": "accepted",
					"cryptoChecksumTypesClient": "(SHA1, SHA256, SHA384, SHA512)"
				},
				"connectVia": {
					"referenceName": "mcscc-vpnserver",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/integrationRuntimes/mcscc-vpnserver')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/MCS_HR_GreenERP_Source')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "SqlServer",
				"typeProperties": {
					"server": "[parameters('MCS_HR_GreenERP_Source_properties_typeProperties_server')]",
					"database": "[parameters('MCS_HR_GreenERP_Source_properties_typeProperties_database')]",
					"encrypt": "optional",
					"trustServerCertificate": false,
					"authenticationType": "SQL",
					"userName": "[parameters('MCS_HR_GreenERP_Source_properties_typeProperties_userName')]",
					"password": {
						"type": "SecureString",
						"value": "[parameters('MCS_HR_GreenERP_Source_password')]"
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Merchant_DataService_DB')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Merchant Data Service Database",
				"annotations": [],
				"type": "AzureMySql",
				"typeProperties": {
					"connectionString": "[parameters('Merchant_DataService_DB_connectionString')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Oracle1')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "Oracle",
				"version": "2.0",
				"typeProperties": {
					"server": "[parameters('Oracle1_properties_typeProperties_server')]",
					"authenticationType": "Basic",
					"username": "[parameters('Oracle1_properties_typeProperties_username')]",
					"password": {
						"type": "SecureString",
						"value": "[parameters('Oracle1_password')]"
					},
					"encryptionClient": "accepted",
					"encryptionTypesClient": "(AES128, AES192, AES256, 3DES112, 3DES168)",
					"cryptoChecksumClient": "accepted",
					"cryptoChecksumTypesClient": "(SHA1, SHA256, SHA384, SHA512)"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/linkedService1')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureBlobFS",
				"typeProperties": {
					"url": "[parameters('linkedService1_properties_typeProperties_url')]",
					"accountKey": {
						"type": "SecureString",
						"value": "[parameters('linkedService1_accountKey')]"
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/linkedService_err')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureBlobStorage",
				"typeProperties": {
					"serviceEndpoint": "[parameters('linkedService_err_properties_typeProperties_serviceEndpoint')]",
					"accountKind": "StorageV2"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/5min Trigger')]",
			"type": "Microsoft.DataFactory/factories/triggers",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"runtimeState": "Stopped",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "AG_Order_1d_Ago_Extract_CSV",
							"type": "PipelineReference"
						},
						"parameters": {
							"windowStart": "[parameters('5min Trigger_properties_AG_Order_1d_Ago_Extract_CSV_parameters_windowStart')]",
							"windowEnd": "[parameters('5min Trigger_properties_AG_Order_1d_Ago_Extract_CSV_parameters_windowEnd')]"
						}
					}
				],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Minute",
						"interval": 5,
						"startTime": "2025-01-14T12:03:00",
						"timeZone": "Ulaanbaatar Standard Time"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/pipelines/AG_Order_1d_Ago_Extract_CSV')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Daily Morning')]",
			"type": "Microsoft.DataFactory/factories/triggers",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"runtimeState": "Started",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "AG_Small_Tables_Full_Extract",
							"type": "PipelineReference"
						},
						"parameters": {}
					},
					{
						"pipelineReference": {
							"referenceName": "AG_MainDB_to_Raw",
							"type": "PipelineReference"
						},
						"parameters": {
							"main_directory": "[parameters('Daily Morning_properties_AG_MainDB_to_Raw_parameters_main_directory')]"
						}
					},
					{
						"pipelineReference": {
							"referenceName": "AG_Customer_Full_Flow",
							"type": "PipelineReference"
						},
						"parameters": {}
					},
					{
						"pipelineReference": {
							"referenceName": "AG_Order_1d_Ago_Extract_CSV",
							"type": "PipelineReference"
						},
						"parameters": {
							"windowStart": "[parameters('Daily Morning_properties_AG_Order_1d_Ago_Extract_CSV_parameters_windowStart')]",
							"windowEnd": "[parameters('Daily Morning_properties_AG_Order_1d_Ago_Extract_CSV_parameters_windowEnd')]"
						}
					},
					{
						"pipelineReference": {
							"referenceName": "CC_Customer_Full_Flow",
							"type": "PipelineReference"
						},
						"parameters": {}
					},
					{
						"pipelineReference": {
							"referenceName": "TD_Small_Tables_Full_Extract",
							"type": "PipelineReference"
						},
						"parameters": {}
					},
					{
						"pipelineReference": {
							"referenceName": "CC_MainDB_to_Raw",
							"type": "PipelineReference"
						},
						"parameters": {
							"main_directory": "[parameters('Daily Morning_properties_CC_MainDB_to_Raw_parameters_main_directory')]"
						}
					},
					{
						"pipelineReference": {
							"referenceName": "TD_MainDB_to_Raw",
							"type": "PipelineReference"
						},
						"parameters": {
							"main_directory": "[parameters('Daily Morning_properties_TD_MainDB_to_Raw_parameters_main_directory')]"
						}
					},
					{
						"pipelineReference": {
							"referenceName": "CC_Small_Tables_Full_Extract",
							"type": "PipelineReference"
						},
						"parameters": {
							"main_directory": "[parameters('Daily Morning_properties_CC_Small_Tables_Full_Extract_parameters_main_directory')]"
						}
					},
					{
						"pipelineReference": {
							"referenceName": "TD_Customer_Full_Flow",
							"type": "PipelineReference"
						},
						"parameters": {
							"src_customer_table": "[parameters('Daily Morning_properties_TD_Customer_Full_Flow_parameters_src_customer_table')]",
							"src_tradeshop_gps_table": "[parameters('Daily Morning_properties_TD_Customer_Full_Flow_parameters_src_tradeshop_gps_table')]",
							"dest_folder": "[parameters('Daily Morning_properties_TD_Customer_Full_Flow_parameters_dest_folder')]",
							"dest_customer_file": "[parameters('Daily Morning_properties_TD_Customer_Full_Flow_parameters_dest_customer_file')]",
							"dest_gps_file": "[parameters('Daily Morning_properties_TD_Customer_Full_Flow_parameters_dest_gps_file')]"
						}
					}
				],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Day",
						"interval": 1,
						"startTime": "2024-11-28T05:00:00",
						"timeZone": "Ulaanbaatar Standard Time"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/pipelines/AG_Small_Tables_Full_Extract')]",
				"[concat(variables('factoryId'), '/pipelines/AG_MainDB_to_Raw')]",
				"[concat(variables('factoryId'), '/pipelines/AG_Customer_Full_Flow')]",
				"[concat(variables('factoryId'), '/pipelines/AG_Order_1d_Ago_Extract_CSV')]",
				"[concat(variables('factoryId'), '/pipelines/CC_Customer_Full_Flow')]",
				"[concat(variables('factoryId'), '/pipelines/TD_Small_Tables_Full_Extract')]",
				"[concat(variables('factoryId'), '/pipelines/CC_MainDB_to_Raw')]",
				"[concat(variables('factoryId'), '/pipelines/TD_MainDB_to_Raw')]",
				"[concat(variables('factoryId'), '/pipelines/CC_Small_Tables_Full_Extract')]",
				"[concat(variables('factoryId'), '/pipelines/TD_Customer_Full_Flow')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/NightTrigger')]",
			"type": "Microsoft.DataFactory/factories/triggers",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"runtimeState": "Started",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "pl_evs_allemployee_UpsertTrigger",
							"type": "PipelineReference"
						},
						"parameters": {
							"windowStart": "[parameters('NightTrigger_properties_pl_evs_allemployee_UpsertTrigger_parameters_windowStart')]",
							"windowEnd": "[parameters('NightTrigger_properties_pl_evs_allemployee_UpsertTrigger_parameters_windowEnd')]"
						}
					}
				],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Hour",
						"interval": 24,
						"startTime": "2025-11-27T01:40:00",
						"timeZone": "Ulaanbaatar Standard Time"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/pipelines/pl_evs_allemployee_UpsertTrigger')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Trigger_qd9')]",
			"type": "Microsoft.DataFactory/factories/triggers",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"runtimeState": "Started",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "GreenERP_HREmployee",
							"type": "PipelineReference"
						},
						"parameters": {
							"windowStart": "[parameters('Trigger_qd9_properties_GreenERP_HREmployee_parameters_windowStart')]",
							"windowEnd": "[parameters('Trigger_qd9_properties_GreenERP_HREmployee_parameters_windowEnd')]"
						}
					},
					{
						"pipelineReference": {
							"referenceName": "to_DWH_TBLPOSITION",
							"type": "PipelineReference"
						},
						"parameters": {}
					}
				],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Hour",
						"interval": 24,
						"startTime": "2025-11-10T02:00:00Z",
						"timeZone": "UTC"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/pipelines/GreenERP_HREmployee')]",
				"[concat(variables('factoryId'), '/pipelines/to_DWH_TBLPOSITION')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Trigger_xii')]",
			"type": "Microsoft.DataFactory/factories/triggers",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"runtimeState": "Started",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "CopyPipeline_xii",
							"type": "PipelineReference"
						},
						"parameters": {}
					}
				],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Hour",
						"interval": 24,
						"startTime": "2025-11-21T14:57:00Z",
						"timeZone": "UTC"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/pipelines/CopyPipeline_xii')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Trigger_xy6')]",
			"type": "Microsoft.DataFactory/factories/triggers",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"runtimeState": "Stopped",
				"pipelines": [],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Hour",
						"interval": 24,
						"startTime": "2025-11-24T02:10:00Z",
						"timeZone": "UTC"
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Oracle-VM2-IR')]",
			"type": "Microsoft.DataFactory/factories/integrationRuntimes",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "SelfHosted",
				"typeProperties": {}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/mcscc-vpnserver')]",
			"type": "Microsoft.DataFactory/factories/integrationRuntimes",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "SelfHosted",
				"typeProperties": {
					"selfContainedInteractiveAuthoringEnabled": false
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ADLS_Staging_SIGRADE')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "HR"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "csv_SIGRADE",
								"type": "DatasetReference"
							},
							"name": "source1",
							"description": "Import data from TBLPOSITION"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "ADLS_Staging_SIGRADE",
								"type": "DatasetReference"
							},
							"name": "sink1"
						}
					],
					"transformations": [
						{
							"name": "selectRequiredFields"
						}
					],
					"scriptLines": [
						"parameters{",
						"     cwfilename as string (\"SIGRADE\")",
						"}",
						"source(output(",
						"          GRADEID as short,",
						"          CODE as string,",
						"          GRADENO as short,",
						"          NAME as string,",
						"          ISACTIVE as boolean,",
						"          CREATED as string,",
						"          CREATEDBY as string,",
						"          UPDATED as string,",
						"          UPDATEDBY as string,",
						"          IPADDRESS as string,",
						"          MACADDRESS as string,",
						"          TSTAMP as string,",
						"          MASTERID as boolean,",
						"          ISMASTER as boolean,",
						"          GRADETYPEID as boolean",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false) ~> source1",
						"source1 select(mapColumn(",
						"          GRADEID,",
						"          CODE,",
						"          GRADENO,",
						"          NAME,",
						"          ISACTIVE,",
						"          CREATED,",
						"          UPDATED",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> selectRequiredFields",
						"selectRequiredFields sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'parquet',",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> sink1"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/csv_SIGRADE')]",
				"[concat(variables('factoryId'), '/datasets/ADLS_Staging_SIGRADE')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ADLS_Staging_SILEVEL')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "HR"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "csv_SILEVEL",
								"type": "DatasetReference"
							},
							"name": "source1",
							"description": "Import data from SILEVEL"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "ADLS_Staging_SILEVEL",
								"type": "DatasetReference"
							},
							"name": "sink1"
						}
					],
					"transformations": [
						{
							"name": "selectRequiredFields"
						}
					],
					"scriptLines": [
						"parameters{",
						"     cwfilename as string (\"SILEVEL\")",
						"}",
						"source(output(",
						"          LEVELID as short,",
						"          CODE as string,",
						"          NAME as string,",
						"          ISACTIVE as boolean,",
						"          CREATED as string,",
						"          CREATEDBY as string,",
						"          UPDATED as string,",
						"          UPDATEDBY as string,",
						"          IPADDRESS as string,",
						"          MACADDRESS as string,",
						"          TSTAMP as string,",
						"          MASTERID as boolean,",
						"          ISMASTER as boolean",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false) ~> source1",
						"source1 select(mapColumn(",
						"          LEVELID,",
						"          CODE,",
						"          NAME,",
						"          ISACTIVE,",
						"          CREATED,",
						"          UPDATED",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> selectRequiredFields",
						"selectRequiredFields sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          LEVELID as short,",
						"          CODE as string,",
						"          NAME as string,",
						"          ISACTIVE as boolean,",
						"          CREATED as string,",
						"          UPDATED as string",
						"     ),",
						"     format: 'parquet',",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> sink1"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/csv_SILEVEL')]",
				"[concat(variables('factoryId'), '/datasets/ADLS_Staging_SILEVEL')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ADLS_Staging_TBLCOMPANY')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "HR"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "TBLEMPEMPLHIST_csv",
								"type": "DatasetReference"
							},
							"name": "source1",
							"description": "Import data from TBLCOMPANY_csv"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "ADLS_Staging",
								"type": "DatasetReference"
							},
							"name": "sink1"
						}
					],
					"transformations": [
						{
							"name": "selectRequiredFields"
						},
						{
							"name": "filter1"
						}
					],
					"scriptLines": [
						"parameters{",
						"     cwfilename as string (\"TBLCOMPANY\")",
						"}",
						"source(output(",
						"          COMPANYID as string,",
						"          NAME as string,",
						"          ADDRESS as string,",
						"          CREATED as string,",
						"          CREATEDBY as string,",
						"          UPDATED as string,",
						"          UPDATEDBY as string,",
						"          IPADDRESS as string,",
						"          MACADDRESS as string,",
						"          TSTAMP as string,",
						"          BUSINESSTYPEID as short,",
						"          PARENTID as string,",
						"          REPGROUPID as short,",
						"          PHONE as string,",
						"          FAX as string,",
						"          INTCOMPANYID as string,",
						"          JDECOMPANY as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false) ~> source1",
						"filter1 select(skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> selectRequiredFields",
						"source1 filter(!isNull(COMPANYID)) ~> filter1",
						"selectRequiredFields sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          DEPID as short,",
						"          DEPCODE as string,",
						"          NAME as string,",
						"          ISACTIVE as boolean,",
						"          PARENTID as string,",
						"          CREATED as string,",
						"          UPDATED as string,",
						"          COMPANYID as string,",
						"          DEPTYPEID as short,",
						"          PATH as string,",
						"          PARENTPATH as string",
						"     ),",
						"     format: 'parquet',",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     mapColumn(",
						"          COMPANYID,",
						"          NAME,",
						"          CREATED,",
						"          UPDATED,",
						"          PARENTID",
						"     )) ~> sink1"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/TBLEMPEMPLHIST_csv')]",
				"[concat(variables('factoryId'), '/datasets/ADLS_Staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ADLS_Staging_TBLDEPARTMENT')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "HR"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "TBLEMPEMPLHIST_csv",
								"type": "DatasetReference"
							},
							"name": "source1",
							"description": "Import data from TBLDEPARTMENT_csv"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "ADLS_Staging",
								"type": "DatasetReference"
							},
							"name": "sink1"
						}
					],
					"transformations": [
						{
							"name": "selectRequiredFields"
						},
						{
							"name": "filter1"
						}
					],
					"scriptLines": [
						"parameters{",
						"     cwfilename as string (\"TBLDEPARTMENT\")",
						"}",
						"source(output(",
						"          DEPID as short,",
						"          DEPCODE as string,",
						"          NAME as string,",
						"          ISACTIVE as boolean,",
						"          PARENTID as string,",
						"          CREATED as string,",
						"          CREATEDBY as string,",
						"          UPDATED as string,",
						"          UPDATEDBY as string,",
						"          IPADDRESS as string,",
						"          MACADDRESS as string,",
						"          TSTAMP as string,",
						"          COMPANYID as string,",
						"          DEPTYPEID as short,",
						"          PATH as string,",
						"          PARENTPATH as string,",
						"          REPGROUPID as string,",
						"          INTDEPID as short,",
						"          INTPARENTID as short,",
						"          DEPTYPE as string,",
						"          LDAPPATH as string,",
						"          ISPROVINCE as boolean,",
						"          ESTABLISHEDDATE as string,",
						"          SHOWONORGCHART as boolean,",
						"          FAPURPOSEID as boolean",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false) ~> source1",
						"filter1 select(mapColumn(",
						"          DEPID,",
						"          DEPCODE,",
						"          NAME,",
						"          ISACTIVE,",
						"          PARENTID,",
						"          CREATED,",
						"          UPDATED,",
						"          COMPANYID,",
						"          DEPTYPEID,",
						"          PATH,",
						"          PARENTPATH",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> selectRequiredFields",
						"source1 filter(!isNull(DEPID)) ~> filter1",
						"selectRequiredFields sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          DEPID as short,",
						"          DEPCODE as string,",
						"          NAME as string,",
						"          ISACTIVE as boolean,",
						"          PARENTID as string,",
						"          CREATED as string,",
						"          UPDATED as string,",
						"          COMPANYID as string,",
						"          DEPTYPEID as short,",
						"          PATH as string,",
						"          PARENTPATH as string",
						"     ),",
						"     format: 'parquet',",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> sink1"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/TBLEMPEMPLHIST_csv')]",
				"[concat(variables('factoryId'), '/datasets/ADLS_Staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ADLS_Staging_TBLPOSITION')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "HR"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "TBLEMPEMPLHIST_csv",
								"type": "DatasetReference"
							},
							"name": "source1",
							"description": "Import data from TBLPOSITION"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "ADLS_Staging",
								"type": "DatasetReference"
							},
							"name": "sink1"
						}
					],
					"transformations": [
						{
							"name": "selectRequiredFields"
						},
						{
							"name": "filter1"
						}
					],
					"scriptLines": [
						"parameters{",
						"     cwfilename as string (\"TBLPOSITION\")",
						"}",
						"source(output(",
						"          POSITIONID as short,",
						"          COMPANYID as string,",
						"          DEPID as short,",
						"          POSGROUPID as short,",
						"          CODE as string,",
						"          NAME as string,",
						"          EMPLOYMENTTYPEID as short,",
						"          GRADEID as short,",
						"          DIRECTPOSITIONID as string,",
						"          NONDIRECTPOSITIONID as string,",
						"          REPORTPOSITIONID as string,",
						"          GOAL as string,",
						"          CHARACTERISTIC as string,",
						"          VACANCYDAYS as short,",
						"          LABOURCONDITION as string,",
						"          ISACTIVE as boolean,",
						"          CREATED as string,",
						"          CREATEDBY as string,",
						"          UPDATED as string,",
						"          UPDATEDBY as string,",
						"          IPADDRESS as string,",
						"          MACADDRESS as string,",
						"          TSTAMP as string,",
						"          JOBDESCID as short,",
						"          JOBID as short,",
						"          TYPE as string,",
						"          POSITIONOCCID as short,",
						"          POSLEVEL as short,",
						"          JDECOSTCENTER as string,",
						"          JDE_F0006_CO as string,",
						"          JDE_F0006_RP01 as string,",
						"          JDE_F0006_RP02 as string,",
						"          POSCATEGORYID as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false) ~> source1",
						"filter1 select(mapColumn(",
						"          POSITIONID,",
						"          COMPANYID,",
						"          DEPID,",
						"          POSGROUPID,",
						"          CODE,",
						"          NAME,",
						"          EMPLOYMENTTYPEID,",
						"          GRADEID,",
						"          VACANCYDAYS,",
						"          LABOURCONDITION,",
						"          ISACTIVE,",
						"          CREATED,",
						"          UPDATED,",
						"          JOBDESCID,",
						"          JOBID,",
						"          TYPE,",
						"          POSITIONOCCID,",
						"          POSLEVEL",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> selectRequiredFields",
						"source1 filter(!isNull(POSITIONID)) ~> filter1",
						"selectRequiredFields sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          DEPID as short,",
						"          DEPCODE as string,",
						"          NAME as string,",
						"          ISACTIVE as boolean,",
						"          PARENTID as string,",
						"          CREATED as string,",
						"          UPDATED as string,",
						"          COMPANYID as string,",
						"          DEPTYPEID as short,",
						"          PATH as string,",
						"          PARENTPATH as string",
						"     ),",
						"     format: 'parquet',",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> sink1"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/TBLEMPEMPLHIST_csv')]",
				"[concat(variables('factoryId'), '/datasets/ADLS_Staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ADLS_Staging_copy1')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "HR"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "TBLEMPEMPLHIST_csv",
								"type": "DatasetReference"
							},
							"name": "source1"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "ADLS_Staging",
								"type": "DatasetReference"
							},
							"name": "sink1"
						}
					],
					"transformations": [
						{
							"name": "selectRequiredFields"
						},
						{
							"name": "filter1"
						}
					],
					"scriptLines": [
						"source(output(",
						"          HISTORYID as integer,",
						"          EMPID as short,",
						"          BEGINDATE as string,",
						"          ENDDATE as string,",
						"          ORDERID as short,",
						"          ORDERTYPE as string,",
						"          COMPANYID as string,",
						"          DEPID as short,",
						"          POSITIONID as short,",
						"          GRADEID as short,",
						"          LEVELID as short,",
						"          BASEWAGE as integer,",
						"          BASEWAGECURRCODE as string,",
						"          TSTAMP as string,",
						"          CREATED as string,",
						"          CREATEDBY as string,",
						"          UPDATED as string,",
						"          UPDATEDBY as string,",
						"          IPADDRESS as string,",
						"          MACADDRESS as string,",
						"          ORDERNO as string,",
						"          ISMANUALHIST as boolean,",
						"          ISNOTLOCALHIST as boolean,",
						"          LEGALENTITYID as short,",
						"          OLDDEPNAME as string,",
						"          JOBID as short,",
						"          NOTE as string,",
						"          INSURETYPEID as short,",
						"          LABOURCONDITION as boolean,",
						"          ISMULT as boolean,",
						"          MULTYEAR as boolean,",
						"          HISTREASON as short,",
						"          HISTREASONNAMES as string,",
						"          TOTALWAGE as integer,",
						"          EVOLVEWAGE as boolean,",
						"          CALCPERCENT as short,",
						"          GRADETYPEID as string,",
						"          LEVELNO as string,",
						"          FTEMAINID as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: true,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false) ~> source1",
						"filter1 select(skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> selectRequiredFields",
						"source1 filter(COMPANYID!=\"MCSH\") ~> filter1",
						"selectRequiredFields sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          DEPID as short,",
						"          DEPCODE as string,",
						"          NAME as string,",
						"          ISACTIVE as boolean,",
						"          PARENTID as string,",
						"          CREATED as string,",
						"          UPDATED as string,",
						"          COMPANYID as string,",
						"          DEPTYPEID as short,",
						"          PATH as string,",
						"          PARENTPATH as string",
						"     ),",
						"     format: 'parquet',",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     mapColumn(",
						"          HISTORYID,",
						"          EMPID,",
						"          BEGINDATE,",
						"          ENDDATE,",
						"          ORDERID,",
						"          ORDERTYPE,",
						"          COMPANYID,",
						"          DEPID,",
						"          POSITIONID,",
						"          GRADEID,",
						"          LEVELID,",
						"          BASEWAGE,",
						"          BASEWAGECURRCODE,",
						"          CREATED,",
						"          UPDATED,",
						"          ORDERNO,",
						"          OLDDEPNAME,",
						"          JOBID,",
						"          INSURETYPEID,",
						"          LABOURCONDITION",
						"     )) ~> sink1"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/TBLEMPEMPLHIST_csv')]",
				"[concat(variables('factoryId'), '/datasets/ADLS_Staging')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ADLS_Staging_employee')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "HR"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "Employee",
								"type": "DatasetReference"
							},
							"name": "source1"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "ADLS_Staging_Employee",
								"type": "DatasetReference"
							},
							"name": "sink1"
						}
					],
					"transformations": [
						{
							"name": "selectRequiredFields"
						},
						{
							"name": "filter1"
						}
					],
					"scriptLines": [
						"source(output(",
						"          EMPID as string,",
						"          CODE as string,",
						"          FAMILYNAME as string,",
						"          LASTNAME as string,",
						"          FIRSTNAME as string,",
						"          GENDER as string,",
						"          BIRTHDATE as string,",
						"          BIRTHCOUNTRYID as string,",
						"          BIRTHDIVISIONID as string,",
						"          BIRTHDISTRICTID as string,",
						"          BIRTHPLACE as string,",
						"          COUNTRYID as string,",
						"          DIVISIONID as string,",
						"          DISTRICTID as string,",
						"          NATIONALITYID as string,",
						"          SOCIALORIGINID as string,",
						"          MARITALSTATUS as string,",
						"          BLOODGROUP as string,",
						"          REGNO as string,",
						"          PASSNO as string,",
						"          FORPASSNO as string,",
						"          EMDNO as string,",
						"          NDDNO as string,",
						"          ADDR1 as string,",
						"          ADDR2 as string,",
						"          HOMEPHONE as string,",
						"          MOBILEPHONE as string,",
						"          WORKPHONE as string,",
						"          WORKPHONEEXT as string,",
						"          FAX as string,",
						"          EMAIL as string,",
						"          POSTADDRESS as string,",
						"          CONTACTNAME as string,",
						"          CONTACTPHONE as string,",
						"          WITHPICTURE as string,",
						"          STATUS as string,",
						"          CREATED as string,",
						"          CREATEDBY as string,",
						"          UPDATED as string,",
						"          UPDATEDBY as string,",
						"          IPADDRESS as string,",
						"          MACADDRESS as string,",
						"          TSTAMP as string,",
						"          COMPANYID as string,",
						"          STATUSDATE as string,",
						"          LASTNAMELENGTH as string,",
						"          EMAIL2 as string,",
						"          CONTACTNAME2 as string,",
						"          CONTACTPHONE2 as string,",
						"          ISBLACKLISTED as string,",
						"          BLACKLISTREASON as string,",
						"          BLACKLISTEDDATE as string,",
						"          ISFOREIGNER as string,",
						"          CONTACTID as string,",
						"          MILITARYSERVED as string,",
						"          TRAININGSPORT as string,",
						"          INTEREST as string,",
						"          APPID as string,",
						"          MILITARYNO as string,",
						"          RELATIVEID as string,",
						"          RELATIVEID2 as string,",
						"          MILITARYCLOSETYPE as string,",
						"          MILITARYCOMMENT as string,",
						"          LINKEDIN as string,",
						"          FACEBOOK as string,",
						"          TWITTER as string,",
						"          ISSPYOATH as string,",
						"          SPYOATHDATE as string,",
						"          ISGOVERNMENTOATH as string,",
						"          GOVERNMENTOATHDATE as string,",
						"          ISMILITARYOATH as string,",
						"          MILITARYOATHDATE as string,",
						"          LINKID as string,",
						"          ISRESIDENT as string,",
						"          CIVILID as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: true,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false) ~> source1",
						"filter1 select(skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> selectRequiredFields",
						"source1 filter(!isNull(REGNO)) ~> filter1",
						"selectRequiredFields sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          EMPID as string,",
						"          CODE as string,",
						"          FAMILYNAME as string,",
						"          LASTNAME as string,",
						"          FIRSTNAME as string,",
						"          GENDER as string,",
						"          BIRTHDATE as string,",
						"          BIRTHCOUNTRYID as string,",
						"          BIRTHDIVISIONID as string,",
						"          BIRTHDISTRICTID as string,",
						"          BIRTHPLACE as string,",
						"          COUNTRYID as string,",
						"          DIVISIONID as string,",
						"          DISTRICTID as string,",
						"          NATIONALITYID as string,",
						"          SOCIALORIGINID as string,",
						"          MARITALSTATUS as string,",
						"          BLOODGROUP as string,",
						"          REGNO as string,",
						"          PASSNO as string,",
						"          FORPASSNO as string,",
						"          EMDNO as string,",
						"          NDDNO as string,",
						"          ADDR1 as string,",
						"          ADDR2 as string,",
						"          HOMEPHONE as string,",
						"          MOBILEPHONE as string,",
						"          WORKPHONE as string,",
						"          WORKPHONEEXT as string,",
						"          FAX as string,",
						"          EMAIL as string,",
						"          POSTADDRESS as string,",
						"          CONTACTNAME as string,",
						"          CONTACTPHONE as string,",
						"          WITHPICTURE as string,",
						"          STATUS as string,",
						"          CREATED as string,",
						"          CREATEDBY as string,",
						"          UPDATED as string,",
						"          UPDATEDBY as string,",
						"          IPADDRESS as string,",
						"          MACADDRESS as string,",
						"          TSTAMP as string,",
						"          COMPANYID as string,",
						"          STATUSDATE as string,",
						"          LASTNAMELENGTH as string,",
						"          EMAIL2 as string,",
						"          CONTACTNAME2 as string,",
						"          CONTACTPHONE2 as string,",
						"          ISBLACKLISTED as string,",
						"          BLACKLISTREASON as string,",
						"          BLACKLISTEDDATE as string,",
						"          ISFOREIGNER as string,",
						"          CONTACTID as string,",
						"          MILITARYSERVED as string,",
						"          TRAININGSPORT as string,",
						"          INTEREST as string,",
						"          APPID as string,",
						"          MILITARYNO as string,",
						"          RELATIVEID as string,",
						"          RELATIVEID2 as string,",
						"          MILITARYCLOSETYPE as string,",
						"          MILITARYCOMMENT as string,",
						"          LINKEDIN as string,",
						"          FACEBOOK as string,",
						"          TWITTER as string,",
						"          ISSPYOATH as string,",
						"          SPYOATHDATE as string,",
						"          ISGOVERNMENTOATH as string,",
						"          GOVERNMENTOATHDATE as string,",
						"          ISMILITARYOATH as string,",
						"          MILITARYOATHDATE as string,",
						"          LINKID as string,",
						"          ISRESIDENT as string,",
						"          CIVILID as string",
						"     ),",
						"     format: 'parquet',",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> sink1"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/Employee')]",
				"[concat(variables('factoryId'), '/datasets/ADLS_Staging_Employee')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AG_Customer_DWH_to_DataService')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "AG"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "DWH_Mysql",
								"type": "DatasetReference"
							},
							"name": "agDwhCustomerTable"
						},
						{
							"dataset": {
								"referenceName": "DataService_TestMerchant",
								"type": "DatasetReference"
							},
							"name": "addressFromDataServiceTable"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "DataService_TestMerchant",
								"type": "DatasetReference"
							},
							"name": "saveToDataServiceDB"
						}
					],
					"transformations": [
						{
							"name": "selectRequiredFields",
							"description": "Data Service-iin customer_ag_info table-d hadgalj boloh medeelluudiig gargan avah process"
						},
						{
							"name": "locationInfoProcessing"
						},
						{
							"name": "separateAddressByLevel",
							"description": "loc_name-g aimag_hot, duureg_sum, bag_khoroo gesen hesguuded huvaana"
						},
						{
							"name": "makeAddressList",
							"description": "aimag_hot, duureg_sum, bag_khoroo tus buriinh ni huvid list uusgene, uuniig ashiglan customer datanaas haygiin medeelel gargan avna"
						},
						{
							"name": "customerWithLocationList"
						},
						{
							"name": "locationCapturing",
							"description": "aimag_hot, duureg_sum, bag_khoroo-nii medeelliig dataservice-iin DB deerh location table-tai matchlaad taarch bgaag ni ylgaj avna"
						},
						{
							"name": "selectFieldForDB"
						},
						{
							"name": "additionalFixOnLocation",
							"description": "capitalize\nUlaanbaatriinh bish bol bag_khoroo-nii medeelliig hasah"
						},
						{
							"name": "addressFixDistrictCityAbbr1",
							"description": "  => ,   geh meteer haygiig tovchilj bichsen bgaag zasah"
						},
						{
							"name": "addressFixDistrictAbbr1",
							"description": " => ,   geh meteer haygiig tovchilj bichsen bgaag zasah"
						},
						{
							"name": "AlterRow1"
						}
					],
					"scriptLines": [
						"source(output(",
						"          id as integer,",
						"          customer_ag_id as integer,",
						"          customer_name as string,",
						"          full_address as string,",
						"          golden_flag as integer,",
						"          customer_register as string,",
						"          register_type as integer,",
						"          phone_number as string,",
						"          customer_created_date as timestamp,",
						"          created_at as timestamp,",
						"          updated_at as timestamp,",
						"          is_reliable_register as integer",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> agDwhCustomerTable",
						"source(output(",
						"          id as integer,",
						"          loc_name as string,",
						"          full_address as string,",
						"          lvl as integer,",
						"          eb_id as string,",
						"          parent_id as integer",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> addressFromDataServiceTable",
						"agDwhCustomerTable select(mapColumn(",
						"          customer_ag_id,",
						"          customer_name,",
						"          full_address,",
						"          customer_register,",
						"          register_type,",
						"          phone_number,",
						"          customer_created_date",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> selectRequiredFields",
						"addressFixDistrictAbbr1 derive(aimag_hot = iif(isNull(at(split(fixed_address, ','), 3)), toString(null()), at(split(fixed_address, ','), 1)),",
						"          duureg_sum = iif(isNull(at(split(fixed_address, ','), 3)), toString(null()), at(split(fixed_address, ','), 2)),",
						"          bag_khoroo = iif(isNull(at(split(fixed_address, ','), 3)), toString(null()), at(split(fixed_address, ','), 3)),",
						"          join_col = 1) ~> locationInfoProcessing",
						"addressFromDataServiceTable derive(aimag_hot_list = iif(lvl == 1, lower(loc_name), toString(null())),",
						"          duureg_sum_list = iif(lvl == 2, lower(loc_name), toString(null())),",
						"          bag_khoroo_list = iif(lvl == 3, lower(loc_name), toString(null())),",
						"          join_col = 1) ~> separateAddressByLevel",
						"separateAddressByLevel aggregate(aimag_hot_list = collectUnique(aimag_hot_list),",
						"          duureg_sum_list = collectUnique(duureg_sum_list),",
						"          bag_khoroo_list = collectUnique(bag_khoroo_list),",
						"          join_col = max(join_col)) ~> makeAddressList",
						"locationInfoProcessing, makeAddressList join(locationInfoProcessing@join_col == makeAddressList@join_col,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> customerWithLocationList",
						"customerWithLocationList derive(aimag_hot = toString(at(intersect(split(lower(aimag_hot), ' '), aimag_hot_list), 1)),",
						"          duureg_sum = toString(at(intersect(split(lower(duureg_sum), ' '), duureg_sum_list), 1)),",
						"          bag_khoroo = iif(\r",
						"    instr(bag_khoroo, '-  ') != 0,\r",
						"    toInteger(at(split(bag_khoroo, '-  '), 1)), \r",
						"    iif(\r",
						"        instr(bag_khoroo, '- ,') != 0,\r",
						"        toInteger(at(split(bag_khoroo, '- ,'), 1)),\r",
						"        iif(\r",
						"            instr(bag_khoroo, ' ') != 0,\r",
						"            toInteger(at(split(bag_khoroo, ' '), 1)),\r",
						"            toInteger(null())\r",
						"        )\r",
						"    )\r",
						")) ~> locationCapturing",
						"locationCapturing select(mapColumn(",
						"          customer_ag_id,",
						"          customer_name,",
						"          full_address,",
						"          customer_register,",
						"          register_type,",
						"          phone_number,",
						"          customer_created_date,",
						"          aimag_hot,",
						"          duureg_sum,",
						"          bag_khoroo",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> selectFieldForDB",
						"selectFieldForDB derive(aimag_hot = replace(initCap(replace(aimag_hot, '-', ' ')), ' ', '-'),",
						"          duureg_sum = replace(initCap(replace(duureg_sum, '-', ' ')), ' ', '-'),",
						"          bag_khoroo = iif(aimag_hot =='', bag_khoroo, toInteger(null()))) ~> additionalFixOnLocation",
						"selectRequiredFields derive(fixed_address = replace(\r",
						"    replace(\r",
						"        replace(\r",
						"            replace(\r",
						"                replace(\r",
						"                    replace(\r",
						"                        replace(\r",
						"                            replace(\r",
						"                                replace(\r",
						"                                    lower(full_address), ' ', ',  ,'\r",
						"                                ), ' ', ',  ,'\r",
						"                            ), ' ', ',  ,'\r",
						"                        ), ' ', ',  ,'\r",
						"                    ), ' ', ',  ,'\r",
						"                ), ' ', ',  ,'\r",
						"            ), ' ', ', - ,'\r",
						"        ), ' ', ',  ,'\r",
						"    ), ' ', ',  ,'\r",
						")) ~> addressFixDistrictCityAbbr1",
						"addressFixDistrictCityAbbr1 derive(fixed_address = replace(\r",
						"    replace(\r",
						"        replace(\r",
						"            replace(\r",
						"                replace(\r",
						"                    replace(\r",
						"                        fixed_address, ' ', ',  ,'\r",
						"                    ), '', ',  ,'\r",
						"                ), '', ',  ,'\r",
						"            ), ' ', ', - ,'\r",
						"        ), '', ',  ,'\r",
						"    ), '', ',  ,'\r",
						")) ~> addressFixDistrictAbbr1",
						"additionalFixOnLocation alterRow(upsertIf(true())) ~> AlterRow1",
						"AlterRow1 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:true,",
						"     upsertable:true,",
						"     keys:['customer_register','customer_ag_id'],",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> saveToDataServiceDB"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/DWH_Mysql')]",
				"[concat(variables('factoryId'), '/datasets/DataService_TestMerchant')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AG_Customer_DWH_to_DataService_SQL')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "AG"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "Dwh_Sql",
								"type": "DatasetReference"
							},
							"name": "agDwhCustomerTable"
						},
						{
							"dataset": {
								"referenceName": "DataService_TestMerchant",
								"type": "DatasetReference"
							},
							"name": "addressFromDataServiceTable"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "DataService_TestMerchant",
								"type": "DatasetReference"
							},
							"name": "saveToDataServiceDB"
						}
					],
					"transformations": [
						{
							"name": "selectRequiredFields",
							"description": "Data Service-iin customer_ag_info table-d hadgalj boloh medeelluudiig gargan avah process"
						},
						{
							"name": "locationInfoProcessing"
						},
						{
							"name": "separateAddressByLevel",
							"description": "loc_name-g aimag_hot, duureg_sum, bag_khoroo gesen hesguuded huvaana"
						},
						{
							"name": "makeAddressList",
							"description": "aimag_hot, duureg_sum, bag_khoroo tus buriinh ni huvid list uusgene, uuniig ashiglan customer datanaas haygiin medeelel gargan avna"
						},
						{
							"name": "customerWithLocationList"
						},
						{
							"name": "locationCapturing",
							"description": "aimag_hot, duureg_sum, bag_khoroo-nii medeelliig dataservice-iin DB deerh location table-tai matchlaad taarch bgaag ni ylgaj avna"
						},
						{
							"name": "selectFieldForDB"
						},
						{
							"name": "additionalFixOnLocation",
							"description": "capitalize\nUlaanbaatriinh bish bol bag_khoroo-nii medeelliig hasah"
						},
						{
							"name": "addressFixDistrictCityAbbr1",
							"description": "  => ,   geh meteer haygiig tovchilj bichsen bgaag zasah"
						},
						{
							"name": "addressFixDistrictAbbr1",
							"description": " => ,   geh meteer haygiig tovchilj bichsen bgaag zasah"
						},
						{
							"name": "AlterRow1"
						}
					],
					"scriptLines": [
						"source(output(",
						"          id as integer,",
						"          customer_ag_id as integer,",
						"          customer_name as string,",
						"          full_address as string,",
						"          golden_flag as boolean,",
						"          customer_register as string,",
						"          register_type as boolean,",
						"          phone_number as string,",
						"          customer_created_date as timestamp,",
						"          created_at as timestamp,",
						"          updated_at as timestamp,",
						"          is_reliable_register as boolean",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> agDwhCustomerTable",
						"source(output(",
						"          id as integer,",
						"          loc_name as string,",
						"          full_address as string,",
						"          lvl as integer,",
						"          eb_id as string,",
						"          parent_id as integer",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> addressFromDataServiceTable",
						"agDwhCustomerTable select(mapColumn(",
						"          customer_ag_id,",
						"          customer_name,",
						"          full_address,",
						"          customer_register,",
						"          register_type,",
						"          phone_number,",
						"          customer_created_date",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> selectRequiredFields",
						"addressFixDistrictAbbr1 derive(aimag_hot = iif(isNull(at(split(fixed_address, ','), 3)), toString(null()), at(split(fixed_address, ','), 1)),",
						"          duureg_sum = iif(isNull(at(split(fixed_address, ','), 3)), toString(null()), at(split(fixed_address, ','), 2)),",
						"          bag_khoroo = iif(isNull(at(split(fixed_address, ','), 3)), toString(null()), at(split(fixed_address, ','), 3)),",
						"          join_col = 1) ~> locationInfoProcessing",
						"addressFromDataServiceTable derive(aimag_hot_list = iif(lvl == 1, lower(loc_name), toString(null())),",
						"          duureg_sum_list = iif(lvl == 2, lower(loc_name), toString(null())),",
						"          bag_khoroo_list = iif(lvl == 3, lower(loc_name), toString(null())),",
						"          join_col = 1) ~> separateAddressByLevel",
						"separateAddressByLevel aggregate(aimag_hot_list = collectUnique(aimag_hot_list),",
						"          duureg_sum_list = collectUnique(duureg_sum_list),",
						"          bag_khoroo_list = collectUnique(bag_khoroo_list),",
						"          join_col = max(join_col)) ~> makeAddressList",
						"locationInfoProcessing, makeAddressList join(locationInfoProcessing@join_col == makeAddressList@join_col,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> customerWithLocationList",
						"customerWithLocationList derive(aimag_hot = toString(at(intersect(split(lower(aimag_hot), ' '), aimag_hot_list), 1)),",
						"          duureg_sum = toString(at(intersect(split(lower(duureg_sum), ' '), duureg_sum_list), 1)),",
						"          bag_khoroo = iif(\r",
						"    instr(bag_khoroo, '-  ') != 0,\r",
						"    toInteger(at(split(bag_khoroo, '-  '), 1)), \r",
						"    iif(\r",
						"        instr(bag_khoroo, '- ,') != 0,\r",
						"        toInteger(at(split(bag_khoroo, '- ,'), 1)),\r",
						"        iif(\r",
						"            instr(bag_khoroo, ' ') != 0,\r",
						"            toInteger(at(split(bag_khoroo, ' '), 1)),\r",
						"            toInteger(null())\r",
						"        )\r",
						"    )\r",
						")) ~> locationCapturing",
						"locationCapturing select(mapColumn(",
						"          customer_ag_id,",
						"          customer_name,",
						"          full_address,",
						"          customer_register,",
						"          register_type,",
						"          phone_number,",
						"          customer_created_date,",
						"          aimag_hot,",
						"          duureg_sum,",
						"          bag_khoroo",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> selectFieldForDB",
						"selectFieldForDB derive(aimag_hot = replace(initCap(replace(aimag_hot, '-', ' ')), ' ', '-'),",
						"          duureg_sum = replace(initCap(replace(duureg_sum, '-', ' ')), ' ', '-'),",
						"          bag_khoroo = iif(aimag_hot =='', bag_khoroo, toInteger(null()))) ~> additionalFixOnLocation",
						"selectRequiredFields derive(fixed_address = replace(\r",
						"    replace(\r",
						"        replace(\r",
						"            replace(\r",
						"                replace(\r",
						"                    replace(\r",
						"                        replace(\r",
						"                            replace(\r",
						"                                replace(\r",
						"                                    lower(full_address), ' ', ',  ,'\r",
						"                                ), ' ', ',  ,'\r",
						"                            ), ' ', ',  ,'\r",
						"                        ), ' ', ',  ,'\r",
						"                    ), ' ', ',  ,'\r",
						"                ), ' ', ',  ,'\r",
						"            ), ' ', ', - ,'\r",
						"        ), ' ', ',  ,'\r",
						"    ), ' ', ',  ,'\r",
						")) ~> addressFixDistrictCityAbbr1",
						"addressFixDistrictCityAbbr1 derive(fixed_address = replace(\r",
						"    replace(\r",
						"        replace(\r",
						"            replace(\r",
						"                replace(\r",
						"                    replace(\r",
						"                        fixed_address, ' ', ',  ,'\r",
						"                    ), '', ',  ,'\r",
						"                ), '', ',  ,'\r",
						"            ), ' ', ', - ,'\r",
						"        ), '', ',  ,'\r",
						"    ), '', ',  ,'\r",
						")) ~> addressFixDistrictAbbr1",
						"additionalFixOnLocation alterRow(upsertIf(true())) ~> AlterRow1",
						"AlterRow1 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:true,",
						"     upsertable:true,",
						"     keys:['customer_register','customer_ag_id'],",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> saveToDataServiceDB"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/Dwh_Sql')]",
				"[concat(variables('factoryId'), '/datasets/DataService_TestMerchant')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AG_Customer_Filtered_to_DWH')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "AG"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "ADLS_Filtered_CSV",
								"type": "DatasetReference"
							},
							"name": "agCustomerFiltered",
							"description": "ADLS deerh fmcg-filtered container-ees ag_dwh_filtered/ag_dwh_customer_full.csv datag avah process. Ene ni customer datag aguulsan bga"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "DWH_Mysql",
								"type": "DatasetReference"
							},
							"name": "agCustomerDWH"
						},
						{
							"dataset": {
								"referenceName": "DWH_Mysql",
								"type": "DatasetReference"
							},
							"name": "agTradeShopDWH"
						}
					],
					"transformations": [
						{
							"name": "CustomerTable",
							"description": "customer_register (INN), customer_ag_id(OwnerID)-aar groupleed uldsen medeelluudiig aggregate hiigeed customer table gargaj avna."
						},
						{
							"name": "AlterCustomerTable",
							"description": "Database ruu upsert hiih bolomjiig bii bolgoh"
						},
						{
							"name": "notNullCustomers",
							"description": "0 (null) registertei bas null owner_id-tai hariltsagchdiig ylgaj avah"
						},
						{
							"name": "CustomerInfoFix",
							"description": "Customer register ni null, esvel formataas zursun uyd tuuniig '0' bolgoh, format ni 7 orontoi too esvel hunii RD bh ystoi"
						},
						{
							"name": "TradeShopTable",
							"description": "niit medeellees tradeshop-iin medeelel gargan avch DWH ruu hadgalah"
						},
						{
							"name": "FilterOutUnknownTradeshops"
						},
						{
							"name": "TradeshopFix",
							"description": "trade_shop_ag_id (cusid), trade_shop_id_check (tradeshop_id) nariin utguud null bgaa tohioldold nuguuguur ni nuhuh, esvel 0-eer nuhnu"
						},
						{
							"name": "GroupByTradeshop",
							"description": "Tradeshop datagaa trade_shop_ag_id, trade_shop_id_check columnuudaar grouplej davhardliig arilgana"
						},
						{
							"name": "AlterTradeShopTable"
						}
					],
					"scriptLines": [
						"source(output(",
						"          cusid_ag as integer,",
						"          trade_shop_name as string,",
						"          full_address as string,",
						"          isis_channel_id as integer,",
						"          customer_ag_id as integer,",
						"          customer_name as string,",
						"          customer_register as string,",
						"          trade_shop_ag_id as integer,",
						"          store_type_name as string,",
						"          phone_number as string,",
						"          customer_created_date as string,",
						"          longitude as string,",
						"          latitude as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false) ~> agCustomerFiltered",
						"notNullCustomers@notNullCustomers aggregate(groupBy(customer_register,",
						"          customer_ag_id),",
						"     customer_name = iifNull(min(customer_name), min(trade_shop_name)),",
						"          full_address = min(full_address),",
						"          is_reliable_register = iif(max(customer_register) == '0', 0, 1),",
						"          register_type = iif(regexMatch(min(customer_register),  `^\\d+$`), 1,  0),",
						"          phone_number = max(phone_number),",
						"          customer_created_date = min(customer_created_date)) ~> CustomerTable",
						"CustomerTable alterRow(upsertIf(true())) ~> AlterCustomerTable",
						"CustomerInfoFix split(!and(customer_register == '0', isNull(customer_ag_id)),",
						"     disjoint: false) ~> notNullCustomers@(notNullCustomers, nullCustomers)",
						"agCustomerFiltered derive(customer_register = trim(iif(length(customer_register) <= 6, '0', iifNull(customer_register, '0'))),",
						"          register_fixed = iif(length(customer_register) <= 6, 1, iif(or(customer_register == '1000000', customer_register == '888888888'), 1, 0))) ~> CustomerInfoFix",
						"CustomerInfoFix select(mapColumn(",
						"          trade_shop_ag_id = cusid_ag,",
						"          trade_shop_name,",
						"          customer_ag_id,",
						"          full_address,",
						"          longitude,",
						"          latitude,",
						"          phone_number,",
						"          isis_channel_id,",
						"          trade_shop_id_check = trade_shop_ag_id,",
						"          store_type_name,",
						"          trade_shop_created_date = customer_created_date,",
						"          customer_register",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> TradeShopTable",
						"TradeShopTable filter(!and(isNull(trade_shop_ag_id), isNull(trade_shop_id_check))) ~> FilterOutUnknownTradeshops",
						"FilterOutUnknownTradeshops derive(trade_shop_ag_id = iifNull(trade_shop_ag_id, trade_shop_id_check, 0),",
						"          is_reliable_trade_shop_ag_id = iif(isNull(trade_shop_ag_id), 0, 1),",
						"          trade_shop_id_check = iifNull(trade_shop_id_check, trade_shop_ag_id, 0),",
						"          is_reliable_trade_shop_id_check = iif(isNull(trade_shop_id_check), 0, 1)) ~> TradeshopFix",
						"TradeshopFix aggregate(groupBy(trade_shop_ag_id,",
						"          trade_shop_id_check),",
						"     is_reliable_trade_shop_ag_id = max(is_reliable_trade_shop_ag_id),",
						"          trade_shop_name = max(trade_shop_name),",
						"          full_address = max(full_address),",
						"          longitude = first(longitude),",
						"          latitude = first(latitude),",
						"          phone_number = max(phone_number),",
						"          isis_channel_id = max(isis_channel_id),",
						"          is_reliable_trade_shop_id_check = max(is_reliable_trade_shop_id_check),",
						"          store_type_name = max(store_type_name),",
						"          trade_shop_created_date = min(trade_shop_created_date),",
						"          customer_register = max(customer_register),",
						"          customer_ag_id = max(customer_ag_id)) ~> GroupByTradeshop",
						"GroupByTradeshop alterRow(upsertIf(true())) ~> AlterTradeShopTable",
						"AlterCustomerTable sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:true,",
						"     upsertable:true,",
						"     keys:['customer_register','customer_ag_id'],",
						"     format: 'table',",
						"     batchSize: 5000,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> agCustomerDWH",
						"AlterTradeShopTable sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:true,",
						"     upsertable:true,",
						"     keys:['trade_shop_ag_id','trade_shop_id_check'],",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> agTradeShopDWH"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/ADLS_Filtered_CSV')]",
				"[concat(variables('factoryId'), '/datasets/DWH_Mysql')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AG_Customer_Filtered_to_DWH_SQL')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "AG"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "ADLS_Filtered_CSV",
								"type": "DatasetReference"
							},
							"name": "agCustomerFiltered",
							"description": "ADLS deerh fmcg-filtered container-ees ag_dwh_filtered/ag_dwh_customer_full.csv datag avah process. Ene ni customer datag aguulsan bga"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "Dwh_Sql",
								"type": "DatasetReference"
							},
							"name": "agCustomerDWH"
						},
						{
							"dataset": {
								"referenceName": "Dwh_Sql",
								"type": "DatasetReference"
							},
							"name": "agTradeShopDWH"
						}
					],
					"transformations": [
						{
							"name": "CustomerTable",
							"description": "customer_register (INN), customer_ag_id(OwnerID)-aar groupleed uldsen medeelluudiig aggregate hiigeed customer table gargaj avna."
						},
						{
							"name": "AlterCustomerTable",
							"description": "Database ruu upsert hiih bolomjiig bii bolgoh"
						},
						{
							"name": "notNullCustomers",
							"description": "0 (null) registertei bas null owner_id-tai hariltsagchdiig ylgaj avah"
						},
						{
							"name": "CustomerInfoFix",
							"description": "Customer register ni null, esvel formataas zursun uyd tuuniig '0' bolgoh, format ni 7 orontoi too esvel hunii RD bh ystoi"
						},
						{
							"name": "TradeShopTable",
							"description": "niit medeellees tradeshop-iin medeelel gargan avch DWH ruu hadgalah"
						},
						{
							"name": "FilterOutUnknownTradeshops"
						},
						{
							"name": "TradeshopFix",
							"description": "trade_shop_ag_id (cusid), trade_shop_id_check (tradeshop_id) nariin utguud null bgaa tohioldold nuguuguur ni nuhuh, esvel 0-eer nuhnu"
						},
						{
							"name": "GroupByTradeshop",
							"description": "Tradeshop datagaa trade_shop_ag_id, trade_shop_id_check columnuudaar grouplej davhardliig arilgana"
						},
						{
							"name": "AlterTradeShopTable"
						}
					],
					"scriptLines": [
						"source(output(",
						"          cusid_ag as integer,",
						"          trade_shop_name as string,",
						"          full_address as string,",
						"          isis_channel_id as integer,",
						"          customer_ag_id as integer,",
						"          customer_name as string,",
						"          customer_register as string,",
						"          trade_shop_ag_id as integer,",
						"          store_type_name as string,",
						"          phone_number as string,",
						"          customer_created_date as string,",
						"          longitude as string,",
						"          latitude as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false) ~> agCustomerFiltered",
						"notNullCustomers@notNullCustomers aggregate(groupBy(customer_register,",
						"          customer_ag_id),",
						"     customer_name = iifNull(min(customer_name), min(trade_shop_name)),",
						"          full_address = min(full_address),",
						"          is_reliable_register = iif(max(customer_register) == '0', 0, 1),",
						"          register_type = iif(regexMatch(min(customer_register),  `^\\d+$`), 1,  0),",
						"          phone_number = max(phone_number),",
						"          customer_created_date = min(customer_created_date)) ~> CustomerTable",
						"CustomerTable alterRow(upsertIf(true())) ~> AlterCustomerTable",
						"CustomerInfoFix split(!and(customer_register == '0', isNull(customer_ag_id)),",
						"     disjoint: false) ~> notNullCustomers@(notNullCustomers, nullCustomers)",
						"agCustomerFiltered derive(customer_register = trim(iif(length(customer_register) <= 6, '0', iifNull(customer_register, '0'))),",
						"          register_fixed = iif(length(customer_register) <= 6, 1, iif(or(customer_register == '1000000', customer_register == '888888888'), 1, 0))) ~> CustomerInfoFix",
						"CustomerInfoFix select(mapColumn(",
						"          trade_shop_ag_id = cusid_ag,",
						"          trade_shop_name,",
						"          customer_ag_id,",
						"          full_address,",
						"          longitude,",
						"          latitude,",
						"          phone_number,",
						"          isis_channel_id,",
						"          trade_shop_id_check = trade_shop_ag_id,",
						"          store_type_name,",
						"          trade_shop_created_date = customer_created_date,",
						"          customer_register",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> TradeShopTable",
						"TradeShopTable filter(!and(isNull(trade_shop_ag_id), isNull(trade_shop_id_check))) ~> FilterOutUnknownTradeshops",
						"FilterOutUnknownTradeshops derive(trade_shop_ag_id = iifNull(trade_shop_ag_id, trade_shop_id_check, 0),",
						"          is_reliable_trade_shop_ag_id = iif(isNull(trade_shop_ag_id), 0, 1),",
						"          trade_shop_id_check = iifNull(trade_shop_id_check, trade_shop_ag_id, 0),",
						"          is_reliable_trade_shop_id_check = iif(isNull(trade_shop_id_check), 0, 1)) ~> TradeshopFix",
						"TradeshopFix aggregate(groupBy(trade_shop_ag_id,",
						"          trade_shop_id_check),",
						"     is_reliable_trade_shop_ag_id = max(is_reliable_trade_shop_ag_id),",
						"          trade_shop_name = max(trade_shop_name),",
						"          full_address = max(full_address),",
						"          longitude = first(longitude),",
						"          latitude = first(latitude),",
						"          phone_number = max(phone_number),",
						"          isis_channel_id = max(isis_channel_id),",
						"          is_reliable_trade_shop_id_check = max(is_reliable_trade_shop_id_check),",
						"          store_type_name = max(store_type_name),",
						"          trade_shop_created_date = min(trade_shop_created_date),",
						"          customer_register = max(customer_register),",
						"          customer_ag_id = max(customer_ag_id)) ~> GroupByTradeshop",
						"GroupByTradeshop alterRow(upsertIf(true())) ~> AlterTradeShopTable",
						"AlterCustomerTable sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:true,",
						"     upsertable:true,",
						"     keys:['customer_register','customer_ag_id'],",
						"     format: 'table',",
						"     batchSize: 5000,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> agCustomerDWH",
						"AlterTradeShopTable sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:true,",
						"     upsertable:true,",
						"     keys:['trade_shop_ag_id','trade_shop_id_check'],",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> agTradeShopDWH"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/ADLS_Filtered_CSV')]",
				"[concat(variables('factoryId'), '/datasets/Dwh_Sql')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AG_Customer_Raw_to_Filtered')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "AG"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "ADLS_Raw_CSV",
								"type": "DatasetReference"
							},
							"name": "agRawFullCustomerCSV"
						},
						{
							"dataset": {
								"referenceName": "ADLS_Raw_CSV",
								"type": "DatasetReference"
							},
							"name": "agRawTradeShopGpsCSV"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "ADLS_Filtered_CSV",
								"type": "DatasetReference"
							},
							"name": "agFilteredCSV"
						}
					],
					"transformations": [
						{
							"name": "TradeShopIDLeftJoin"
						},
						{
							"name": "ColumnFiltering",
							"description": "Renaming and (removing) TradeShopIDLeftJoin to ColumnFiltering with columns"
						}
					],
					"scriptLines": [
						"source(output(",
						"          CusID as integer,",
						"          CusName as string,",
						"          cusAddress as string,",
						"          ISISChannelID as integer,",
						"          OwnerID as integer,",
						"          OwnerName as string,",
						"          INN as string,",
						"          TradeShopID as integer,",
						"          StoreTypeName as string,",
						"          Phone as string,",
						"          CreateDate as string,",
						"          UpdateDate as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false,",
						"     partitionBy('hash', 1)) ~> agRawFullCustomerCSV",
						"source(output(",
						"          TradeshopID as integer,",
						"          CreatedDate as string,",
						"          UpdatedDate as string,",
						"          UID as string,",
						"          Longitude as string,",
						"          Latitude as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false,",
						"     partitionBy('hash', 1)) ~> agRawTradeShopGpsCSV",
						"agRawFullCustomerCSV, agRawTradeShopGpsCSV join(agRawFullCustomerCSV@TradeShopID == agRawTradeShopGpsCSV@TradeshopID,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'off')~> TradeShopIDLeftJoin",
						"TradeShopIDLeftJoin select(mapColumn(",
						"          cusid_ag = CusID,",
						"          trade_shop_name = CusName,",
						"          full_address = cusAddress,",
						"          isis_channel_id = ISISChannelID,",
						"          customer_ag_id = OwnerID,",
						"          customer_name = OwnerName,",
						"          customer_register = INN,",
						"          trade_shop_ag_id = agRawFullCustomerCSV@TradeShopID,",
						"          store_type_name = StoreTypeName,",
						"          phone_number = Phone,",
						"          customer_created_date = CreateDate,",
						"          longitude = Longitude,",
						"          latitude = Latitude",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> ColumnFiltering",
						"ColumnFiltering sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     partitionFileNames:['ag_dwh_customer_full.csv'],",
						"     umask: 0775,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     partitionBy('hash', 1)) ~> agFilteredCSV"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/ADLS_Raw_CSV')]",
				"[concat(variables('factoryId'), '/datasets/ADLS_Filtered_CSV')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AG_IdMaster_Update_CustomerId')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "AG"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "DataService_TestMerchant",
								"type": "DatasetReference"
							},
							"name": "tradeshopAgInfoTable"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "DataService_TestMerchant",
								"type": "DatasetReference"
							},
							"name": "updateAgCustomerInIdMaster"
						}
					],
					"transformations": [
						{
							"name": "groupByTradeShopId"
						},
						{
							"name": "updateExistingData"
						},
						{
							"name": "select1"
						}
					],
					"scriptLines": [
						"source(output(",
						"          customer_ag_id as integer,",
						"          customer_register as string,",
						"          tradeshop_id_gps as integer",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     query: 'Select \\n    customer_ag_id,\\n    customer_register,\\n    tradeshop_id_gps\\nfrom trade_shop_ag_info',",
						"     format: 'query') ~> tradeshopAgInfoTable",
						"tradeshopAgInfoTable aggregate(groupBy(customer_register,",
						"          tradeshop_id_gps),",
						"     customer_ag_id = max(customer_ag_id)) ~> groupByTradeShopId",
						"select1 alterRow(updateIf(true())) ~> updateExistingData",
						"groupByTradeShopId select(mapColumn(",
						"          customer_register,",
						"          trade_shop_ag_id = tradeshop_id_gps,",
						"          customer_ag_id",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> select1",
						"updateExistingData sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:true,",
						"     upsertable:false,",
						"     keys:['trade_shop_ag_id'],",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> updateAgCustomerInIdMaster"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/DataService_TestMerchant')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AG_TradeShop_DWH_to_DataService')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "AG"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "DWH_Mysql",
								"type": "DatasetReference"
							},
							"name": "agDwhTradeShopTable"
						},
						{
							"dataset": {
								"referenceName": "DataService_TestMerchant",
								"type": "DatasetReference"
							},
							"name": "addressFromDataServiceTable"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "DataService_TestMerchant",
								"type": "DatasetReference"
							},
							"name": "saveToDataServiceDB"
						}
					],
					"transformations": [
						{
							"name": "selectRequiredFields",
							"description": "Data Service-iin customer_ag_info table-d hadgalj boloh medeelluudiig gargan avah process"
						},
						{
							"name": "locationInfoProcessing"
						},
						{
							"name": "separateAddressByLevel",
							"description": "loc_name-g aimag_hot, duureg_sum, bag_khoroo gesen hesguuded huvaana"
						},
						{
							"name": "makeAddressList",
							"description": "aimag_hot, duureg_sum, bag_khoroo tus buriinh ni huvid list uusgene, uuniig ashiglan customer datanaas haygiin medeelel gargan avna"
						},
						{
							"name": "customerWithLocationList"
						},
						{
							"name": "locationCapturing",
							"description": "aimag_hot, duureg_sum, bag_khoroo-nii medeelliig dataservice-iin DB deerh location table-tai matchlaad taarch bgaag ni ylgaj avna"
						},
						{
							"name": "selectFieldForDB"
						},
						{
							"name": "additionalFixOnLocation",
							"description": "capitalize\nUlaanbaatriinh bish bol bag_khoroo-nii medeelliig hasah"
						},
						{
							"name": "addressFixDistrictCityAbbr1",
							"description": "  => ,   geh meteer haygiig tovchilj bichsen bgaag zasah"
						},
						{
							"name": "addressFixDistrictAbbr1",
							"description": " => ,   geh meteer haygiig tovchilj bichsen bgaag zasah"
						},
						{
							"name": "AlterRow1"
						}
					],
					"scriptLines": [
						"source(output(",
						"          id as integer,",
						"          trade_shop_ag_id as integer,",
						"          is_reliable_trade_shop_ag_id as integer,",
						"          trade_shop_name as string,",
						"          customer_ag_id as integer,",
						"          full_address as string,",
						"          longitude as double,",
						"          latitude as double,",
						"          phone_number as string,",
						"          isis_channel_id as integer,",
						"          trade_shop_id_check as string,",
						"          is_reliable_trade_shop_id_check as integer,",
						"          store_type_name as string,",
						"          trade_shop_created_date as timestamp,",
						"          created_at as timestamp,",
						"          updated_at as timestamp,",
						"          customer_register as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> agDwhTradeShopTable",
						"source(output(",
						"          id as integer,",
						"          loc_name as string,",
						"          full_address as string,",
						"          lvl as integer,",
						"          eb_id as string,",
						"          parent_id as integer",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> addressFromDataServiceTable",
						"agDwhTradeShopTable select(mapColumn(",
						"          trade_shop_ag_id,",
						"          customer_ag_id,",
						"          trade_shop_name,",
						"          tradeshop_id_gps = trade_shop_id_check,",
						"          full_address,",
						"          longitude,",
						"          latitude,",
						"          e_group_name = store_type_name,",
						"          operation_start_date = trade_shop_created_date,",
						"          trade_shop_created_date,",
						"          customer_register",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> selectRequiredFields",
						"addressFixDistrictAbbr1 derive(aimag_hot = iif(isNull(at(split(fixed_address, ','), 3)), toString(null()), at(split(fixed_address, ','), 1)),",
						"          duureg_sum = iif(isNull(at(split(fixed_address, ','), 3)), toString(null()), at(split(fixed_address, ','), 2)),",
						"          bag_khoroo = iif(isNull(at(split(fixed_address, ','), 3)), toString(null()), at(split(fixed_address, ','), 3)),",
						"          join_col = 1) ~> locationInfoProcessing",
						"addressFromDataServiceTable derive(aimag_hot_list = iif(lvl == 1, lower(loc_name), toString(null())),",
						"          duureg_sum_list = iif(lvl == 2, lower(loc_name), toString(null())),",
						"          bag_khoroo_list = iif(lvl == 3, lower(loc_name), toString(null())),",
						"          join_col = 1) ~> separateAddressByLevel",
						"separateAddressByLevel aggregate(aimag_hot_list = collectUnique(aimag_hot_list),",
						"          duureg_sum_list = collectUnique(duureg_sum_list),",
						"          bag_khoroo_list = collectUnique(bag_khoroo_list),",
						"          join_col = max(join_col)) ~> makeAddressList",
						"locationInfoProcessing, makeAddressList join(locationInfoProcessing@join_col == makeAddressList@join_col,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> customerWithLocationList",
						"customerWithLocationList derive(aimag_hot = toString(at(intersect(split(lower(aimag_hot), ' '), aimag_hot_list), 1)),",
						"          duureg_sum = toString(at(intersect(split(lower(duureg_sum), ' '), duureg_sum_list), 1)),",
						"          bag_khoroo = iif(\r",
						"    instr(bag_khoroo, '-  ') != 0,\r",
						"    toInteger(at(split(bag_khoroo, '-  '), 1)), \r",
						"    iif(\r",
						"        instr(bag_khoroo, '- ,') != 0,\r",
						"        toInteger(at(split(bag_khoroo, '- ,'), 1)),\r",
						"        iif(\r",
						"            instr(bag_khoroo, ' ') != 0,\r",
						"            toInteger(at(split(bag_khoroo, ' '), 1)),\r",
						"            toInteger(null())\r",
						"        )\r",
						"    )\r",
						")) ~> locationCapturing",
						"locationCapturing select(mapColumn(",
						"          trade_shop_ag_id,",
						"          customer_ag_id,",
						"          customer_register,",
						"          trade_shop_name,",
						"          tradeshop_id_gps,",
						"          aimag_hot,",
						"          duureg_sum,",
						"          bag_khoroo,",
						"          full_address,",
						"          longitude,",
						"          latitude,",
						"          e_group_name,",
						"          operation_start_date,",
						"          trade_shop_created_date = operation_start_date",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> selectFieldForDB",
						"selectFieldForDB derive(aimag_hot = replace(initCap(replace(aimag_hot, '-', ' ')), ' ', '-'),",
						"          duureg_sum = replace(initCap(replace(duureg_sum, '-', ' ')), ' ', '-'),",
						"          bag_khoroo = iif(aimag_hot =='', bag_khoroo, toInteger(null())),",
						"          trade_shop_created_date = operation_start_date) ~> additionalFixOnLocation",
						"selectRequiredFields derive(fixed_address = replace(\r",
						"    replace(\r",
						"        replace(\r",
						"            replace(\r",
						"                replace(\r",
						"                    replace(\r",
						"                        replace(\r",
						"                            replace(\r",
						"                                replace(\r",
						"                                    lower(full_address), ' ', ',  ,'\r",
						"                                ), ' ', ',  ,'\r",
						"                            ), ' ', ',  ,'\r",
						"                        ), ' ', ',  ,'\r",
						"                    ), ' ', ',  ,'\r",
						"                ), ' ', ',  ,'\r",
						"            ), ' ', ', - ,'\r",
						"        ), ' ', ',  ,'\r",
						"    ), ' ', ',  ,'\r",
						")) ~> addressFixDistrictCityAbbr1",
						"addressFixDistrictCityAbbr1 derive(fixed_address = replace(\r",
						"    replace(\r",
						"        replace(\r",
						"            replace(\r",
						"                replace(\r",
						"                    replace(\r",
						"                        fixed_address, ' ', ',  ,'\r",
						"                    ), '', ',  ,'\r",
						"                ), '', ',  ,'\r",
						"            ), ' ', ', - ,'\r",
						"        ), '', ',  ,'\r",
						"    ), '', ',  ,'\r",
						")) ~> addressFixDistrictAbbr1",
						"additionalFixOnLocation alterRow(upsertIf(true())) ~> AlterRow1",
						"AlterRow1 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:true,",
						"     upsertable:true,",
						"     keys:['trade_shop_ag_id','tradeshop_id_gps'],",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> saveToDataServiceDB"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/DWH_Mysql')]",
				"[concat(variables('factoryId'), '/datasets/DataService_TestMerchant')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AG_TradeShop_DWH_to_DataService_SQL')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "AG"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "Dwh_Sql",
								"type": "DatasetReference"
							},
							"name": "agDwhTradeShopTable"
						},
						{
							"dataset": {
								"referenceName": "DataService_TestMerchant",
								"type": "DatasetReference"
							},
							"name": "addressFromDataServiceTable"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "DataService_TestMerchant",
								"type": "DatasetReference"
							},
							"name": "saveToDataServiceDB"
						}
					],
					"transformations": [
						{
							"name": "selectRequiredFields",
							"description": "Data Service-iin customer_ag_info table-d hadgalj boloh medeelluudiig gargan avah process"
						},
						{
							"name": "locationInfoProcessing"
						},
						{
							"name": "separateAddressByLevel",
							"description": "loc_name-g aimag_hot, duureg_sum, bag_khoroo gesen hesguuded huvaana"
						},
						{
							"name": "makeAddressList",
							"description": "aimag_hot, duureg_sum, bag_khoroo tus buriinh ni huvid list uusgene, uuniig ashiglan customer datanaas haygiin medeelel gargan avna"
						},
						{
							"name": "customerWithLocationList"
						},
						{
							"name": "locationCapturing",
							"description": "aimag_hot, duureg_sum, bag_khoroo-nii medeelliig dataservice-iin DB deerh location table-tai matchlaad taarch bgaag ni ylgaj avna"
						},
						{
							"name": "selectFieldForDB"
						},
						{
							"name": "additionalFixOnLocation",
							"description": "capitalize\nUlaanbaatriinh bish bol bag_khoroo-nii medeelliig hasah"
						},
						{
							"name": "addressFixDistrictCityAbbr1",
							"description": "  => ,   geh meteer haygiig tovchilj bichsen bgaag zasah"
						},
						{
							"name": "addressFixDistrictAbbr1",
							"description": " => ,   geh meteer haygiig tovchilj bichsen bgaag zasah"
						},
						{
							"name": "AlterRow1"
						}
					],
					"scriptLines": [
						"source(output(",
						"          id as integer,",
						"          trade_shop_ag_id as integer,",
						"          is_reliable_trade_shop_ag_id as boolean,",
						"          trade_shop_name as string,",
						"          customer_ag_id as integer,",
						"          full_address as string,",
						"          longitude as double,",
						"          latitude as double,",
						"          phone_number as string,",
						"          isis_channel_id as integer,",
						"          trade_shop_id_check as string,",
						"          is_reliable_trade_shop_id_check as boolean,",
						"          store_type_name as string,",
						"          trade_shop_created_date as timestamp,",
						"          created_at as timestamp,",
						"          updated_at as timestamp,",
						"          customer_register as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> agDwhTradeShopTable",
						"source(output(",
						"          id as integer,",
						"          loc_name as string,",
						"          full_address as string,",
						"          lvl as integer,",
						"          eb_id as string,",
						"          parent_id as integer",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> addressFromDataServiceTable",
						"agDwhTradeShopTable select(mapColumn(",
						"          trade_shop_ag_id,",
						"          customer_ag_id,",
						"          trade_shop_name,",
						"          tradeshop_id_gps = trade_shop_id_check,",
						"          full_address,",
						"          longitude,",
						"          latitude,",
						"          e_group_name = store_type_name,",
						"          operation_start_date = trade_shop_created_date,",
						"          trade_shop_created_date,",
						"          customer_register",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> selectRequiredFields",
						"addressFixDistrictAbbr1 derive(aimag_hot = iif(isNull(at(split(fixed_address, ','), 3)), toString(null()), at(split(fixed_address, ','), 1)),",
						"          duureg_sum = iif(isNull(at(split(fixed_address, ','), 3)), toString(null()), at(split(fixed_address, ','), 2)),",
						"          bag_khoroo = iif(isNull(at(split(fixed_address, ','), 3)), toString(null()), at(split(fixed_address, ','), 3)),",
						"          join_col = 1) ~> locationInfoProcessing",
						"addressFromDataServiceTable derive(aimag_hot_list = iif(lvl == 1, lower(loc_name), toString(null())),",
						"          duureg_sum_list = iif(lvl == 2, lower(loc_name), toString(null())),",
						"          bag_khoroo_list = iif(lvl == 3, lower(loc_name), toString(null())),",
						"          join_col = 1) ~> separateAddressByLevel",
						"separateAddressByLevel aggregate(aimag_hot_list = collectUnique(aimag_hot_list),",
						"          duureg_sum_list = collectUnique(duureg_sum_list),",
						"          bag_khoroo_list = collectUnique(bag_khoroo_list),",
						"          join_col = max(join_col)) ~> makeAddressList",
						"locationInfoProcessing, makeAddressList join(locationInfoProcessing@join_col == makeAddressList@join_col,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> customerWithLocationList",
						"customerWithLocationList derive(aimag_hot = toString(at(intersect(split(lower(aimag_hot), ' '), aimag_hot_list), 1)),",
						"          duureg_sum = toString(at(intersect(split(lower(duureg_sum), ' '), duureg_sum_list), 1)),",
						"          bag_khoroo = iif(\r",
						"    instr(bag_khoroo, '-  ') != 0,\r",
						"    toInteger(at(split(bag_khoroo, '-  '), 1)), \r",
						"    iif(\r",
						"        instr(bag_khoroo, '- ,') != 0,\r",
						"        toInteger(at(split(bag_khoroo, '- ,'), 1)),\r",
						"        iif(\r",
						"            instr(bag_khoroo, ' ') != 0,\r",
						"            toInteger(at(split(bag_khoroo, ' '), 1)),\r",
						"            toInteger(null())\r",
						"        )\r",
						"    )\r",
						")) ~> locationCapturing",
						"locationCapturing select(mapColumn(",
						"          trade_shop_ag_id,",
						"          customer_ag_id,",
						"          customer_register,",
						"          trade_shop_name,",
						"          tradeshop_id_gps,",
						"          aimag_hot,",
						"          duureg_sum,",
						"          bag_khoroo,",
						"          full_address,",
						"          longitude,",
						"          latitude,",
						"          e_group_name,",
						"          operation_start_date,",
						"          trade_shop_created_date = operation_start_date",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> selectFieldForDB",
						"selectFieldForDB derive(aimag_hot = replace(initCap(replace(aimag_hot, '-', ' ')), ' ', '-'),",
						"          duureg_sum = replace(initCap(replace(duureg_sum, '-', ' ')), ' ', '-'),",
						"          bag_khoroo = iif(aimag_hot =='', bag_khoroo, toInteger(null())),",
						"          trade_shop_created_date = operation_start_date) ~> additionalFixOnLocation",
						"selectRequiredFields derive(fixed_address = replace(\r",
						"    replace(\r",
						"        replace(\r",
						"            replace(\r",
						"                replace(\r",
						"                    replace(\r",
						"                        replace(\r",
						"                            replace(\r",
						"                                replace(\r",
						"                                    lower(full_address), ' ', ',  ,'\r",
						"                                ), ' ', ',  ,'\r",
						"                            ), ' ', ',  ,'\r",
						"                        ), ' ', ',  ,'\r",
						"                    ), ' ', ',  ,'\r",
						"                ), ' ', ',  ,'\r",
						"            ), ' ', ', - ,'\r",
						"        ), ' ', ',  ,'\r",
						"    ), ' ', ',  ,'\r",
						")) ~> addressFixDistrictCityAbbr1",
						"addressFixDistrictCityAbbr1 derive(fixed_address = replace(\r",
						"    replace(\r",
						"        replace(\r",
						"            replace(\r",
						"                replace(\r",
						"                    replace(\r",
						"                        fixed_address, ' ', ',  ,'\r",
						"                    ), '', ',  ,'\r",
						"                ), '', ',  ,'\r",
						"            ), ' ', ', - ,'\r",
						"        ), '', ',  ,'\r",
						"    ), '', ',  ,'\r",
						")) ~> addressFixDistrictAbbr1",
						"additionalFixOnLocation alterRow(upsertIf(true())) ~> AlterRow1",
						"AlterRow1 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:true,",
						"     upsertable:true,",
						"     keys:['trade_shop_ag_id','tradeshop_id_gps'],",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> saveToDataServiceDB"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/Dwh_Sql')]",
				"[concat(variables('factoryId'), '/datasets/DataService_TestMerchant')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/CC_Customer_DWH_to_DataService')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "CC"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "DWH_Mysql",
								"type": "DatasetReference"
							},
							"name": "ccDwhCustomerTable"
						},
						{
							"dataset": {
								"referenceName": "DataService_TestMerchant",
								"type": "DatasetReference"
							},
							"name": "addressFromDataServiceTable"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "DataService_TestMerchant",
								"type": "DatasetReference"
							},
							"name": "saveToDataServiceDB"
						}
					],
					"transformations": [
						{
							"name": "selectRequiredFields",
							"description": "Data Service-iin customer_ag_info table-d hadgalj boloh medeelluudiig gargan avah process"
						},
						{
							"name": "locationInfoProcessing"
						},
						{
							"name": "separateAddressByLevel",
							"description": "loc_name-g aimag_hot, duureg_sum, bag_khoroo gesen hesguuded huvaana"
						},
						{
							"name": "makeAddressList",
							"description": "aimag_hot, duureg_sum, bag_khoroo tus buriinh ni huvid list uusgene, uuniig ashiglan customer datanaas haygiin medeelel gargan avna"
						},
						{
							"name": "customerWithLocationList"
						},
						{
							"name": "locationCapturing",
							"description": "aimag_hot, duureg_sum, bag_khoroo-nii medeelliig dataservice-iin DB deerh location table-tai matchlaad taarch bgaag ni ylgaj avna"
						},
						{
							"name": "selectFieldForDB"
						},
						{
							"name": "additionalFixOnLocation",
							"description": "capitalize\nUlaanbaatriinh bish bol bag_khoroo-nii medeelliig hasah"
						},
						{
							"name": "addressFixDistrictCityAbbr1",
							"description": "  => ,   geh meteer haygiig tovchilj bichsen bgaag zasah"
						},
						{
							"name": "addressFixDistrictAbbr1",
							"description": " => ,   geh meteer haygiig tovchilj bichsen bgaag zasah"
						},
						{
							"name": "AlterRow1"
						},
						{
							"name": "removeNullCustomersCCID"
						}
					],
					"scriptLines": [
						"source(output(",
						"          id as integer,",
						"          customer_cc_id as integer,",
						"          customer_register as string,",
						"          is_reliable_register as integer,",
						"          customer_name as string,",
						"          full_address as string,",
						"          golden_flag as string,",
						"          register_type as integer,",
						"          phone_number as string,",
						"          customer_created_date as timestamp,",
						"          created_at as timestamp,",
						"          updated_at as timestamp",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> ccDwhCustomerTable",
						"source(output(",
						"          id as integer,",
						"          loc_name as string,",
						"          full_address as string,",
						"          lvl as integer,",
						"          eb_id as string,",
						"          parent_id as integer",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> addressFromDataServiceTable",
						"ccDwhCustomerTable select(mapColumn(",
						"          customer_cc_id,",
						"          customer_name,",
						"          full_address,",
						"          customer_register,",
						"          register_type,",
						"          phone_number,",
						"          customer_created_date",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> selectRequiredFields",
						"addressFixDistrictAbbr1 derive(aimag_hot = iif(isNull(at(split(fixed_address, ','), 3)), toString(null()), at(split(fixed_address, ','), 1)),",
						"          duureg_sum = iif(isNull(at(split(fixed_address, ','), 3)), toString(null()), at(split(fixed_address, ','), 2)),",
						"          bag_khoroo = iif(isNull(at(split(fixed_address, ','), 3)), toString(null()), at(split(fixed_address, ','), 3)),",
						"          join_col = 1) ~> locationInfoProcessing",
						"addressFromDataServiceTable derive(aimag_hot_list = iif(lvl == 1, lower(loc_name), toString(null())),",
						"          duureg_sum_list = iif(lvl == 2, lower(loc_name), toString(null())),",
						"          bag_khoroo_list = iif(lvl == 3, lower(loc_name), toString(null())),",
						"          join_col = 1) ~> separateAddressByLevel",
						"separateAddressByLevel aggregate(aimag_hot_list = collectUnique(aimag_hot_list),",
						"          duureg_sum_list = collectUnique(duureg_sum_list),",
						"          bag_khoroo_list = collectUnique(bag_khoroo_list),",
						"          join_col = max(join_col)) ~> makeAddressList",
						"locationInfoProcessing, makeAddressList join(locationInfoProcessing@join_col == makeAddressList@join_col,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> customerWithLocationList",
						"customerWithLocationList derive(aimag_hot = toString(at(intersect(split(lower(aimag_hot), ' '), aimag_hot_list), 1)),",
						"          duureg_sum = toString(at(intersect(split(lower(duureg_sum), ' '), duureg_sum_list), 1)),",
						"          bag_khoroo = iif(\r",
						"    instr(bag_khoroo, '-  ') != 0,\r",
						"    toInteger(at(split(bag_khoroo, '-  '), 1)), \r",
						"    iif(\r",
						"        instr(bag_khoroo, '- ,') != 0,\r",
						"        toInteger(at(split(bag_khoroo, '- ,'), 1)),\r",
						"        iif(\r",
						"            instr(bag_khoroo, ' ') != 0,\r",
						"            toInteger(at(split(bag_khoroo, ' '), 1)),\r",
						"            iif(isInteger(bag_khoroo), toInteger(bag_khoroo), toInteger(null()))\r",
						"        )\r",
						"    )\r",
						")) ~> locationCapturing",
						"locationCapturing select(mapColumn(",
						"          customer_cc_id,",
						"          customer_name,",
						"          full_address,",
						"          customer_register,",
						"          register_type,",
						"          phone_number,",
						"          customer_created_date,",
						"          aimag_hot,",
						"          duureg_sum,",
						"          bag_khoroo",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> selectFieldForDB",
						"selectFieldForDB derive(aimag_hot = replace(initCap(replace(aimag_hot, '-', ' ')), ' ', '-'),",
						"          duureg_sum = replace(initCap(replace(duureg_sum, '-', ' ')), ' ', '-'),",
						"          bag_khoroo = iif(aimag_hot =='', bag_khoroo, toInteger(null()))) ~> additionalFixOnLocation",
						"selectRequiredFields derive(fixed_address = replace(\r",
						"    replace(\r",
						"        replace(\r",
						"            replace(\r",
						"                replace(\r",
						"                    replace(\r",
						"                        replace(\r",
						"                            replace(\r",
						"                                replace(\r",
						"                                    lower(full_address), ' ', ',  ,'\r",
						"                                ), ' ', ',  ,'\r",
						"                            ), ' ', ',  ,'\r",
						"                        ), ' ', ',  ,'\r",
						"                    ), ' ', ',  ,'\r",
						"                ), ' ', ',  ,'\r",
						"            ), ' ', ', - ,'\r",
						"        ), ' ', ',  ,'\r",
						"    ), ' ', ',  ,'\r",
						")) ~> addressFixDistrictCityAbbr1",
						"addressFixDistrictCityAbbr1 derive(fixed_address = replace(\r",
						"    replace(\r",
						"        replace(\r",
						"            replace(\r",
						"                replace(\r",
						"                    replace(\r",
						"                        fixed_address, ' ', ',  ,'\r",
						"                    ), '', ',  ,'\r",
						"                ), '', ',  ,'\r",
						"            ), ' ', ', - ,'\r",
						"        ), '', ',  ,'\r",
						"    ), '', ',  ,'\r",
						")) ~> addressFixDistrictAbbr1",
						"removeNullCustomersCCID alterRow(upsertIf(true())) ~> AlterRow1",
						"additionalFixOnLocation filter(!isNull(customer_cc_id)) ~> removeNullCustomersCCID",
						"AlterRow1 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:true,",
						"     upsertable:true,",
						"     keys:['customer_register','customer_cc_id'],",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> saveToDataServiceDB"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/DWH_Mysql')]",
				"[concat(variables('factoryId'), '/datasets/DataService_TestMerchant')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/CC_Customer_Filtered_to_DWH')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "CC"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "ADLS_Filtered_CSV",
								"type": "DatasetReference"
							},
							"name": "ccCustomerFiltered",
							"description": "ADLS deerh fmcg-filtered container-ees cc_dwh_filtered/cc_dwh_customer_full.csv datag avah process. Ene ni customer datag aguulsan bga"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "DWH_Mysql",
								"type": "DatasetReference"
							},
							"name": "ccCustomerDWH"
						},
						{
							"dataset": {
								"referenceName": "DWH_Mysql",
								"type": "DatasetReference"
							},
							"name": "ccTradeShopDWH"
						}
					],
					"transformations": [
						{
							"name": "CustomerTable",
							"description": "customer_register (INN), customer_cc_id(OwnerID)-aar groupleed uldsen medeelluudiig aggregate hiigeed customer table gargaj avna."
						},
						{
							"name": "AlterCustomerTable",
							"description": "Database ruu upsert hiih bolomjiig bii bolgoh"
						},
						{
							"name": "notNullCustomers",
							"description": "0 (null) registertei bas null owner_id-tai hariltsagchdiig ylgaj avah"
						},
						{
							"name": "CustomerInfoFix",
							"description": "Customer register ni null, esvel formataas zursun uyd tuuniig '0' bolgoh, format ni 7 orontoi too esvel hunii RD bh ystoi"
						},
						{
							"name": "TradeShopTable",
							"description": "niit medeellees tradeshop-iin medeelel gargan avch DWH ruu hadgalah"
						},
						{
							"name": "FilterOutUnknownTradeshops"
						},
						{
							"name": "TradeshopFix",
							"description": "trade_shop_cc_id (cusid)-n utga null bgaa tohioldold nuguuguur ni nuhuh, esvel 0-eer nuhnu"
						},
						{
							"name": "GroupByTradeshop",
							"description": "Tradeshop datagaa trade_shop_cc_id columnaar grouplej davhardliig arilgana"
						},
						{
							"name": "AlterTradeShopTable"
						}
					],
					"scriptLines": [
						"source(output(",
						"          cusid_cc as integer,",
						"          trade_shop_name as string,",
						"          full_address as string,",
						"          customer_cc_id as integer,",
						"          customer_name as string,",
						"          golden_flag as string,",
						"          store_type as string,",
						"          customer_register as string,",
						"          phone_number as string,",
						"          buying_power as string,",
						"          location_segment as short,",
						"          channel as string,",
						"          sub_channel as string,",
						"          sales_team as string,",
						"          delivery_area as string,",
						"          channel_id as integer,",
						"          district as string,",
						"          khoroo as short,",
						"          customer_created_date as string,",
						"          longitude as double,",
						"          latitude as double",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false) ~> ccCustomerFiltered",
						"notNullCustomers@notNullCustomers aggregate(groupBy(customer_register,",
						"          customer_cc_id),",
						"     customer_name = iifNull(min(customer_name), min(trade_shop_name)),",
						"          full_address = min(full_address),",
						"          is_reliable_register = iif(min(customer_register) == '0', 0, 1),",
						"          golden_flag = max(golden_flag),",
						"          register_type = iif(regexMatch(min(customer_register),  `^\\d+$`), 1,  0),",
						"          phone_number = max(phone_number),",
						"          customer_created_date = min(customer_created_date)) ~> CustomerTable",
						"CustomerTable alterRow(upsertIf(true())) ~> AlterCustomerTable",
						"CustomerInfoFix split(!and(customer_register == '0', isNull(customer_cc_id)),",
						"     disjoint: false) ~> notNullCustomers@(notNullCustomers, nullCustomers)",
						"ccCustomerFiltered derive(customer_register = trim(iif(length(customer_register) <= 6, '0', iifNull(customer_register, '0'))),",
						"          register_fixed = iif(length(customer_register) <= 6, 1, iif(customer_register == '1000000', 1, 0))) ~> CustomerInfoFix",
						"CustomerInfoFix select(mapColumn(",
						"          trade_shop_cc_id = cusid_cc,",
						"          trade_shop_name,",
						"          customer_cc_id,",
						"          customer_register,",
						"          full_address,",
						"          longitude,",
						"          latitude,",
						"          phone_number,",
						"          location_segment,",
						"          e_group_name = channel,",
						"          store_type,",
						"          buying_power,",
						"          sub_channel,",
						"          sales_team,",
						"          delivery_area,",
						"          channel_id,",
						"          district_subcity = district,",
						"          sub_district_block = khoroo,",
						"          trade_shop_created_date = customer_created_date",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> TradeShopTable",
						"TradeShopTable filter(!isNull(trade_shop_cc_id)) ~> FilterOutUnknownTradeshops",
						"FilterOutUnknownTradeshops derive(trade_shop_cc_id = iifNull(trade_shop_cc_id, 0),",
						"          is_reliable_trade_shop_cc_id = iif(isNull(trade_shop_cc_id), 0, 1)) ~> TradeshopFix",
						"TradeshopFix aggregate(groupBy(trade_shop_cc_id),",
						"     trade_shop_name = max(trade_shop_name),",
						"          is_reliable_trade_shop_ag_id = max(is_reliable_trade_shop_cc_id),",
						"          full_address = max(full_address),",
						"          longitude = first(longitude),",
						"          latitude = first(latitude),",
						"          phone_number = max(phone_number),",
						"          store_type = max(store_type),",
						"          trade_shop_created_date = min(trade_shop_created_date),",
						"          customer_register = max(customer_register),",
						"          customer_cc_id = max(customer_cc_id),",
						"          location_segment = max(location_segment),",
						"          e_group_name = max(e_group_name),",
						"          buying_power = max(buying_power),",
						"          sub_channel = max(sub_channel),",
						"          sales_team = max(sales_team),",
						"          delivery_area = max(delivery_area),",
						"          channel_id = max(channel_id),",
						"          district_subcity = max(district_subcity),",
						"          sub_district_block = max(sub_district_block)) ~> GroupByTradeshop",
						"GroupByTradeshop alterRow(upsertIf(true())) ~> AlterTradeShopTable",
						"AlterCustomerTable sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:true,",
						"     upsertable:true,",
						"     keys:['customer_register','customer_cc_id'],",
						"     format: 'table',",
						"     batchSize: 5000,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> ccCustomerDWH",
						"AlterTradeShopTable sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:true,",
						"     upsertable:true,",
						"     keys:['trade_shop_cc_id'],",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> ccTradeShopDWH"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/ADLS_Filtered_CSV')]",
				"[concat(variables('factoryId'), '/datasets/DWH_Mysql')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/CC_Customer_Raw_to_Filtered')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "CC"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "ADLS_Raw_CSV",
								"type": "DatasetReference"
							},
							"name": "ccRawFullCustomerCSV"
						},
						{
							"dataset": {
								"referenceName": "ADLS_Raw_CSV",
								"type": "DatasetReference"
							},
							"name": "ccRawTradeShopGpsCSV"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "ADLS_Filtered_CSV",
								"type": "DatasetReference"
							},
							"name": "ccFilteredCSV"
						}
					],
					"transformations": [
						{
							"name": "TradeShopIDLeftJoin"
						},
						{
							"name": "ColumnFiltering",
							"description": "Renaming and (removing) TradeShopIDLeftJoin to ColumnFiltering with columns"
						}
					],
					"scriptLines": [
						"source(output(",
						"          CUSID as integer,",
						"          CusName as string,",
						"          CusAddress as string,",
						"          OwnerID as integer,",
						"          OwnerName as string,",
						"          GoldenFlag as string,",
						"          StoreType as string,",
						"          INN as string,",
						"          Phone as string,",
						"          BuyingPower as string,",
						"          LocationSegment as integer,",
						"          Channel as string,",
						"          Image as string,",
						"          SubChannel as string,",
						"          SalesTeam as string,",
						"          DeliveryArea as string,",
						"          ChannelID as integer,",
						"          District as string,",
						"          Khoroo as short,",
						"          CreateDate as string,",
						"          UpdateDate as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false,",
						"     partitionBy('hash', 1)) ~> ccRawFullCustomerCSV",
						"source(output(",
						"          TradeshopID as integer,",
						"          CreatedDate as string,",
						"          UpdatedDate as string,",
						"          UID as string,",
						"          Longitude as double,",
						"          Latitude as double",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false,",
						"     partitionBy('hash', 1)) ~> ccRawTradeShopGpsCSV",
						"ccRawFullCustomerCSV, ccRawTradeShopGpsCSV join(CUSID == TradeshopID,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'off')~> TradeShopIDLeftJoin",
						"TradeShopIDLeftJoin select(mapColumn(",
						"          cusid_cc = CUSID,",
						"          trade_shop_name = CusName,",
						"          full_address = CusAddress,",
						"          customer_cc_id = OwnerID,",
						"          customer_name = OwnerName,",
						"          golden_flag = GoldenFlag,",
						"          store_type = StoreType,",
						"          customer_register = INN,",
						"          phone_number = Phone,",
						"          buying_power = BuyingPower,",
						"          location_segment = LocationSegment,",
						"          channel = Channel,",
						"          sub_channel = SubChannel,",
						"          sales_team = SalesTeam,",
						"          delivery_area = DeliveryArea,",
						"          channel_id = ChannelID,",
						"          district = District,",
						"          khoroo = Khoroo,",
						"          customer_created_date = CreateDate,",
						"          longitude = Longitude,",
						"          latitude = Latitude",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> ColumnFiltering",
						"ColumnFiltering sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     partitionFileNames:['cc_dwh_customer_full.csv'],",
						"     umask: 0775,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     partitionBy('hash', 1)) ~> ccFilteredCSV"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/ADLS_Raw_CSV')]",
				"[concat(variables('factoryId'), '/datasets/ADLS_Filtered_CSV')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/CC_TradeShop_DWH_to_DataService')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "CC"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "DWH_Mysql",
								"type": "DatasetReference"
							},
							"name": "ccDwhTradeShopTable"
						},
						{
							"dataset": {
								"referenceName": "DataService_TestMerchant",
								"type": "DatasetReference"
							},
							"name": "addressFromDataServiceTable"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "DataService_TestMerchant",
								"type": "DatasetReference"
							},
							"name": "saveToMerchantDB"
						}
					],
					"transformations": [
						{
							"name": "selectRequiredFields",
							"description": "Data Service-iin customer_ag_info table-d hadgalj boloh medeelluudiig gargan avah process"
						},
						{
							"name": "locationInfoProcessing"
						},
						{
							"name": "separateAddressByLevel",
							"description": "loc_name-g aimag_hot, duureg_sum, bag_khoroo gesen hesguuded huvaana"
						},
						{
							"name": "makeAddressList",
							"description": "aimag_hot, duureg_sum, bag_khoroo tus buriinh ni huvid list uusgene, uuniig ashiglan customer datanaas haygiin medeelel gargan avna"
						},
						{
							"name": "customerWithLocationList"
						},
						{
							"name": "locationCapturing",
							"description": "aimag_hot, duureg_sum, bag_khoroo-nii medeelliig dataservice-iin DB deerh location table-tai matchlaad taarch bgaag ni ylgaj avna"
						},
						{
							"name": "selectFieldForDB"
						},
						{
							"name": "additionalFixOnLocation",
							"description": "capitalize\nUlaanbaatriinh bish bol bag_khoroo-nii medeelliig hasah"
						},
						{
							"name": "addressFixDistrictCityAbbr1",
							"description": "  => ,   geh meteer haygiig tovchilj bichsen bgaag zasah"
						},
						{
							"name": "addressFixDistrictAbbr1",
							"description": " => ,   geh meteer haygiig tovchilj bichsen bgaag zasah"
						},
						{
							"name": "AlterRow1"
						}
					],
					"scriptLines": [
						"source(output(",
						"          id as integer,",
						"          trade_shop_cc_id as integer,",
						"          trade_shop_name as string,",
						"          is_reliable_trade_shop_cc_id as integer,",
						"          customer_cc_id as integer,",
						"          customer_register as string,",
						"          full_address as string,",
						"          longitude as double,",
						"          latitude as double,",
						"          phone_number as string,",
						"          location_segment as integer,",
						"          e_group_name as string,",
						"          store_type as string,",
						"          buying_power as string,",
						"          sub_channel as string,",
						"          sales_team as string,",
						"          delivery_area as string,",
						"          channel_id as integer,",
						"          province_city as string,",
						"          district_subcity as string,",
						"          sub_district_block as string,",
						"          trade_shop_created_date as timestamp,",
						"          created_at as timestamp,",
						"          updated_at as timestamp",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> ccDwhTradeShopTable",
						"source(output(",
						"          id as integer,",
						"          loc_name as string,",
						"          full_address as string,",
						"          lvl as integer,",
						"          eb_id as string,",
						"          parent_id as integer",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> addressFromDataServiceTable",
						"ccDwhTradeShopTable select(mapColumn(",
						"          trade_shop_cc_id,",
						"          customer_cc_id,",
						"          trade_shop_name,",
						"          full_address,",
						"          longitude,",
						"          latitude,",
						"          e_group_name,",
						"          operation_start_date = trade_shop_created_date,",
						"          trade_shop_created_date,",
						"          customer_register",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> selectRequiredFields",
						"addressFixDistrictAbbr1 derive(aimag_hot = iif(isNull(at(split(fixed_address, ','), 3)), toString(null()), at(split(fixed_address, ','), 1)),",
						"          duureg_sum = iif(isNull(at(split(fixed_address, ','), 3)), toString(null()), at(split(fixed_address, ','), 2)),",
						"          bag_khoroo = iif(isNull(at(split(fixed_address, ','), 3)), toString(null()), at(split(fixed_address, ','), 3)),",
						"          join_col = 1) ~> locationInfoProcessing",
						"addressFromDataServiceTable derive(aimag_hot_list = iif(lvl == 1, lower(loc_name), toString(null())),",
						"          duureg_sum_list = iif(lvl == 2, lower(loc_name), toString(null())),",
						"          bag_khoroo_list = iif(lvl == 3, lower(loc_name), toString(null())),",
						"          join_col = 1) ~> separateAddressByLevel",
						"separateAddressByLevel aggregate(aimag_hot_list = collectUnique(aimag_hot_list),",
						"          duureg_sum_list = collectUnique(duureg_sum_list),",
						"          bag_khoroo_list = collectUnique(bag_khoroo_list),",
						"          join_col = max(join_col)) ~> makeAddressList",
						"locationInfoProcessing, makeAddressList join(locationInfoProcessing@join_col == makeAddressList@join_col,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> customerWithLocationList",
						"customerWithLocationList derive(aimag_hot = toString(at(intersect(split(lower(aimag_hot), ' '), aimag_hot_list), 1)),",
						"          duureg_sum = toString(at(intersect(split(lower(duureg_sum), ' '), duureg_sum_list), 1)),",
						"          bag_khoroo = iif(\r",
						"    instr(bag_khoroo, '-  ') != 0,\r",
						"    toInteger(at(split(bag_khoroo, '-  '), 1)), \r",
						"    iif(\r",
						"        instr(bag_khoroo, '- ,') != 0,\r",
						"        toInteger(at(split(bag_khoroo, '- ,'), 1)),\r",
						"        iif(\r",
						"            instr(bag_khoroo, ' ') != 0,\r",
						"            toInteger(at(split(bag_khoroo, ' '), 1)),\r",
						"            iif(isInteger(bag_khoroo), toInteger(bag_khoroo), toInteger(null()))\r",
						"        )\r",
						"    )\r",
						")) ~> locationCapturing",
						"locationCapturing select(mapColumn(",
						"          trade_shop_cc_id,",
						"          customer_cc_id,",
						"          customer_register,",
						"          trade_shop_name,",
						"          aimag_hot,",
						"          duureg_sum,",
						"          bag_khoroo,",
						"          full_address,",
						"          longitude,",
						"          latitude,",
						"          e_group_name,",
						"          operation_start_date,",
						"          trade_shop_created_date = operation_start_date",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> selectFieldForDB",
						"selectFieldForDB derive(aimag_hot = replace(initCap(replace(aimag_hot, '-', ' ')), ' ', '-'),",
						"          duureg_sum = replace(initCap(replace(duureg_sum, '-', ' ')), ' ', '-'),",
						"          bag_khoroo = iif(aimag_hot =='', bag_khoroo, toInteger(null())),",
						"          trade_shop_created_date = operation_start_date) ~> additionalFixOnLocation",
						"selectRequiredFields derive(fixed_address = replace(\r",
						"    replace(\r",
						"        replace(\r",
						"            replace(\r",
						"                replace(\r",
						"                    replace(\r",
						"                        replace(\r",
						"                            replace(\r",
						"                                replace(\r",
						"                                    lower(full_address), ' ', ',  ,'\r",
						"                                ), ' ', ',  ,'\r",
						"                            ), ' ', ',  ,'\r",
						"                        ), ' ', ',  ,'\r",
						"                    ), ' ', ',  ,'\r",
						"                ), ' ', ',  ,'\r",
						"            ), ' ', ', - ,'\r",
						"        ), ' ', ',  ,'\r",
						"    ), ' ', ',  ,'\r",
						")) ~> addressFixDistrictCityAbbr1",
						"addressFixDistrictCityAbbr1 derive(fixed_address = replace(\r",
						"    replace(\r",
						"        replace(\r",
						"            replace(\r",
						"                replace(\r",
						"                    replace(\r",
						"                        fixed_address, ' ', ',  ,'\r",
						"                    ), '', ',  ,'\r",
						"                ), '', ',  ,'\r",
						"            ), ' ', ', - ,'\r",
						"        ), '', ',  ,'\r",
						"    ), '', ',  ,'\r",
						")) ~> addressFixDistrictAbbr1",
						"additionalFixOnLocation alterRow(upsertIf(true())) ~> AlterRow1",
						"AlterRow1 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:true,",
						"     upsertable:true,",
						"     keys:['trade_shop_cc_id'],",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> saveToMerchantDB"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/DWH_Mysql')]",
				"[concat(variables('factoryId'), '/datasets/DataService_TestMerchant')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/EmployeeProfile_From_GreenHR')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "HR/EVS"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "Evs_csv",
								"type": "DatasetReference"
							},
							"name": "sourceEmployees"
						},
						{
							"dataset": {
								"referenceName": "Evs_employee",
								"type": "DatasetReference"
							},
							"name": "existingEmployees"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "Evs_employee",
								"type": "DatasetReference"
							},
							"name": "Employee",
							"rejectedDataLinkedService": {
								"referenceName": "linkedService_err",
								"type": "LinkedServiceReference"
							}
						}
					],
					"transformations": [
						{
							"name": "DerivedColumns"
						},
						{
							"name": "leftOuterJoin"
						},
						{
							"name": "FilterNewOnlys"
						},
						{
							"name": "selectExist"
						},
						{
							"name": "alterRow1"
						}
					],
					"scriptLines": [
						"source(output(",
						"          fn as string,",
						"          ln as string,",
						"          rn as string,",
						"          oid as string,",
						"          po as string,",
						"          gname as string,",
						"          status as string,",
						"          empid as short,",
						"          status_date as string,",
						"          is_foreigner as boolean",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: true,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false) ~> sourceEmployees",
						"source(output(",
						"          id as integer,",
						"          rn as string,",
						"          oid as string,",
						"          source as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     query: 'SELECT id, rn, oid,source FROM employee_profile WHERE source = 0',",
						"     format: 'query') ~> existingEmployees",
						"sourceEmployees derive(status = iif(status == '', 1, \r",
						"    iif(status == ' ', 2, \r",
						"        iif(status == '', 2, \r",
						"            iif(status == ' ', 3, toInteger(null()))\r",
						"        )\r",
						"    )\r",
						"),",
						"          is_foreigner = iif(is_foreigner, 1, 0),",
						"          source = 0) ~> DerivedColumns",
						"DerivedColumns, selectExist join(rn == rn_exist",
						"     && oid == oid_exist,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> leftOuterJoin",
						"leftOuterJoin filter(isNull(rn_exist)) ~> FilterNewOnlys",
						"existingEmployees select(mapColumn(",
						"          rn_exist = rn,",
						"          oid_exist = oid,",
						"          source_exist = source",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> selectExist",
						"FilterNewOnlys alterRow(upsertIf(isNull(rn_exist)||source==0)) ~> alterRow1",
						"alterRow1 sink(allowSchemaDrift: true,",
						"     validateSchema: true,",
						"     input(",
						"          id as integer,",
						"          fn as string,",
						"          rn as string,",
						"          ln as string,",
						"          oid as string,",
						"          po as string,",
						"          gname as string,",
						"          empid as integer,",
						"          im as string,",
						"          source as string,",
						"          created_at as timestamp,",
						"          updated_at as timestamp,",
						"          status_date as timestamp,",
						"          status as integer,",
						"          gname_number as integer,",
						"          is_foreigner as integer",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:true,",
						"     upsertable:true,",
						"     keys:['rn',(oid),'source'],",
						"     format: 'table',",
						"     saveOrder: 1) ~> Employee"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/Evs_csv')]",
				"[concat(variables('factoryId'), '/datasets/Evs_employee')]",
				"[concat(variables('factoryId'), '/linkedServices/linkedService_err')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/EmployeeProfile_From_GreenHR_copy1')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "HR/EVS"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "Evs_csv",
								"type": "DatasetReference"
							},
							"name": "sourceEmployees"
						},
						{
							"dataset": {
								"referenceName": "Evs_employee",
								"type": "DatasetReference"
							},
							"name": "existingAllSources"
						},
						{
							"dataset": {
								"referenceName": "Evs_employee",
								"type": "DatasetReference"
							},
							"name": "existingSource0"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "Evs_employee",
								"type": "DatasetReference"
							},
							"name": "insertNewEmployees",
							"rejectedDataLinkedService": {
								"referenceName": "linkedService_err",
								"type": "LinkedServiceReference"
							}
						},
						{
							"dataset": {
								"referenceName": "ADLS_Raw_CSV",
								"type": "DatasetReference"
							},
							"name": "archiveToDataLake"
						},
						{
							"dataset": {
								"referenceName": "Evs_employee",
								"type": "DatasetReference"
							},
							"name": "deleteOldSource0"
						}
					],
					"transformations": [
						{
							"name": "transformStatusAndSource"
						},
						{
							"name": "removeDuplicatesInSource"
						},
						{
							"name": "extractNumberFromGname"
						},
						{
							"name": "joinWithAllExisting"
						},
						{
							"name": "filterOnlyNewEmployees"
						},
						{
							"name": "selectAllSourcesKeys"
						},
						{
							"name": "selectSource0Keys"
						},
						{
							"name": "markForInsert"
						},
						{
							"name": "markForDelete"
						}
					],
					"scriptLines": [
						"source(output(",
						"          fn as string,",
						"          ln as string,",
						"          rn as string,",
						"          oid as string,",
						"          po as string,",
						"          gname as string,",
						"          status as string,",
						"          empid as integer,",
						"          status_date as timestamp,",
						"          is_foreigner as boolean",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: true,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false) ~> sourceEmployees",
						"source(output(",
						"          rn as string,",
						"          oid as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     query: 'SELECT DISTINCT rn, oid FROM employee_profile',",
						"     format: 'query') ~> existingAllSources",
						"source(output(",
						"          id as integer,",
						"          rn as string,",
						"          oid as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     query: 'SELECT id, rn, oid FROM employee_profile WHERE source = 0',",
						"     format: 'query') ~> existingSource0",
						"sourceEmployees derive(status = iif(status == '', 1,",
						"            iif(status == ' ', 2,",
						"                iif(status == '', 2,",
						"                    iif(status == ' ', 3, toInteger(null()))))),",
						"          is_foreigner = iif(is_foreigner == true(), 1, 0),",
						"          source = 0,",
						"          rn = trim(toString(rn)),",
						"          oid = trim(toString(oid))) ~> transformStatusAndSource",
						"extractNumberFromGname aggregate(groupBy(rn,",
						"          oid),",
						"     fn = last(fn),",
						"          ln = last(ln),",
						"          po = last(po),",
						"          gname = last(gname),",
						"          status = last(status),",
						"          empid = last(empid),",
						"          status_date = max(status_date),",
						"          is_foreigner = last(is_foreigner),",
						"          source = last(source),",
						"          gname_number = last(gname_number)) ~> removeDuplicatesInSource",
						"transformStatusAndSource derive(gname_number = toInteger(regexReplace(gname, '[^0-9]', ''))) ~> extractNumberFromGname",
						"removeDuplicatesInSource, selectAllSourcesKeys join(rn == existing_rn",
						"     && oid == existing_oid,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> joinWithAllExisting",
						"joinWithAllExisting filter(isNull(existing_rn)) ~> filterOnlyNewEmployees",
						"existingAllSources select(mapColumn(",
						"          existing_rn = rn,",
						"          existing_oid = oid",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> selectAllSourcesKeys",
						"existingSource0 select(mapColumn(",
						"          delete_id = id,",
						"          delete_rn = rn,",
						"          delete_oid = oid",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> selectSource0Keys",
						"filterOnlyNewEmployees alterRow(insertIf(true())) ~> markForInsert",
						"selectSource0Keys alterRow(deleteIf(true())) ~> markForDelete",
						"markForInsert sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          id as integer,",
						"          fn as string,",
						"          rn as string,",
						"          ln as string,",
						"          oid as string,",
						"          po as string,",
						"          gname as string,",
						"          empid as integer,",
						"          im as string,",
						"          source as string,",
						"          created_at as timestamp,",
						"          updated_at as timestamp,",
						"          status_date as timestamp,",
						"          status as integer,",
						"          gname_number as integer,",
						"          is_foreigner as integer",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 2) ~> insertNewEmployees",
						"joinWithAllExisting sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     partitionFileNames:['employee_monthly_load.csv'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     partitionBy('hash', 1)) ~> archiveToDataLake",
						"markForDelete sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          id as integer,",
						"          fn as string,",
						"          rn as string,",
						"          ln as string,",
						"          oid as string,",
						"          po as string,",
						"          gname as string,",
						"          empid as integer,",
						"          im as string,",
						"          source as string,",
						"          created_at as timestamp,",
						"          updated_at as timestamp,",
						"          status_date as timestamp,",
						"          status as integer,",
						"          gname_number as integer,",
						"          is_foreigner as integer",
						"     ),",
						"     deletable:true,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:false,",
						"     keys:['delete_id'],",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1) ~> deleteOldSource0"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/Evs_csv')]",
				"[concat(variables('factoryId'), '/datasets/Evs_employee')]",
				"[concat(variables('factoryId'), '/linkedServices/linkedService_err')]",
				"[concat(variables('factoryId'), '/datasets/ADLS_Raw_CSV')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/EmployeeProfile_deletes')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "HR/EVS"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "Evs_employee",
								"type": "DatasetReference"
							},
							"name": "existingSource0"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "Evs_employee",
								"type": "DatasetReference"
							},
							"name": "deleteOldSource0"
						}
					],
					"transformations": [
						{
							"name": "selectSource0Keys"
						},
						{
							"name": "markForDelete"
						}
					],
					"scriptLines": [
						"source(output(",
						"          id as integer,",
						"          rn as string,",
						"          oid as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     query: 'SELECT id, rn, oid FROM employee_profile WHERE source = 0',",
						"     format: 'query') ~> existingSource0",
						"existingSource0 select(mapColumn(",
						"          id,",
						"          delete_rn = rn,",
						"          delete_oid = oid",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> selectSource0Keys",
						"selectSource0Keys alterRow(deleteIf(true())) ~> markForDelete",
						"markForDelete sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          id as integer,",
						"          fn as string,",
						"          rn as string,",
						"          ln as string,",
						"          oid as string,",
						"          po as string,",
						"          gname as string,",
						"          empid as integer,",
						"          im as string,",
						"          source as string,",
						"          created_at as timestamp,",
						"          updated_at as timestamp,",
						"          status_date as timestamp,",
						"          status as integer,",
						"          gname_number as integer,",
						"          is_foreigner as integer",
						"     ),",
						"     deletable:true,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:false,",
						"     keys:['id'],",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 0) ~> deleteOldSource0"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/Evs_employee')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Employee_From_Staging_to_DWH')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "HR"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "ADLS_Staging_Employee",
								"type": "DatasetReference"
							},
							"name": "source1"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "AzureMySqlTable_EMPLOYEE",
								"type": "DatasetReference"
							},
							"name": "sink1",
							"rejectedDataLinkedService": {
								"referenceName": "linkedService1",
								"type": "LinkedServiceReference"
							}
						}
					],
					"transformations": [
						{
							"name": "transform1"
						},
						{
							"name": "select1"
						}
					],
					"scriptLines": [
						"source(output(",
						"          EMPID as string,",
						"          CODE as string,",
						"          FAMILYNAME as string,",
						"          LASTNAME as string,",
						"          FIRSTNAME as string,",
						"          GENDER as string,",
						"          BIRTHDATE as string,",
						"          BIRTHCOUNTRYID as string,",
						"          BIRTHDIVISIONID as string,",
						"          BIRTHDISTRICTID as string,",
						"          BIRTHPLACE as string,",
						"          COUNTRYID as string,",
						"          DIVISIONID as string,",
						"          DISTRICTID as string,",
						"          NATIONALITYID as string,",
						"          SOCIALORIGINID as string,",
						"          MARITALSTATUS as string,",
						"          BLOODGROUP as string,",
						"          REGNO as string,",
						"          PASSNO as string,",
						"          FORPASSNO as string,",
						"          EMDNO as string,",
						"          NDDNO as string,",
						"          ADDR1 as string,",
						"          ADDR2 as string,",
						"          HOMEPHONE as string,",
						"          MOBILEPHONE as string,",
						"          WORKPHONE as string,",
						"          WORKPHONEEXT as string,",
						"          FAX as string,",
						"          EMAIL as string,",
						"          POSTADDRESS as string,",
						"          CONTACTNAME as string,",
						"          CONTACTPHONE as string,",
						"          WITHPICTURE as string,",
						"          STATUS as string,",
						"          CREATED as string,",
						"          CREATEDBY as string,",
						"          UPDATED as string,",
						"          UPDATEDBY as string,",
						"          IPADDRESS as string,",
						"          MACADDRESS as string,",
						"          TSTAMP as string,",
						"          COMPANYID as string,",
						"          STATUSDATE as string,",
						"          LASTNAMELENGTH as string,",
						"          EMAIL2 as string,",
						"          CONTACTNAME2 as string,",
						"          CONTACTPHONE2 as string,",
						"          ISBLACKLISTED as string,",
						"          BLACKLISTREASON as string,",
						"          BLACKLISTEDDATE as string,",
						"          ISFOREIGNER as string,",
						"          CONTACTID as string,",
						"          MILITARYSERVED as string,",
						"          TRAININGSPORT as string,",
						"          INTEREST as string,",
						"          APPID as string,",
						"          MILITARYNO as string,",
						"          RELATIVEID as string,",
						"          RELATIVEID2 as string,",
						"          MILITARYCLOSETYPE as string,",
						"          MILITARYCOMMENT as string,",
						"          LINKEDIN as string,",
						"          FACEBOOK as string,",
						"          TWITTER as string,",
						"          ISSPYOATH as string,",
						"          SPYOATHDATE as string,",
						"          ISGOVERNMENTOATH as string,",
						"          GOVERNMENTOATHDATE as string,",
						"          ISMILITARYOATH as string,",
						"          MILITARYOATHDATE as string,",
						"          LINKID as string,",
						"          ISRESIDENT as string,",
						"          CIVILID as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: true,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     format: 'parquet') ~> source1",
						"source1 derive(source_system_code = '0',",
						"          source_employee_id = EMPID,",
						"          company_id = iif(isNull(COMPANYID),\"NO\",COMPANYID),",
						"          employee_code = CODE,",
						"          registration_number = REGNO,",
						"          family_name = FAMILYNAME,",
						"          last_name = LASTNAME,",
						"          first_name = FIRSTNAME,",
						"          birth_date = toDate(BIRTHDATE, 'yyyy.MM.dd'),",
						"          nationality_id = toInteger(NATIONALITYID),",
						"          employment_status = iif(isNull(STATUS),\"NO\",STATUS),",
						"          effective_start_date = toTimestamp(CREATED, 'yyyy.MM.dd HH:mm:ss'),",
						"          effective_end_date = toTimestamp('9999-12-31 23:59:59'),",
						"          is_current_record = toInteger(1),",
						"          source_created_date = toTimestamp(CREATED, 'yyyy.MM.dd HH:mm:ss'),",
						"          source_updated_date = toTimestamp(UPDATED, 'yyyy.MM.dd HH:mm:ss'),",
						"          dw_created_date = currentUTC(),",
						"          dw_updated_date = currentUTC(),",
						"          etl_batch_id = toLong(0),",
						"          length_regno = length(REGNO)) ~> transform1",
						"transform1 select(skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> select1",
						"select1 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          employee_key as long,",
						"          source_system_code as string,",
						"          source_employee_id as string,",
						"          company_id as integer,",
						"          employee_code as string,",
						"          registration_number as string,",
						"          family_name as string,",
						"          last_name as string,",
						"          first_name as string,",
						"          gender as string,",
						"          birth_date as date,",
						"          nationality_id as integer,",
						"          employment_status as string,",
						"          effective_start_date as timestamp,",
						"          effective_end_date as timestamp,",
						"          is_current_record as integer,",
						"          source_created_date as timestamp,",
						"          source_updated_date as timestamp,",
						"          dw_created_date as timestamp,",
						"          dw_updated_date as timestamp,",
						"          etl_batch_id as long",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     saveOrder: 1,",
						"     preCommands: [],",
						"     postCommands: []) ~> sink1"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/ADLS_Staging_Employee')]",
				"[concat(variables('factoryId'), '/datasets/AzureMySqlTable_EMPLOYEE')]",
				"[concat(variables('factoryId'), '/linkedServices/linkedService1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/From_Staging_to_DWH_TBLDEPARTMENT')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "HR"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "ADLS_Staging_TBLDEPARTMENT",
								"type": "DatasetReference"
							},
							"name": "source1"
						},
						{
							"dataset": {
								"referenceName": "AzureMySqlTable_COMPANY",
								"type": "DatasetReference"
							},
							"name": "source2"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "AzureMySqlTable_Department",
								"type": "DatasetReference"
							},
							"name": "sink1"
						}
					],
					"transformations": [
						{
							"name": "joined"
						},
						{
							"name": "derivedclean"
						},
						{
							"name": "scdMark"
						}
					],
					"scriptLines": [
						"parameters{",
						"     cwfolder as string (\"TBLDEPARTMENT\"),",
						"     cwtablename as string (\"dim_department\")",
						"}",
						"source(output(",
						"          DEPID as short,",
						"          DEPCODE as string,",
						"          NAME as string,",
						"          ISACTIVE as boolean,",
						"          PARENTID as string,",
						"          CREATED as string,",
						"          UPDATED as string,",
						"          COMPANYID as string,",
						"          DEPTYPEID as short,",
						"          PATH as string,",
						"          PARENTPATH as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: true,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     format: 'parquet') ~> source1",
						"source(output(",
						"          company_key as integer,",
						"          company_code as string,",
						"          company_name as string,",
						"          is_active as boolean,",
						"          source_system_code as string,",
						"          source_created_date as timestamp,",
						"          source_updated_date as timestamp,",
						"          dw_created_date as timestamp,",
						"          dw_updated_date as timestamp",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> source2",
						"source1, source2 join(COMPANYID == company_code,",
						"     joinType:'inner',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> joined",
						"joined derive(source_department_id = toString(DEPID),",
						"          department_code = toString(DEPCODE),",
						"          department_name = trim(NAME),",
						"          department_type_id = DEPTYPEID,",
						"          parent_department_key_raw = trim(PARENTID),",
						"          raw_parent_path = iif(isNull(PARENTPATH) || trim(PARENTPATH) == '', '', trim(PARENTPATH)),",
						"          clean_parent_path = iif(PARENTPATH == '', '', trim(replace(replace(PARENTPATH, '|', '/'), '//', '/'))),",
						"          department_path = iif(isNull(PATH) || trim(PATH) == '', '', trim(replace(replace(PATH, '|', '/'), '//', '/'))),",
						"          is_active_int = iif(ISACTIVE == true(), 1, 0),",
						"          effective_start_date = iif(isNull(CREATED), currentUTC(), toTimestamp(CREATED, 'yyyy.MM.dd HH:mm:ss')),",
						"          effective_end_date = iif(isNull(UPDATED), toTimestamp('9999-12-31T00:00:00Z'), toTimestamp(UPDATED, 'yyyy.MM.dd HH:mm:ss')),",
						"          dw_created_date = currentUTC(),",
						"          dw_updated_date = currentUTC(),",
						"          etl_batch_id = toLong(currentUTC()),",
						"          company_key = company_key,",
						"          company_code = company_code) ~> derivedclean",
						"derivedclean derive(business_hash = md5(concat(",
						"        iifNull(department_code, ''), '|',",
						"        iifNull(department_name, ''), '|',",
						"        iifNull(toString(department_type_id), ''), '|',",
						"        iifNull(parent_department_key_raw, ''), '|',",
						"        iifNull(department_path, ''), '|',",
						"        iifNull(toString(is_active_int), ''), '|',",
						"        iifNull(toString(effective_start_date), ''), '|',",
						"        iifNull(toString(effective_end_date), '')",
						"    ) )) ~> scdMark",
						"scdMark sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          department_key as integer,",
						"          source_system_code as string,",
						"          source_department_id as string,",
						"          company_key as integer,",
						"          department_code as string,",
						"          department_name as string,",
						"          parent_department_key as integer,",
						"          department_level as string,",
						"          is_active as integer,",
						"          effective_start_date as timestamp,",
						"          effective_end_date as timestamp,",
						"          is_current_record as integer,",
						"          dw_created_date as timestamp,",
						"          dw_updated_date as timestamp",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1,",
						"     upsertKeyColumns: ['source_department_id','company_key']) ~> sink1"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/ADLS_Staging_TBLDEPARTMENT')]",
				"[concat(variables('factoryId'), '/datasets/AzureMySqlTable_COMPANY')]",
				"[concat(variables('factoryId'), '/datasets/AzureMySqlTable_Department')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/HREmployee_From_Staging_to_DWH')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "HR"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "ADLS_Staging_Employee",
								"type": "DatasetReference"
							},
							"name": "source1"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "AzureMySqlTable1_Employee",
								"type": "DatasetReference"
							},
							"name": "sink1"
						}
					],
					"transformations": [
						{
							"name": "sourcesystemcode"
						}
					],
					"scriptLines": [
						"source(output(",
						"          EMPID as string,",
						"          CODE as string,",
						"          FAMILYNAME as string,",
						"          LASTNAME as string,",
						"          FIRSTNAME as string,",
						"          GENDER as string,",
						"          BIRTHDATE as string,",
						"          BIRTHCOUNTRYID as string,",
						"          BIRTHDIVISIONID as string,",
						"          BIRTHDISTRICTID as string,",
						"          BIRTHPLACE as string,",
						"          COUNTRYID as string,",
						"          DIVISIONID as string,",
						"          DISTRICTID as string,",
						"          NATIONALITYID as string,",
						"          SOCIALORIGINID as string,",
						"          MARITALSTATUS as string,",
						"          BLOODGROUP as string,",
						"          REGNO as string,",
						"          PASSNO as string,",
						"          FORPASSNO as string,",
						"          EMDNO as string,",
						"          NDDNO as string,",
						"          ADDR1 as string,",
						"          ADDR2 as string,",
						"          HOMEPHONE as string,",
						"          MOBILEPHONE as string,",
						"          WORKPHONE as string,",
						"          WORKPHONEEXT as string,",
						"          FAX as string,",
						"          EMAIL as string,",
						"          POSTADDRESS as string,",
						"          CONTACTNAME as string,",
						"          CONTACTPHONE as string,",
						"          WITHPICTURE as string,",
						"          STATUS as string,",
						"          CREATED as string,",
						"          CREATEDBY as string,",
						"          UPDATED as string,",
						"          UPDATEDBY as string,",
						"          IPADDRESS as string,",
						"          MACADDRESS as string,",
						"          TSTAMP as string,",
						"          COMPANYID as string,",
						"          STATUSDATE as string,",
						"          LASTNAMELENGTH as string,",
						"          EMAIL2 as string,",
						"          CONTACTNAME2 as string,",
						"          CONTACTPHONE2 as string,",
						"          ISBLACKLISTED as string,",
						"          BLACKLISTREASON as string,",
						"          BLACKLISTEDDATE as string,",
						"          ISFOREIGNER as string,",
						"          CONTACTID as string,",
						"          MILITARYSERVED as string,",
						"          TRAININGSPORT as string,",
						"          INTEREST as string,",
						"          APPID as string,",
						"          MILITARYNO as string,",
						"          RELATIVEID as string,",
						"          RELATIVEID2 as string,",
						"          MILITARYCLOSETYPE as string,",
						"          MILITARYCOMMENT as string,",
						"          LINKEDIN as string,",
						"          FACEBOOK as string,",
						"          TWITTER as string,",
						"          ISSPYOATH as string,",
						"          SPYOATHDATE as string,",
						"          ISGOVERNMENTOATH as string,",
						"          GOVERNMENTOATHDATE as string,",
						"          ISMILITARYOATH as string,",
						"          MILITARYOATHDATE as string,",
						"          LINKID as string,",
						"          ISRESIDENT as string,",
						"          CIVILID as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: true,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     format: 'parquet') ~> source1",
						"source1 derive(source_system_code = 0,",
						"          COMPANYID = iif(isNull(COMPANYID), 'MCK', COMPANYID),",
						"          source_employee_id = iif(isNull(EMPID), 'unknown_id', toString(EMPID) )) ~> sourcesystemcode",
						"sourcesystemcode sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          employee_key as long,",
						"          source_system_code as string,",
						"          source_employee_id as string,",
						"          company_id as string,",
						"          employee_code as string,",
						"          registration_number as string,",
						"          family_name as string,",
						"          last_name as string,",
						"          first_name as string,",
						"          gender as string,",
						"          birth_date as date,",
						"          nationality_id as integer,",
						"          employment_status as string,",
						"          effective_start_date as timestamp,",
						"          effective_end_date as timestamp,",
						"          is_current_record as integer,",
						"          source_created_date as timestamp,",
						"          source_updated_date as timestamp,",
						"          dw_created_date as timestamp,",
						"          dw_updated_date as timestamp,",
						"          etl_batch_id as long",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     mapColumn(",
						"          each(match(/* All input columns */true()),",
						"               /* Input name */$$ = $$)",
						"     )) ~> sink1"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/ADLS_Staging_Employee')]",
				"[concat(variables('factoryId'), '/datasets/AzureMySqlTable1_Employee')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/SIGRADE_From_Staging_to_DWH')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "HR"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "ADLS_Staging_SIGRADE",
								"type": "DatasetReference"
							},
							"name": "source1"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "AzureMySqlTable_Grade",
								"type": "DatasetReference"
							},
							"name": "sink1"
						}
					],
					"transformations": [
						{
							"name": "transform1"
						},
						{
							"name": "select1"
						}
					],
					"scriptLines": [
						"source(output(",
						"          GRADEID as short,",
						"          CODE as string,",
						"          GRADENO as short,",
						"          NAME as string,",
						"          ISACTIVE as boolean,",
						"          CREATED as string,",
						"          UPDATED as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: true,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     format: 'parquet') ~> source1",
						"source1 derive(is_active = 1,",
						"          source_system_code = '0',",
						"          source_created_date = toTimestamp(CREATED, 'yyyy.MM.dd HH:mm:ss'),",
						"          source_updated_date = toTimestamp(UPDATED, 'yyyy.MM.dd HH:mm:ss'),",
						"          dw_created_date = currentUTC(),",
						"          dw_updated_date = currentUTC(),",
						"          grade_id = GRADEID,",
						"          grade_no = GRADENO,",
						"          code = CODE,",
						"          name = NAME) ~> transform1",
						"transform1 select(skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> select1",
						"select1 sink(allowSchemaDrift: true,",
						"     validateSchema: true,",
						"     input(",
						"          grade_key as integer,",
						"          grade_id as integer,",
						"          code as string,",
						"          grade_no as integer,",
						"          name as string,",
						"          source_system_code as string,",
						"          source_created_date as timestamp,",
						"          source_updated_date as timestamp,",
						"          dw_created_date as timestamp,",
						"          dw_updated_date as timestamp",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     saveOrder: 1,",
						"     preCommands: [],",
						"     postCommands: []) ~> sink1"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/ADLS_Staging_SIGRADE')]",
				"[concat(variables('factoryId'), '/datasets/AzureMySqlTable_Grade')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/SILEVEL_From_Staging_to_DWH')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "HR"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "ADLS_Staging_SILEVEL",
								"type": "DatasetReference"
							},
							"name": "source1"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "AzureMySqlTable_SILEVEL",
								"type": "DatasetReference"
							},
							"name": "sink1"
						}
					],
					"transformations": [
						{
							"name": "transform1"
						}
					],
					"scriptLines": [
						"source(output(",
						"          LEVELID as short,",
						"          CODE as string,",
						"          NAME as string,",
						"          ISACTIVE as boolean,",
						"          CREATED as string,",
						"          UPDATED as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: true,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     format: 'parquet') ~> source1",
						"source1 derive(source_system_code = '0',",
						"          source_created_date = toTimestamp(CREATED, 'yyyy.MM.dd HH:mm:ss'),",
						"          source_updated_date = toTimestamp(UPDATED, 'yyyy.MM.dd HH:mm:ss'),",
						"          dw_created_date = currentUTC(),",
						"          dw_updated_date = currentUTC(),",
						"          level_id = LEVELID,",
						"          code = CODE,",
						"          is_active = toInteger(1),",
						"          name = NAME) ~> transform1",
						"transform1 sink(allowSchemaDrift: true,",
						"     validateSchema: true,",
						"     input(",
						"          level_key as integer,",
						"          level_id as integer,",
						"          code as string,",
						"          name as string,",
						"          source_system_code as string,",
						"          source_created_date as timestamp,",
						"          source_updated_date as timestamp,",
						"          dw_created_date as timestamp,",
						"          dw_updated_date as timestamp",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     saveOrder: 1) ~> sink1"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/ADLS_Staging_SILEVEL')]",
				"[concat(variables('factoryId'), '/datasets/AzureMySqlTable_SILEVEL')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/TBLCOMPANY_From_Staging_to_DWH')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "HR"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "ADLS_Staging_TBLCOMPANY",
								"type": "DatasetReference"
							},
							"name": "source1"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "AzureMySqlTable_COMPANY",
								"type": "DatasetReference"
							},
							"name": "sink1"
						}
					],
					"transformations": [
						{
							"name": "transform1"
						},
						{
							"name": "select1"
						}
					],
					"scriptLines": [
						"source(output(",
						"          COMPANYID as string,",
						"          NAME as string,",
						"          CREATED as string,",
						"          UPDATED as string,",
						"          PARENTID as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: true,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     format: 'parquet') ~> source1",
						"source1 derive(company_code = COMPANYID,",
						"          company_name = NAME,",
						"          is_active = 1,",
						"          source_system_code = '0',",
						"          source_created_date = toTimestamp(CREATED),",
						"          source_updated_date = toTimestamp(UPDATED),",
						"          dw_created_date = currentUTC(),",
						"          dw_updated_date = currentUTC()) ~> transform1",
						"transform1 select(mapColumn(",
						"          company_code,",
						"          company_name,",
						"          is_active,",
						"          source_system_code,",
						"          source_created_date,",
						"          source_updated_date,",
						"          dw_created_date,",
						"          dw_updated_date",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> select1",
						"select1 sink(allowSchemaDrift: true,",
						"     validateSchema: true,",
						"     input(",
						"          company_key as integer,",
						"          company_code as string,",
						"          company_name as string,",
						"          is_active as boolean,",
						"          source_system_code as string,",
						"          source_created_date as timestamp,",
						"          source_updated_date as timestamp,",
						"          dw_created_date as timestamp,",
						"          dw_updated_date as timestamp",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     saveOrder: 1) ~> sink1"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/ADLS_Staging_TBLCOMPANY')]",
				"[concat(variables('factoryId'), '/datasets/AzureMySqlTable_COMPANY')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/TBLEMPEMPLHIST_From_Staging_to_DWH')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "HR"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "ADLS_Staging_TBLEMPEMPLHIST",
								"type": "DatasetReference"
							},
							"name": "source1"
						},
						{
							"dataset": {
								"referenceName": "AzureMySqlTable_EMPLOYEE",
								"type": "DatasetReference"
							},
							"name": "source2"
						},
						{
							"dataset": {
								"referenceName": "AzureMySqlTable_COMPANY",
								"type": "DatasetReference"
							},
							"name": "source3"
						},
						{
							"dataset": {
								"referenceName": "AzureMySqlTable_Department",
								"type": "DatasetReference"
							},
							"name": "source4"
						},
						{
							"dataset": {
								"referenceName": "AzureMySqlTable1_POSITION",
								"type": "DatasetReference"
							},
							"name": "source5"
						},
						{
							"dataset": {
								"referenceName": "AzureMySqlTable_Grade",
								"type": "DatasetReference"
							},
							"name": "source6"
						},
						{
							"dataset": {
								"referenceName": "AzureMySqlTable_SILEVEL",
								"type": "DatasetReference"
							},
							"name": "source7"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "AzureMySqlTable_Fact_employee_hist",
								"type": "DatasetReference"
							},
							"name": "sink1"
						}
					],
					"transformations": [
						{
							"name": "sourcesystemcode"
						},
						{
							"name": "filter1"
						},
						{
							"name": "joinEmployee"
						},
						{
							"name": "selectEmployee"
						},
						{
							"name": "joinCompany"
						},
						{
							"name": "selectCompany"
						},
						{
							"name": "select4"
						},
						{
							"name": "joinDepartment"
						},
						{
							"name": "selectPosition"
						},
						{
							"name": "joinPosition"
						},
						{
							"name": "select6Grade"
						},
						{
							"name": "selectLevel"
						},
						{
							"name": "joinWithGrade"
						},
						{
							"name": "joinWithLevel"
						}
					],
					"scriptLines": [
						"parameters{",
						"     cwfolder as string (\"TBLEMPEMPLHIST\")",
						"}",
						"source(output(",
						"          HISTORYID as integer,",
						"          EMPID as short,",
						"          BEGINDATE as string,",
						"          ENDDATE as string,",
						"          ORDERID as short,",
						"          ORDERTYPE as string,",
						"          COMPANYID as string,",
						"          DEPID as short,",
						"          POSITIONID as short,",
						"          GRADEID as short,",
						"          LEVELID as short,",
						"          BASEWAGE as integer,",
						"          BASEWAGECURRCODE as string,",
						"          CREATED as string,",
						"          UPDATED as string,",
						"          ORDERNO as string,",
						"          OLDDEPNAME as string,",
						"          JOBID as short,",
						"          INSURETYPEID as short,",
						"          LABOURCONDITION as boolean",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: true,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     format: 'parquet') ~> source1",
						"source(output(",
						"          employee_key as long,",
						"          source_system_code as string,",
						"          source_employee_id as string,",
						"          company_id as string,",
						"          employee_code as string,",
						"          registration_number as string,",
						"          family_name as string,",
						"          last_name as string,",
						"          first_name as string,",
						"          gender as string,",
						"          birth_date as date,",
						"          nationality_id as integer,",
						"          employment_status as string,",
						"          effective_start_date as timestamp,",
						"          effective_end_date as timestamp,",
						"          is_current_record as integer,",
						"          source_created_date as timestamp,",
						"          source_updated_date as timestamp,",
						"          dw_created_date as timestamp,",
						"          dw_updated_date as timestamp,",
						"          etl_batch_id as long",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> source2",
						"source(output(",
						"          company_key as integer,",
						"          company_code as string,",
						"          company_name as string,",
						"          is_active as boolean,",
						"          source_system_code as string,",
						"          source_created_date as timestamp,",
						"          source_updated_date as timestamp,",
						"          dw_created_date as timestamp,",
						"          dw_updated_date as timestamp",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> source3",
						"source(output(",
						"          department_key as integer,",
						"          source_system_code as string,",
						"          source_department_id as string,",
						"          company_key as integer,",
						"          department_code as string,",
						"          department_name as string,",
						"          parent_department_key as integer,",
						"          department_level as string,",
						"          is_active as integer,",
						"          effective_start_date as timestamp,",
						"          effective_end_date as timestamp,",
						"          is_current_record as integer,",
						"          dw_created_date as timestamp,",
						"          dw_updated_date as timestamp",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> source4",
						"source(output(",
						"          position_key as integer,",
						"          source_system_code as string,",
						"          source_position_id as string,",
						"          company_key as integer,",
						"          position_code as string,",
						"          position_name as string,",
						"          position_category as string,",
						"          position_level as string,",
						"          is_management as integer,",
						"          is_active as integer,",
						"          effective_start_date as timestamp,",
						"          effective_end_date as timestamp,",
						"          is_current_record as integer,",
						"          dw_created_date as timestamp,",
						"          dw_updated_date as timestamp",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> source5",
						"source(output(",
						"          grade_key as integer,",
						"          grade_id as integer,",
						"          code as string,",
						"          grade_no as integer,",
						"          name as string,",
						"          source_system_code as string,",
						"          source_created_date as timestamp,",
						"          source_updated_date as timestamp,",
						"          dw_created_date as timestamp,",
						"          dw_updated_date as timestamp",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> source6",
						"source(output(",
						"          level_key as integer,",
						"          level_id as integer,",
						"          code as string,",
						"          name as string,",
						"          source_system_code as string,",
						"          source_created_date as timestamp,",
						"          source_updated_date as timestamp,",
						"          dw_created_date as timestamp,",
						"          dw_updated_date as timestamp",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> source7",
						"joinWithLevel derive(source_system_code = 0,",
						"          is_current_position = true(),",
						"          is_multiple = 1,",
						"          is_active_employment = 1,",
						"          begin_date = toDate(BEGINDATE, 'yyyy-MM-dd'),",
						"          end_date = toDate(ENDDATE, 'yyyy-MM-dd'),",
						"          source_history_id = HISTORYID,",
						"          source_order_id = ORDERID,",
						"          order_type = ORDERTYPE,",
						"          order_number = ORDERNO,",
						"          level_number = LEVELID,",
						"          base_wage = BASEWAGE,",
						"          base_wage_currency = BASEWAGECURRCODE,",
						"          insurance_type_id = INSURETYPEID,",
						"          labour_condition = LABOURCONDITION,",
						"          source_created_date = toTimestamp(CREATED),",
						"          source_updated_date = toTimestamp(UPDATED),",
						"          dw_created_date = currentUTC(),",
						"          dw_updated_date = currentUTC(),",
						"          etl_batch_id = toLong(currentUTC())) ~> sourcesystemcode",
						"source1 filter(COMPANYID==\"AG\") ~> filter1",
						"filter1, selectEmployee join(toString(EMPID) == source_employee_id,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> joinEmployee",
						"source2 select(mapColumn(",
						"          employee_key,",
						"          source_employee_id",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> selectEmployee",
						"joinEmployee, selectCompany join(COMPANYID == company_code,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> joinCompany",
						"source3 select(mapColumn(",
						"          company_key,",
						"          company_code",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> selectCompany",
						"source4 select(mapColumn(",
						"          department_key,",
						"          source_department_id",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> select4",
						"joinCompany, select4 join(toString(DEPID) == source_department_id,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> joinDepartment",
						"source5 select(mapColumn(",
						"          position_key,",
						"          source_system_code,",
						"          source_position_id",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> selectPosition",
						"joinDepartment, selectPosition join(toString(POSITIONID) == source_position_id,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> joinPosition",
						"source6 select(mapColumn(",
						"          grade_key,",
						"          grade_id",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> select6Grade",
						"source7 select(mapColumn(",
						"          level_key,",
						"          level_id",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> selectLevel",
						"joinPosition, select6Grade join(GRADEID == grade_id,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> joinWithGrade",
						"joinWithGrade, selectLevel join(LEVELID == level_id,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> joinWithLevel",
						"sourcesystemcode sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          history_fact_key as long,",
						"          employee_key as long,",
						"          company_key as integer,",
						"          department_key as integer,",
						"          position_key as integer,",
						"          grade_key as integer,",
						"          level_key as integer,",
						"          begin_date as date,",
						"          end_date as date,",
						"          source_system_code as string,",
						"          source_history_id as string,",
						"          source_employee_id as string,",
						"          source_order_id as string,",
						"          order_type as string,",
						"          order_number as string,",
						"          level_number as integer,",
						"          base_wage as decimal(18,2),",
						"          base_wage_currency as string,",
						"          insurance_type_id as integer,",
						"          labour_condition as string,",
						"          is_current_position as integer,",
						"          is_active_employment as integer,",
						"          source_created_date as timestamp,",
						"          source_updated_date as timestamp,",
						"          dw_created_date as timestamp,",
						"          dw_updated_date as timestamp,",
						"          etl_batch_id as long",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1,",
						"     mapColumn(",
						"          employee_key,",
						"          company_key,",
						"          department_key,",
						"          position_key,",
						"          grade_key,",
						"          level_key,",
						"          begin_date,",
						"          end_date,",
						"          source_employee_id,",
						"          order_type = ORDERTYPE,",
						"          order_number = ORDERNO,",
						"          level_number = LEVELID,",
						"          base_wage = BASEWAGE,",
						"          base_wage_currency = BASEWAGECURRCODE,",
						"          insurance_type_id = INSURETYPEID,",
						"          labour_condition = LABOURCONDITION,",
						"          is_current_position,",
						"          is_active_employment,",
						"          source_created_date,",
						"          source_updated_date,",
						"          dw_created_date,",
						"          dw_updated_date,",
						"          etl_batch_id",
						"     ),",
						"     preCommands: [],",
						"     postCommands: []) ~> sink1"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/ADLS_Staging_TBLEMPEMPLHIST')]",
				"[concat(variables('factoryId'), '/datasets/AzureMySqlTable_EMPLOYEE')]",
				"[concat(variables('factoryId'), '/datasets/AzureMySqlTable_COMPANY')]",
				"[concat(variables('factoryId'), '/datasets/AzureMySqlTable_Department')]",
				"[concat(variables('factoryId'), '/datasets/AzureMySqlTable1_POSITION')]",
				"[concat(variables('factoryId'), '/datasets/AzureMySqlTable_Grade')]",
				"[concat(variables('factoryId'), '/datasets/AzureMySqlTable_SILEVEL')]",
				"[concat(variables('factoryId'), '/datasets/AzureMySqlTable_Fact_employee_hist')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/TBLPOSITION_From_Staging_to_DWH')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "HR"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "ADLS_Staging_TBLPOSITION",
								"type": "DatasetReference"
							},
							"name": "source1"
						},
						{
							"dataset": {
								"referenceName": "AzureMySqlTable_COMPANY",
								"type": "DatasetReference"
							},
							"name": "source2"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "AzureMySqlTable1_POSITION",
								"type": "DatasetReference"
							},
							"name": "sink1"
						}
					],
					"transformations": [
						{
							"name": "sourcesystemcode"
						},
						{
							"name": "renamecols"
						},
						{
							"name": "select1"
						},
						{
							"name": "join1"
						}
					],
					"scriptLines": [
						"parameters{",
						"     cwfolder as string (\"TBLPOSITION\"),",
						"     cwtablename as string (\"dim_position\")",
						"}",
						"source(output(",
						"          POSITIONID as short,",
						"          COMPANYID as string,",
						"          DEPID as short,",
						"          POSGROUPID as short,",
						"          CODE as string,",
						"          NAME as string,",
						"          EMPLOYMENTTYPEID as short,",
						"          GRADEID as short,",
						"          VACANCYDAYS as short,",
						"          LABOURCONDITION as string,",
						"          ISACTIVE as boolean,",
						"          CREATED as string,",
						"          UPDATED as string,",
						"          JOBDESCID as short,",
						"          JOBID as short,",
						"          TYPE as string,",
						"          POSITIONOCCID as short,",
						"          POSLEVEL as short",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: true,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     format: 'parquet') ~> source1",
						"source(output(",
						"          company_key as integer,",
						"          company_code as string,",
						"          company_name as string,",
						"          is_active as boolean,",
						"          source_system_code as string,",
						"          source_created_date as timestamp,",
						"          source_updated_date as timestamp,",
						"          dw_created_date as timestamp,",
						"          dw_updated_date as timestamp",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> source2",
						"join1 derive(COMPANYID = iif(isNull(COMPANYID), 'MCK', COMPANYID),",
						"          source_system_code = 0,",
						"          ISACTIVE_INT = iif(ISACTIVE, 1, 0),",
						"          company_key = company_key) ~> sourcesystemcode",
						"sourcesystemcode derive(source_position_id = toString(POSITIONID),",
						"          position_code = CODE,",
						"          position_name = NAME,",
						"          position_category = TYPE,",
						"          position_level = toString(POSLEVEL),",
						"          is_management = toInteger(iif(POSLEVEL <= 2, 1, 0)),",
						"          is_active = toInteger(ISACTIVE_INT),",
						"          effective_start_date = iif(isNull(CREATED), currentUTC(), toTimestamp(CREATED, 'yyyy.MM.dd HH:mm:ss')),",
						"          effective_end_date = iif(isNull(UPDATED), toTimestamp('9999-12-31T00:00:00Z'), toTimestamp(UPDATED, 'yyyy.MM.dd HH:mm:ss')),",
						"          is_current_record = toInteger(1),",
						"          dw_created_date = currentTimestamp(),",
						"          dw_updated_date = currentTimestamp()) ~> renamecols",
						"renamecols select(mapColumn(",
						"          source_system_code,",
						"          source_position_id,",
						"          company_key,",
						"          position_code,",
						"          position_name,",
						"          position_category,",
						"          position_level,",
						"          is_management,",
						"          is_active,",
						"          effective_start_date,",
						"          effective_end_date,",
						"          is_current_record,",
						"          dw_created_date,",
						"          dw_updated_date",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> select1",
						"source1, source2 join(COMPANYID == company_code,",
						"     joinType:'inner',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> join1",
						"select1 sink(allowSchemaDrift: true,",
						"     validateSchema: true,",
						"     input(",
						"          position_key as integer,",
						"          source_system_code as string,",
						"          source_position_id as string,",
						"          company_key as integer,",
						"          position_code as string,",
						"          position_name as string,",
						"          position_category as string,",
						"          position_level as string,",
						"          is_management as integer,",
						"          is_active as integer,",
						"          effective_start_date as timestamp,",
						"          effective_end_date as timestamp,",
						"          is_current_record as integer,",
						"          dw_created_date as timestamp,",
						"          dw_updated_date as timestamp",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     saveOrder: 1) ~> sink1"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/ADLS_Staging_TBLPOSITION')]",
				"[concat(variables('factoryId'), '/datasets/AzureMySqlTable_COMPANY')]",
				"[concat(variables('factoryId'), '/datasets/AzureMySqlTable1_POSITION')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/TD_Customer_Raw_to_Filtered')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "TD"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "ADLS_Raw_CSV",
								"type": "DatasetReference"
							},
							"name": "tdRawFullCustomerCSV"
						},
						{
							"dataset": {
								"referenceName": "ADLS_Raw_CSV",
								"type": "DatasetReference"
							},
							"name": "tdRawTradeShopGpsCSV"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "ADLS_Filtered_CSV",
								"type": "DatasetReference"
							},
							"name": "tdFilteredCSV"
						}
					],
					"transformations": [
						{
							"name": "TradeShopIDLeftJoin"
						},
						{
							"name": "ColumnFiltering",
							"description": "Renaming and (removing) TradeShopIDLeftJoin to ColumnFiltering with columns"
						}
					],
					"scriptLines": [
						"source(output(",
						"          CusID as integer,",
						"          CusName as string,",
						"          cusAddress as string,",
						"          ISISChannelID as short,",
						"          OwnerID as integer,",
						"          OwnerName as string,",
						"          INN as string,",
						"          StoreTypeName as string,",
						"          Region as string,",
						"          SumNer as string,",
						"          CreateDate as string,",
						"          UpdateDate as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false,",
						"     partitionBy('hash', 1)) ~> tdRawFullCustomerCSV",
						"source(output(",
						"          TradeshopID as integer,",
						"          CreatedDate as string,",
						"          UpdatedDate as string,",
						"          pickpackid as string,",
						"          Longitude as string,",
						"          Latitude as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false,",
						"     partitionBy('hash', 1)) ~> tdRawTradeShopGpsCSV",
						"tdRawFullCustomerCSV, tdRawTradeShopGpsCSV join(CusID == TradeshopID,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'off')~> TradeShopIDLeftJoin",
						"TradeShopIDLeftJoin select(mapColumn(",
						"          cusid_td = CusID,",
						"          trade_shop_name = CusName,",
						"          full_address = cusAddress,",
						"          customer_td_id = OwnerID,",
						"          customer_name = OwnerName,",
						"          store_type = StoreTypeName,",
						"          customer_register = INN,",
						"          channel_id = ISISChannelID,",
						"          district = Region,",
						"          khoroo = SumNer,",
						"          customer_created_date = CreateDate,",
						"          longitude = Longitude,",
						"          latitude = Latitude",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> ColumnFiltering",
						"ColumnFiltering sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     partitionFileNames:['td_dwh_customer_full.csv'],",
						"     umask: 0775,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     partitionBy('hash', 1)) ~> tdFilteredCSV"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/ADLS_Raw_CSV')]",
				"[concat(variables('factoryId'), '/datasets/ADLS_Filtered_CSV')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/df_evs_allemployee')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "HR/EVS"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "Evs_csv",
								"type": "DatasetReference"
							},
							"name": "sourceEmployees"
						},
						{
							"dataset": {
								"referenceName": "Evs_employee",
								"type": "DatasetReference"
							},
							"name": "existingAllSources"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "Evs_employee",
								"type": "DatasetReference"
							},
							"name": "insertNewEmployees",
							"rejectedDataLinkedService": {
								"referenceName": "linkedService_err",
								"type": "LinkedServiceReference"
							}
						},
						{
							"dataset": {
								"referenceName": "ADLS_Raw_CSV",
								"type": "DatasetReference"
							},
							"name": "archiveToDataLake"
						}
					],
					"transformations": [
						{
							"name": "transformStatusAndSource"
						},
						{
							"name": "removeDuplicatesInSource"
						},
						{
							"name": "extractNumberFromGname"
						},
						{
							"name": "joinWithAllExisting"
						},
						{
							"name": "filterOnlyNewEmployees"
						},
						{
							"name": "selectAllSourcesKeys"
						},
						{
							"name": "markForInsert"
						}
					],
					"scriptLines": [
						"source(output(",
						"          fn as string,",
						"          ln as string,",
						"          rn as string,",
						"          oid as string,",
						"          po as string,",
						"          gname as string,",
						"          status as string,",
						"          empid as integer,",
						"          status_date as timestamp,",
						"          is_foreigner as boolean",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: true,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false) ~> sourceEmployees",
						"source(output(",
						"          rn as string,",
						"          oid as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     query: 'SELECT DISTINCT rn, oid FROM employee_profile_temp',",
						"     format: 'query') ~> existingAllSources",
						"sourceEmployees derive(status = iif(status == '', 1,",
						"            iif(status == ' ', 2,",
						"                iif(status == '', 2,",
						"                    iif(status == ' ', 3, toInteger(null()))))),",
						"          is_foreigner = iif(is_foreigner == true(), 1, 0),",
						"          source = 0,",
						"          rn = trim(toString(rn)),",
						"          oid = trim(toString(oid))) ~> transformStatusAndSource",
						"extractNumberFromGname aggregate(groupBy(rn,",
						"          oid),",
						"     fn = last(fn),",
						"          ln = last(ln),",
						"          po = last(po),",
						"          gname = last(gname),",
						"          status = last(status),",
						"          empid = last(empid),",
						"          status_date = max(status_date),",
						"          is_foreigner = last(is_foreigner),",
						"          source = last(source),",
						"          gname_number = last(gname_number)) ~> removeDuplicatesInSource",
						"transformStatusAndSource derive(gname_number = toInteger(regexReplace(gname, '[^0-9]', ''))) ~> extractNumberFromGname",
						"removeDuplicatesInSource, selectAllSourcesKeys join(rn == existing_rn",
						"     && oid == existing_oid,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> joinWithAllExisting",
						"joinWithAllExisting filter(isNull(existing_rn)) ~> filterOnlyNewEmployees",
						"existingAllSources select(mapColumn(",
						"          existing_rn = rn,",
						"          existing_oid = oid",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> selectAllSourcesKeys",
						"filterOnlyNewEmployees alterRow(insertIf(true())) ~> markForInsert",
						"markForInsert sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          id as integer,",
						"          fn as string,",
						"          rn as string,",
						"          ln as string,",
						"          oid as string,",
						"          po as string,",
						"          gname as string,",
						"          empid as integer,",
						"          im as string,",
						"          source as string,",
						"          created_at as timestamp,",
						"          updated_at as timestamp,",
						"          status_date as timestamp,",
						"          status as integer,",
						"          gname_number as integer,",
						"          is_foreigner as integer",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     preSQLs:['DELETE FROM employee_profile_temp WHERE source = 0 OR source = \\'0\\''],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> insertNewEmployees",
						"joinWithAllExisting sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     partitionFileNames:['employee_monthly_load.csv'],",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     partitionBy('hash', 1)) ~> archiveToDataLake"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/Evs_csv')]",
				"[concat(variables('factoryId'), '/datasets/Evs_employee')]",
				"[concat(variables('factoryId'), '/linkedServices/linkedService_err')]",
				"[concat(variables('factoryId'), '/datasets/ADLS_Raw_CSV')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/df_evs_allemployee_upsert')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "HR/EVS"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "Evs_csv",
								"type": "DatasetReference"
							},
							"name": "sourceEmployees"
						},
						{
							"dataset": {
								"referenceName": "Evs_employee",
								"type": "DatasetReference"
							},
							"name": "existingAllSources"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "Evs_employee",
								"type": "DatasetReference"
							},
							"name": "upsertEmployees"
						},
						{
							"dataset": {
								"referenceName": "ADLS_Raw_Evs_csv",
								"type": "DatasetReference"
							},
							"name": "archiveToDataLake"
						},
						{
							"dataset": {
								"referenceName": "ADLS_Raw_Evs_csv",
								"type": "DatasetReference"
							},
							"name": "logSkippedMigrated"
						}
					],
					"transformations": [
						{
							"name": "transformStatusAndSource"
						},
						{
							"name": "removeDuplicatesInSource"
						},
						{
							"name": "joinWithSource"
						},
						{
							"name": "skipStream"
						},
						{
							"name": "existingAlls"
						},
						{
							"name": "markForInsert"
						},
						{
							"name": "markForUpdate"
						},
						{
							"name": "combinedStream"
						}
					],
					"scriptLines": [
						"source(output(",
						"          fn as string,",
						"          ln as string,",
						"          rn as string,",
						"          oid as string,",
						"          po as string,",
						"          gname as string,",
						"          status as string,",
						"          empid as integer,",
						"          status_date as timestamp,",
						"          is_foreigner as boolean",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false) ~> sourceEmployees",
						"source(output(",
						"          rn as string,",
						"          oid as string,",
						"          source as integer",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     query: 'SELECT DISTINCT rn, oid, source FROM employee_profile',",
						"     format: 'query') ~> existingAllSources",
						"sourceEmployees derive(status = iif(status == '', 1, iif(status == ' ', 2, iif(status == '', 2, iif(status == ' ', 3, toInteger(null()))))),",
						"          is_foreigner = iif(is_foreigner == true(), 1, 0),",
						"          source = 0,",
						"          rn = trim(toString(rn)),",
						"          oid = trim(toString(oid)),",
						"          gname_number = toInteger(regexReplace(gname, '[^0-9]', ''))) ~> transformStatusAndSource",
						"transformStatusAndSource aggregate(groupBy(rn,",
						"          oid),",
						"     fn = last(fn),",
						"          ln = last(ln),",
						"          po = last(po),",
						"          gname = last(gname),",
						"          status = last(status),",
						"          empid = last(empid),",
						"          status_date = max(status_date),",
						"          is_foreigner = last(is_foreigner),",
						"          source = last(source),",
						"          gname_number = last(gname_number)) ~> removeDuplicatesInSource",
						"removeDuplicatesInSource, existingAlls join(rn == existing_rn",
						"     && oid == existing_oid,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> joinWithSource",
						"joinWithSource split(isNull(existing_rn),",
						"     !isNull(existing_rn) && existing_source == 0,",
						"     disjoint: false) ~> skipStream@(insertStream, updateStream, skipStream)",
						"existingAllSources select(mapColumn(",
						"          existing_rn = rn,",
						"          existing_oid = oid,",
						"          existing_source = source",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> existingAlls",
						"skipStream@insertStream alterRow(insertIf(true())) ~> markForInsert",
						"skipStream@updateStream alterRow(updateIf(true())) ~> markForUpdate",
						"markForInsert, markForUpdate union(byName: true)~> combinedStream",
						"combinedStream sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          id as integer,",
						"          fn as string,",
						"          rn as string,",
						"          ln as string,",
						"          oid as string,",
						"          po as string,",
						"          gname as string,",
						"          empid as integer,",
						"          im as string,",
						"          source as string,",
						"          created_at as timestamp,",
						"          updated_at as timestamp,",
						"          status_date as timestamp,",
						"          status as integer,",
						"          gname_number as integer,",
						"          is_foreigner as integer",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:true,",
						"     upsertable:true,",
						"     keys:['rn','oid','source'],",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> upsertEmployees",
						"markForUpdate sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          fn as string,",
						"          ln as string,",
						"          rn as string,",
						"          oid as string,",
						"          po as string,",
						"          gname as string,",
						"          status as string,",
						"          empid as string,",
						"          status_date as string,",
						"          is_foreigner as string",
						"     ),",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> archiveToDataLake",
						"skipStream@skipStream sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          fn as string,",
						"          ln as string,",
						"          rn as string,",
						"          oid as string,",
						"          po as string,",
						"          gname as string,",
						"          status as string,",
						"          empid as string,",
						"          status_date as string,",
						"          is_foreigner as string",
						"     ),",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> logSkippedMigrated"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/Evs_csv')]",
				"[concat(variables('factoryId'), '/datasets/Evs_employee')]",
				"[concat(variables('factoryId'), '/datasets/ADLS_Raw_Evs_csv')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/dwh_df_company')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "Dataset_Source",
								"type": "DatasetReference"
							},
							"name": "source1"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "Dataset_Sink",
								"type": "DatasetReference"
							},
							"name": "sink1",
							"rejectedDataLinkedService": {
								"referenceName": "linkedService_err",
								"type": "LinkedServiceReference"
							}
						}
					],
					"transformations": [
						{
							"name": "transform1"
						},
						{
							"name": "select1"
						},
						{
							"name": "alterRow1"
						}
					],
					"scriptLines": [
						"source(output(",
						"          COMPANYID as string,",
						"          NAME as string,",
						"          ADDRESS as string,",
						"          CREATED as string,",
						"          CREATEDBY as string,",
						"          UPDATED as string,",
						"          UPDATEDBY as string,",
						"          IPADDRESS as string,",
						"          MACADDRESS as string,",
						"          TSTAMP as timestamp,",
						"          BUSINESSTYPEID as long,",
						"          PARENTID as string,",
						"          REPGROUPID as string,",
						"          PHONE as string,",
						"          FAX as string,",
						"          INTCOMPANYID as long,",
						"          JDECOMPANY as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> source1",
						"source1 derive(company_code = COMPANYID,",
						"          company_name = NAME,",
						"          is_active = 1,",
						"          source_system_code = '0',",
						"          source_created_date = toTimestamp(CREATED, 'yyyy.MM.dd HH:mm:ss'),",
						"          source_updated_date = toTimestamp(UPDATED, 'yyyy.MM.dd HH:mm:ss'),",
						"          dw_created_date = currentUTC(),",
						"          dw_updated_date = currentUTC()) ~> transform1",
						"transform1 select(mapColumn(",
						"          company_code,",
						"          company_name,",
						"          is_active,",
						"          source_system_code,",
						"          source_created_date,",
						"          source_updated_date,",
						"          dw_created_date,",
						"          dw_updated_date",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> select1",
						"select1 alterRow(upsertIf(!isNull(company_code))) ~> alterRow1",
						"alterRow1 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:true,",
						"     upsertable:true,",
						"     keys:['company_code'],",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> sink1"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/Dataset_Source')]",
				"[concat(variables('factoryId'), '/datasets/Dataset_Sink')]",
				"[concat(variables('factoryId'), '/linkedServices/linkedService_err')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/dwh_df_department')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "Dataset_Source",
								"type": "DatasetReference"
							},
							"name": "source1"
						},
						{
							"dataset": {
								"referenceName": "Dataset_Source",
								"type": "DatasetReference"
							},
							"name": "source2"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "Dataset_Sink",
								"type": "DatasetReference"
							},
							"name": "sink1",
							"rejectedDataLinkedService": {
								"referenceName": "linkedService_err",
								"type": "LinkedServiceReference"
							}
						}
					],
					"transformations": [
						{
							"name": "join1"
						},
						{
							"name": "sourcesystemcode"
						},
						{
							"name": "select1"
						},
						{
							"name": "alterRow1"
						}
					],
					"scriptLines": [
						"source(output(",
						"          DEPID as string,",
						"          DEPCODE as string,",
						"          NAME as string,",
						"          ISACTIVE as string,",
						"          PARENTID as string,",
						"          CREATED as string,",
						"          CREATEDBY as string,",
						"          UPDATED as string,",
						"          UPDATEDBY as string,",
						"          IPADDRESS as string,",
						"          MACADDRESS as string,",
						"          TSTAMP as timestamp,",
						"          COMPANYID as string,",
						"          DEPTYPEID as long,",
						"          PATH as string,",
						"          PARENTPATH as string,",
						"          REPGROUPID as string,",
						"          INTDEPID as long,",
						"          INTPARENTID as long,",
						"          DEPTYPE as string,",
						"          LDAPPATH as string,",
						"          ISPROVINCE as string,",
						"          ESTABLISHEDDATE as string,",
						"          SHOWONORGCHART as string,",
						"          FAPURPOSEID as long",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> source1",
						"source(output(",
						"          company_key as integer,",
						"          company_code as string,",
						"          company_name as string,",
						"          is_active as boolean,",
						"          source_system_code as string,",
						"          source_created_date as timestamp,",
						"          source_updated_date as timestamp,",
						"          dw_created_date as timestamp,",
						"          dw_updated_date as timestamp",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> source2",
						"source1, source2 join(COMPANYID == company_code,",
						"     joinType:'inner',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> join1",
						"join1 derive(COMPANYID = iif(isNull(COMPANYID), 'MCK', COMPANYID),",
						"          source_system_code = 0,",
						"          ISACTIVE_INT = iif(ISACTIVE=='Y', 1, 0),",
						"          company_key = company_key,",
						"          source_department_id = DEPID,",
						"          department_code = DEPCODE,",
						"          department_name = NAME) ~> sourcesystemcode",
						"sourcesystemcode derive(is_active = toInteger(ISACTIVE_INT),",
						"          effective_start_date = iif(isNull(CREATED), currentUTC(), toTimestamp(CREATED, 'yyyy.MM.dd HH:mm:ss')),",
						"          effective_end_date = iif(isNull(UPDATED), toTimestamp('9999-12-31T00:00:00Z'), toTimestamp(UPDATED, 'yyyy.MM.dd HH:mm:ss')),",
						"          is_current_record = toInteger(1),",
						"          dw_created_date = currentTimestamp(),",
						"          dw_updated_date = currentTimestamp()) ~> select1",
						"select1 alterRow(upsertIf(!isNull(source_department_id))) ~> alterRow1",
						"alterRow1 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:true,",
						"     upsertable:true,",
						"     keys:['source_department_id'],",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> sink1"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/Dataset_Source')]",
				"[concat(variables('factoryId'), '/datasets/Dataset_Sink')]",
				"[concat(variables('factoryId'), '/linkedServices/linkedService_err')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/dwh_df_employee')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "Dataset_Source",
								"type": "DatasetReference"
							},
							"name": "source1"
						},
						{
							"dataset": {
								"referenceName": "Dataset_Source",
								"type": "DatasetReference"
							},
							"name": "source2"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "Dataset_Sink",
								"type": "DatasetReference"
							},
							"name": "sink1",
							"rejectedDataLinkedService": {
								"referenceName": "linkedService_err",
								"type": "LinkedServiceReference"
							}
						}
					],
					"transformations": [
						{
							"name": "join1"
						},
						{
							"name": "sourcesystemcode"
						},
						{
							"name": "select1"
						},
						{
							"name": "alterRow1"
						}
					],
					"scriptLines": [
						"source(output(",
						"          EMPID as decimal(20,0),",
						"          CODE as string,",
						"          FAMILYNAME as string,",
						"          LASTNAME as string,",
						"          FIRSTNAME as string,",
						"          GENDER as string,",
						"          BIRTHDATE as string,",
						"          BIRTHCOUNTRYID as long,",
						"          BIRTHDIVISIONID as long,",
						"          BIRTHDISTRICTID as long,",
						"          BIRTHPLACE as string,",
						"          COUNTRYID as long,",
						"          DIVISIONID as long,",
						"          DISTRICTID as long,",
						"          NATIONALITYID as long,",
						"          SOCIALORIGINID as long,",
						"          MARITALSTATUS as string,",
						"          BLOODGROUP as string,",
						"          REGNO as string,",
						"          PASSNO as string,",
						"          FORPASSNO as string,",
						"          EMDNO as string,",
						"          NDDNO as string,",
						"          ADDR1 as string,",
						"          ADDR2 as string,",
						"          HOMEPHONE as string,",
						"          MOBILEPHONE as string,",
						"          WORKPHONE as string,",
						"          WORKPHONEEXT as string,",
						"          FAX as string,",
						"          EMAIL as string,",
						"          POSTADDRESS as string,",
						"          CONTACTNAME as string,",
						"          CONTACTPHONE as string,",
						"          WITHPICTURE as string,",
						"          STATUS as string,",
						"          CREATED as string,",
						"          CREATEDBY as string,",
						"          UPDATED as string,",
						"          UPDATEDBY as string,",
						"          IPADDRESS as string,",
						"          MACADDRESS as string,",
						"          TSTAMP as timestamp,",
						"          COMPANYID as string,",
						"          STATUSDATE as string,",
						"          LASTNAMELENGTH as decimal(38,0),",
						"          EMAIL2 as string,",
						"          CONTACTNAME2 as string,",
						"          CONTACTPHONE2 as string,",
						"          ISBLACKLISTED as string,",
						"          BLACKLISTREASON as string,",
						"          BLACKLISTEDDATE as string,",
						"          ISFOREIGNER as string,",
						"          CONTACTID as long,",
						"          MILITARYSERVED as string,",
						"          TRAININGSPORT as string,",
						"          INTEREST as string,",
						"          APPID as long,",
						"          MILITARYNO as string,",
						"          RELATIVEID as long,",
						"          RELATIVEID2 as long,",
						"          MILITARYCLOSETYPE as string,",
						"          MILITARYCOMMENT as string,",
						"          LINKEDIN as string,",
						"          FACEBOOK as string,",
						"          TWITTER as string,",
						"          ISSPYOATH as string,",
						"          SPYOATHDATE as string,",
						"          ISGOVERNMENTOATH as string,",
						"          GOVERNMENTOATHDATE as string,",
						"          ISMILITARYOATH as string,",
						"          MILITARYOATHDATE as string,",
						"          LINKID as string,",
						"          ISRESIDENT as string,",
						"          CIVILID as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> source1",
						"source(output(",
						"          company_key as integer,",
						"          company_code as string,",
						"          company_name as string,",
						"          is_active as boolean,",
						"          source_system_code as string,",
						"          source_created_date as timestamp,",
						"          source_updated_date as timestamp,",
						"          dw_created_date as timestamp,",
						"          dw_updated_date as timestamp",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> source2",
						"source1, source2 join(COMPANYID == company_code,",
						"     joinType:'inner',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> join1",
						"join1 derive(COMPANYID = iif(isNull(COMPANYID), 'MCK', COMPANYID),",
						"          source_system_code = 0,",
						"          company_key = company_key,",
						"          source_employee_id = EMPID,",
						"          employee_code = CODE,",
						"          registration_number = REGNO,",
						"          family_name = FAMILYNAME,",
						"          last_name = LASTNAME,",
						"          first_name = FIRSTNAME,",
						"          gender = GENDER,",
						"          birth_date = toTimestamp(BIRTHDATE, 'yyyy.MM.dd'),",
						"          nationality_id = NATIONALITYID,",
						"          employment_status = STATUS) ~> sourcesystemcode",
						"sourcesystemcode derive(effective_start_date = iif(         isNull(CREATED) || trim(CREATED)=='' || CREATED=='0000-00-00 00:00:00',         currentUTC(),         toTimestamp(CREATED, 'yyyy.MM.dd HH:mm:ss')     ),",
						"          effective_end_date = iif(isNull(UPDATED) || trim(UPDATED)=='' || UPDATED=='0000-00-00 00:00:00',         toTimestamp('9999-12-31 23:59:59', 'yyyy-MM-dd HH:mm:ss'),         toTimestamp(UPDATED, 'yyyy.MM.dd HH:mm:ss')     ),",
						"          is_current_record = toInteger(1),",
						"          dw_created_date = currentTimestamp(),",
						"          dw_updated_date = currentTimestamp(),",
						"          source_created_date = iif(isNull(CREATED), currentUTC(), toTimestamp(CREATED, 'yyyy.MM.dd HH:mm:ss')),",
						"          source_updated_date = iif(isNull(UPDATED), toTimestamp('9999-12-31T00:00:00Z'), toTimestamp(UPDATED, 'yyyy.MM.dd HH:mm:ss'))) ~> select1",
						"select1 alterRow(upsertIf(!isNull(source_employee_id))) ~> alterRow1",
						"alterRow1 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:true,",
						"     upsertable:true,",
						"     keys:['source_employee_id'],",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> sink1"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/Dataset_Source')]",
				"[concat(variables('factoryId'), '/datasets/Dataset_Sink')]",
				"[concat(variables('factoryId'), '/linkedServices/linkedService_err')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/dwh_df_employee_history')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "Dataset_Source",
								"type": "DatasetReference"
							},
							"name": "employeeHist"
						},
						{
							"dataset": {
								"referenceName": "Dataset_Source",
								"type": "DatasetReference"
							},
							"name": "company"
						},
						{
							"dataset": {
								"referenceName": "Dataset_Source",
								"type": "DatasetReference"
							},
							"name": "employee"
						},
						{
							"dataset": {
								"referenceName": "Dataset_Source",
								"type": "DatasetReference"
							},
							"name": "department"
						},
						{
							"dataset": {
								"referenceName": "Dataset_Source",
								"type": "DatasetReference"
							},
							"name": "position"
						},
						{
							"dataset": {
								"referenceName": "Dataset_Source",
								"type": "DatasetReference"
							},
							"name": "grade"
						},
						{
							"dataset": {
								"referenceName": "Dataset_Source",
								"type": "DatasetReference"
							},
							"name": "level"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "Dataset_Sink",
								"type": "DatasetReference"
							},
							"name": "sink1",
							"rejectedDataLinkedService": {
								"referenceName": "linkedService_err",
								"type": "LinkedServiceReference"
							}
						}
					],
					"transformations": [
						{
							"name": "joinCompany"
						},
						{
							"name": "sourcesystemcode"
						},
						{
							"name": "alterRow1"
						},
						{
							"name": "joinEmployee"
						},
						{
							"name": "joinDepart"
						},
						{
							"name": "joinPosition"
						},
						{
							"name": "joinGrade"
						},
						{
							"name": "joinLevel"
						},
						{
							"name": "derivedColumn1"
						},
						{
							"name": "selectEmployee"
						},
						{
							"name": "select1"
						},
						{
							"name": "selectDepartment"
						},
						{
							"name": "selectPosition"
						},
						{
							"name": "selectGrade"
						},
						{
							"name": "selectLevel"
						}
					],
					"scriptLines": [
						"source(output(",
						"          HISTORYID as long,",
						"          EMPID as long,",
						"          BEGINDATE as string,",
						"          ENDDATE as string,",
						"          ORDERID as long,",
						"          ORDERTYPE as string,",
						"          COMPANYID as string,",
						"          DEPID as string,",
						"          POSITIONID as long,",
						"          GRADEID as long,",
						"          LEVELID as long,",
						"          BASEWAGE as decimal(18,4),",
						"          BASEWAGECURRCODE as string,",
						"          TSTAMP as timestamp,",
						"          CREATED as string,",
						"          CREATEDBY as string,",
						"          UPDATED as string,",
						"          UPDATEDBY as string,",
						"          IPADDRESS as string,",
						"          MACADDRESS as string,",
						"          ORDERNO as string,",
						"          ISMANUALHIST as string,",
						"          ISNOTLOCALHIST as string,",
						"          LEGALENTITYID as long,",
						"          OLDDEPNAME as string,",
						"          JOBID as long,",
						"          NOTE as string,",
						"          INSURETYPEID as long,",
						"          LABOURCONDITION as string,",
						"          ISMULT as string,",
						"          MULTYEAR as decimal(18,4),",
						"          HISTREASON as string,",
						"          HISTREASONNAMES as string,",
						"          TOTALWAGE as decimal(18,4),",
						"          EVOLVEWAGE as decimal(18,4),",
						"          CALCPERCENT as decimal(18,4),",
						"          GRADETYPEID as long,",
						"          LEVELNO as long,",
						"          FTEMAINID as long",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> employeeHist",
						"source(output(",
						"          company_key as integer,",
						"          company_code as string,",
						"          company_name as string,",
						"          is_active as boolean,",
						"          source_system_code as string,",
						"          source_created_date as timestamp,",
						"          source_updated_date as timestamp,",
						"          dw_created_date as timestamp,",
						"          dw_updated_date as timestamp",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> company",
						"source(output(",
						"          employee_key as long,",
						"          source_system_code as string,",
						"          source_employee_id as string,",
						"          company_key as integer,",
						"          employee_code as string,",
						"          registration_number as string,",
						"          family_name as string,",
						"          last_name as string,",
						"          first_name as string,",
						"          gender as string,",
						"          birth_date as date,",
						"          nationality_id as integer,",
						"          employment_status as string,",
						"          effective_start_date as timestamp,",
						"          effective_end_date as timestamp,",
						"          is_current_record as boolean,",
						"          source_created_date as timestamp,",
						"          source_updated_date as timestamp,",
						"          dw_created_date as timestamp,",
						"          dw_updated_date as timestamp,",
						"          etl_batch_id as long",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> employee",
						"source(output(",
						"          department_key as integer,",
						"          source_system_code as string,",
						"          source_department_id as string,",
						"          company_key as integer,",
						"          department_code as string,",
						"          department_name as string,",
						"          parent_department_key as integer,",
						"          department_level as string,",
						"          is_active as boolean,",
						"          effective_start_date as timestamp,",
						"          effective_end_date as timestamp,",
						"          is_current_record as boolean,",
						"          dw_created_date as timestamp,",
						"          dw_updated_date as timestamp",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> department",
						"source(output(",
						"          position_key as integer,",
						"          source_system_code as string,",
						"          source_position_id as string,",
						"          company_key as integer,",
						"          position_code as string,",
						"          position_name as string,",
						"          position_category as string,",
						"          position_level as string,",
						"          is_management as boolean,",
						"          is_active as boolean,",
						"          effective_start_date as timestamp,",
						"          effective_end_date as timestamp,",
						"          is_current_record as boolean,",
						"          dw_created_date as timestamp,",
						"          dw_updated_date as timestamp",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> position",
						"source(output(",
						"          grade_key as integer,",
						"          grade_id as integer,",
						"          code as string,",
						"          grade_no as integer,",
						"          name as string,",
						"          is_active as boolean,",
						"          source_system_code as string,",
						"          source_created_date as timestamp,",
						"          source_updated_date as timestamp,",
						"          dw_created_date as timestamp,",
						"          dw_updated_date as timestamp",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> grade",
						"source(output(",
						"          level_key as integer,",
						"          level_id as integer,",
						"          level_code as string,",
						"          level_name as string,",
						"          source_system_code as string,",
						"          source_created_date as timestamp,",
						"          source_updated_date as timestamp,",
						"          dw_created_date as timestamp,",
						"          dw_updated_date as timestamp",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> level",
						"employeeHist, company join(COMPANYID == company_code,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> joinCompany",
						"joinLevel derive(source_system_code = 0,",
						"          is_current_position = 1,",
						"          is_active_employment = 1,",
						"          begin_date = toTimestamp(BEGINDATE, 'yyyy.MM.dd HH:mm:ss'),",
						"          end_date = toTimestamp(ENDDATE, 'yyyy.MM.dd HH:mm:ss'),",
						"          source_history_id = HISTORYID,",
						"          source_order_id = ORDERID,",
						"          order_type = ORDERTYPE,",
						"          order_number = ORDERNO,",
						"          level_number = LEVELID,",
						"          base_wage = BASEWAGE,",
						"          base_wage_currency = BASEWAGECURRCODE,",
						"          insurance_type_id = INSURETYPEID,",
						"          labour_condition = LABOURCONDITION,",
						"          source_created_date = toTimestamp(CREATED, 'yyyy.MM.dd HH:mm:ss'),",
						"          source_updated_date = toTimestamp(UPDATED, 'yyyy.MM.dd HH:mm:ss'),",
						"          dw_created_date = currentUTC(),",
						"          dw_updated_date = currentUTC(),",
						"          etl_batch_id = toLong(currentUTC())) ~> sourcesystemcode",
						"sourcesystemcode alterRow(upsertIf(!isNull(source_history_id))) ~> alterRow1",
						"joinCompany, selectEmployee join(toString(EMPID) == toString(source_employee_id),",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> joinEmployee",
						"derivedColumn1, selectDepartment join(toString(DEPID) == source_department_id,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> joinDepart",
						"joinDepart, selectPosition join(toString(POSITIONID) == source_position_id,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> joinPosition",
						"joinPosition, selectGrade join(GRADEID == grade_id,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> joinGrade",
						"joinGrade, selectLevel join(toString(LEVELID) == toString(level_id),",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> joinLevel",
						"joinEmployee derive({emp_left } = toString(EMPID),",
						"          emp_right = toString(source_employee_id)) ~> derivedColumn1",
						"employee select(mapColumn(",
						"          employee_key,",
						"          source_system_code,",
						"          source_employee_id,",
						"          company_key,",
						"          employee_code",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> selectEmployee",
						"company select(mapColumn(",
						"          company_key,",
						"          company_code,",
						"          company_name",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> select1",
						"department select(mapColumn(",
						"          department_key,",
						"          source_department_id",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> selectDepartment",
						"position select(mapColumn(",
						"          position_key,",
						"          source_position_id,",
						"          position_code",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> selectPosition",
						"grade select(mapColumn(",
						"          grade_key,",
						"          grade_id,",
						"          grade_code = code,",
						"          grade_no",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> selectGrade",
						"level select(mapColumn(",
						"          level_key,",
						"          level_id,",
						"          level_code,",
						"          level_name",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> selectLevel",
						"alterRow1 sink(allowSchemaDrift: true,",
						"     validateSchema: true,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:true,",
						"     upsertable:true,",
						"     keys:['source_history_id'],",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> sink1"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/Dataset_Source')]",
				"[concat(variables('factoryId'), '/datasets/Dataset_Sink')]",
				"[concat(variables('factoryId'), '/linkedServices/linkedService_err')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/dwh_df_employee_history_copy1')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "Dataset_Source",
								"type": "DatasetReference"
							},
							"name": "employee"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "DelimitedText1",
								"type": "DatasetReference"
							},
							"name": "sink1"
						}
					],
					"transformations": [
						{
							"name": "filter1"
						}
					],
					"scriptLines": [
						"source(output(",
						"          employee_key as long,",
						"          source_system_code as string,",
						"          source_employee_id as string,",
						"          company_key as integer,",
						"          employee_code as string,",
						"          registration_number as string,",
						"          family_name as string,",
						"          last_name as string,",
						"          first_name as string,",
						"          gender as string,",
						"          birth_date as date,",
						"          nationality_id as integer,",
						"          employment_status as string,",
						"          effective_start_date as timestamp,",
						"          effective_end_date as timestamp,",
						"          is_current_record as boolean,",
						"          source_created_date as timestamp,",
						"          source_updated_date as timestamp,",
						"          dw_created_date as timestamp,",
						"          dw_updated_date as timestamp,",
						"          etl_batch_id as long",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> employee",
						"employee filter(source_employee_id=='18096') ~> filter1",
						"filter1 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> sink1"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/Dataset_Source')]",
				"[concat(variables('factoryId'), '/datasets/DelimitedText1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/dwh_df_employee_history_copy2')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "Dataset_Source",
								"type": "DatasetReference"
							},
							"name": "employeeHist"
						},
						{
							"dataset": {
								"referenceName": "Dataset_Source",
								"type": "DatasetReference"
							},
							"name": "company"
						},
						{
							"dataset": {
								"referenceName": "Dataset_Source",
								"type": "DatasetReference"
							},
							"name": "employee"
						},
						{
							"dataset": {
								"referenceName": "Dataset_Source",
								"type": "DatasetReference"
							},
							"name": "department"
						},
						{
							"dataset": {
								"referenceName": "Dataset_Source",
								"type": "DatasetReference"
							},
							"name": "position"
						},
						{
							"dataset": {
								"referenceName": "Dataset_Source",
								"type": "DatasetReference"
							},
							"name": "grade"
						},
						{
							"dataset": {
								"referenceName": "Dataset_Source",
								"type": "DatasetReference"
							},
							"name": "level"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "Dataset_Sink",
								"type": "DatasetReference"
							},
							"name": "sink1",
							"rejectedDataLinkedService": {
								"referenceName": "linkedService_err",
								"type": "LinkedServiceReference"
							}
						}
					],
					"transformations": [
						{
							"name": "joinCompany"
						},
						{
							"name": "sourcesystemcode"
						},
						{
							"name": "alterRow1"
						},
						{
							"name": "joinEmployee"
						},
						{
							"name": "joinDepart"
						},
						{
							"name": "joinPosition"
						},
						{
							"name": "joinGrade"
						},
						{
							"name": "joinLevel"
						},
						{
							"name": "derivedColumn1"
						},
						{
							"name": "selectEmployee"
						},
						{
							"name": "filter1"
						}
					],
					"scriptLines": [
						"source(output(",
						"          HISTORYID as long,",
						"          EMPID as long,",
						"          BEGINDATE as string,",
						"          ENDDATE as string,",
						"          ORDERID as long,",
						"          ORDERTYPE as string,",
						"          COMPANYID as string,",
						"          DEPID as string,",
						"          POSITIONID as long,",
						"          GRADEID as long,",
						"          LEVELID as long,",
						"          BASEWAGE as decimal(18,4),",
						"          BASEWAGECURRCODE as string,",
						"          TSTAMP as timestamp,",
						"          CREATED as string,",
						"          CREATEDBY as string,",
						"          UPDATED as string,",
						"          UPDATEDBY as string,",
						"          IPADDRESS as string,",
						"          MACADDRESS as string,",
						"          ORDERNO as string,",
						"          ISMANUALHIST as string,",
						"          ISNOTLOCALHIST as string,",
						"          LEGALENTITYID as long,",
						"          OLDDEPNAME as string,",
						"          JOBID as long,",
						"          NOTE as string,",
						"          INSURETYPEID as long,",
						"          LABOURCONDITION as string,",
						"          ISMULT as string,",
						"          MULTYEAR as decimal(18,4),",
						"          HISTREASON as string,",
						"          HISTREASONNAMES as string,",
						"          TOTALWAGE as decimal(18,4),",
						"          EVOLVEWAGE as decimal(18,4),",
						"          CALCPERCENT as decimal(18,4),",
						"          GRADETYPEID as long,",
						"          LEVELNO as long,",
						"          FTEMAINID as long",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> employeeHist",
						"source(output(",
						"          company_key as integer,",
						"          company_code as string,",
						"          company_name as string,",
						"          is_active as boolean,",
						"          source_system_code as string,",
						"          source_created_date as timestamp,",
						"          source_updated_date as timestamp,",
						"          dw_created_date as timestamp,",
						"          dw_updated_date as timestamp",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> company",
						"source(output(",
						"          employee_key as long,",
						"          source_system_code as string,",
						"          source_employee_id as string,",
						"          company_key as integer,",
						"          employee_code as string,",
						"          registration_number as string,",
						"          family_name as string,",
						"          last_name as string,",
						"          first_name as string,",
						"          gender as string,",
						"          birth_date as date,",
						"          nationality_id as integer,",
						"          employment_status as string,",
						"          effective_start_date as timestamp,",
						"          effective_end_date as timestamp,",
						"          is_current_record as boolean,",
						"          source_created_date as timestamp,",
						"          source_updated_date as timestamp,",
						"          dw_created_date as timestamp,",
						"          dw_updated_date as timestamp,",
						"          etl_batch_id as long",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> employee",
						"source(output(",
						"          department_key as integer,",
						"          source_system_code as string,",
						"          source_department_id as string,",
						"          company_key as integer,",
						"          department_code as string,",
						"          department_name as string,",
						"          parent_department_key as integer,",
						"          department_level as string,",
						"          is_active as boolean,",
						"          effective_start_date as timestamp,",
						"          effective_end_date as timestamp,",
						"          is_current_record as boolean,",
						"          dw_created_date as timestamp,",
						"          dw_updated_date as timestamp",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> department",
						"source(output(",
						"          position_key as integer,",
						"          source_system_code as string,",
						"          source_position_id as string,",
						"          company_key as integer,",
						"          position_code as string,",
						"          position_name as string,",
						"          position_category as string,",
						"          position_level as string,",
						"          is_management as boolean,",
						"          is_active as boolean,",
						"          effective_start_date as timestamp,",
						"          effective_end_date as timestamp,",
						"          is_current_record as boolean,",
						"          dw_created_date as timestamp,",
						"          dw_updated_date as timestamp",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> position",
						"source(output(",
						"          grade_key as integer,",
						"          grade_id as integer,",
						"          code as string,",
						"          grade_no as integer,",
						"          name as string,",
						"          is_active as boolean,",
						"          source_system_code as string,",
						"          source_created_date as timestamp,",
						"          source_updated_date as timestamp,",
						"          dw_created_date as timestamp,",
						"          dw_updated_date as timestamp",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> grade",
						"source(output(",
						"          LEVELID as long,",
						"          CODE as string,",
						"          NAME as string,",
						"          ISACTIVE as string,",
						"          CREATED as string,",
						"          CREATEDBY as string,",
						"          UPDATED as string,",
						"          UPDATEDBY as string,",
						"          IPADDRESS as string,",
						"          MACADDRESS as string,",
						"          TSTAMP as timestamp,",
						"          MASTERID as long,",
						"          ISMASTER as string,",
						"          source_system_code as string,",
						"          source_created_date as timestamp,",
						"          source_updated_date as timestamp,",
						"          dw_created_date as timestamp,",
						"          dw_updated_date as timestamp,",
						"          level_id as long,",
						"          is_active as boolean",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> level",
						"employeeHist, company join(COMPANYID == company_code,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> joinCompany",
						"joinLevel derive(source_system_code = 0,",
						"          is_current_position = 1,",
						"          is_active_employment = 1,",
						"          begin_date = toDate(BEGINDATE, 'yyyy-MM-dd'),",
						"          end_date = toDate(ENDDATE, 'yyyy-MM-dd'),",
						"          source_history_id = HISTORYID,",
						"          source_order_id = ORDERID,",
						"          order_type = ORDERTYPE,",
						"          order_number = ORDERNO,",
						"          level_number = employeeHist@LEVELID,",
						"          base_wage = BASEWAGE,",
						"          base_wage_currency = BASEWAGECURRCODE,",
						"          insurance_type_id = INSURETYPEID,",
						"          labour_condition = LABOURCONDITION,",
						"          source_created_date = toTimestamp(employeeHist@CREATED, 'yyyy.MM.dd HH:mm:ss'),",
						"          source_updated_date = toTimestamp(employeeHist@UPDATED, 'yyyy.MM.dd HH:mm:ss'),",
						"          dw_created_date = currentUTC(),",
						"          dw_updated_date = currentUTC(),",
						"          etl_batch_id = toLong(currentUTC())) ~> sourcesystemcode",
						"sourcesystemcode alterRow(upsertIf(!isNull(source_history_id))) ~> alterRow1",
						"joinCompany, selectEmployee join(toString(EMPID) == toString(source_employee_id),",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> joinEmployee",
						"derivedColumn1, department join(toString(DEPID) == source_department_id,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> joinDepart",
						"joinDepart, position join(toString(POSITIONID) == source_position_id,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> joinPosition",
						"joinPosition, grade join(GRADEID == grade_id,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> joinGrade",
						"joinGrade, level join(employeeHist@LEVELID == level@LEVELID,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> joinLevel",
						"joinEmployee derive({emp_left } = toString(EMPID),",
						"          emp_right = toString(source_employee_id)) ~> derivedColumn1",
						"employee select(mapColumn(",
						"          employee_key,",
						"          source_system_code,",
						"          source_employee_id,",
						"          company_key,",
						"          employee_code",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> selectEmployee",
						"selectEmployee filter(source_employee_id=='18096') ~> filter1",
						"alterRow1 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:true,",
						"     upsertable:true,",
						"     keys:['source_history_id'],",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> sink1"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/Dataset_Source')]",
				"[concat(variables('factoryId'), '/datasets/Dataset_Sink')]",
				"[concat(variables('factoryId'), '/linkedServices/linkedService_err')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/dwh_df_position')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "Dataset_Source",
								"type": "DatasetReference"
							},
							"name": "source1"
						},
						{
							"dataset": {
								"referenceName": "Dataset_Source",
								"type": "DatasetReference"
							},
							"name": "source2"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "Dataset_Sink",
								"type": "DatasetReference"
							},
							"name": "sink1",
							"rejectedDataLinkedService": {
								"referenceName": "linkedService_err",
								"type": "LinkedServiceReference"
							}
						}
					],
					"transformations": [
						{
							"name": "join1"
						},
						{
							"name": "sourcesystemcode"
						},
						{
							"name": "renamecols"
						},
						{
							"name": "select1"
						},
						{
							"name": "alterRow1"
						}
					],
					"scriptLines": [
						"source(output(",
						"          POSITIONID as long,",
						"          COMPANYID as string,",
						"          DEPID as string,",
						"          POSGROUPID as long,",
						"          CODE as string,",
						"          NAME as string,",
						"          EMPLOYMENTTYPEID as long,",
						"          GRADEID as long,",
						"          DIRECTPOSITIONID as long,",
						"          NONDIRECTPOSITIONID as long,",
						"          REPORTPOSITIONID as long,",
						"          GOAL as string,",
						"          CHARACTERISTIC as string,",
						"          VACANCYDAYS as long,",
						"          LABOURCONDITION as string,",
						"          ISACTIVE as string,",
						"          CREATED as string,",
						"          CREATEDBY as string,",
						"          UPDATED as string,",
						"          UPDATEDBY as string,",
						"          IPADDRESS as string,",
						"          MACADDRESS as string,",
						"          TSTAMP as timestamp,",
						"          JOBDESCID as long,",
						"          JOBID as long,",
						"          TYPE as string,",
						"          POSITIONOCCID as long,",
						"          POSLEVEL as long,",
						"          JDECOSTCENTER as string,",
						"          JDE_F0006_CO as string,",
						"          JDE_F0006_RP01 as string,",
						"          JDE_F0006_RP02 as string,",
						"          POSCATEGORYID as long",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     waterMarkColumn: 'POSITIONID',",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table',",
						"     mode: 'read') ~> source1",
						"source(output(",
						"          company_key as integer,",
						"          company_code as string,",
						"          company_name as string,",
						"          is_active as boolean,",
						"          source_system_code as string,",
						"          source_created_date as timestamp,",
						"          source_updated_date as timestamp,",
						"          dw_created_date as timestamp,",
						"          dw_updated_date as timestamp",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> source2",
						"source1, source2 join(COMPANYID == company_code,",
						"     joinType:'inner',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> join1",
						"join1 derive(COMPANYID = iif(isNull(COMPANYID), 'MCK', COMPANYID),",
						"          source_system_code = 0,",
						"          ISACTIVE_INT = iif(ISACTIVE=='Y', 1, 0),",
						"          company_key = company_key) ~> sourcesystemcode",
						"sourcesystemcode derive(source_position_id = toString(POSITIONID),",
						"          position_code = CODE,",
						"          position_name = NAME,",
						"          position_category = TYPE,",
						"          position_level = toString(POSLEVEL),",
						"          is_management = toInteger(iif(POSLEVEL <= 2, 1, 0)),",
						"          is_active = toInteger(ISACTIVE_INT),",
						"          effective_start_date = iif(isNull(CREATED), currentUTC(), toTimestamp(CREATED, 'yyyy.MM.dd HH:mm:ss')),",
						"          effective_end_date = iif(isNull(UPDATED), toTimestamp('9999-12-31T00:00:00Z'), toTimestamp(UPDATED, 'yyyy.MM.dd HH:mm:ss')),",
						"          is_current_record = toInteger(1),",
						"          dw_created_date = currentTimestamp(),",
						"          dw_updated_date = currentTimestamp()) ~> renamecols",
						"renamecols select(mapColumn(",
						"          source_system_code,",
						"          source_position_id,",
						"          company_key,",
						"          position_code,",
						"          position_name,",
						"          position_category,",
						"          position_level,",
						"          is_management,",
						"          is_active,",
						"          effective_start_date,",
						"          effective_end_date,",
						"          is_current_record,",
						"          dw_created_date,",
						"          dw_updated_date",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> select1",
						"select1 alterRow(upsertIf(!isNull(source_position_id))) ~> alterRow1",
						"alterRow1 sink(allowSchemaDrift: true,",
						"     validateSchema: true,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:true,",
						"     upsertable:true,",
						"     keys:['source_position_id'],",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError',",
						"     mapColumn(",
						"          source_system_code,",
						"          source_position_id,",
						"          company_key,",
						"          position_code,",
						"          position_name,",
						"          position_category,",
						"          position_level,",
						"          is_management,",
						"          is_active,",
						"          effective_start_date,",
						"          effective_end_date,",
						"          is_current_record,",
						"          dw_created_date,",
						"          dw_updated_date",
						"     )) ~> sink1"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/Dataset_Source')]",
				"[concat(variables('factoryId'), '/datasets/Dataset_Sink')]",
				"[concat(variables('factoryId'), '/linkedServices/linkedService_err')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/dwh_df_sigrade')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "Dataset_Source",
								"type": "DatasetReference"
							},
							"name": "source1"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "Dataset_Sink",
								"type": "DatasetReference"
							},
							"name": "sink1"
						}
					],
					"transformations": [
						{
							"name": "transform1"
						},
						{
							"name": "select1"
						},
						{
							"name": "alterRow1"
						}
					],
					"scriptLines": [
						"source(output(",
						"          GRADEID as long,",
						"          CODE as string,",
						"          GRADENO as long,",
						"          NAME as string,",
						"          ISACTIVE as string,",
						"          CREATED as string,",
						"          CREATEDBY as string,",
						"          UPDATED as string,",
						"          UPDATEDBY as string,",
						"          IPADDRESS as string,",
						"          MACADDRESS as string,",
						"          TSTAMP as timestamp,",
						"          MASTERID as long,",
						"          ISMASTER as string,",
						"          GRADETYPEID as long",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> source1",
						"source1 derive(is_active = 1,",
						"          source_system_code = '0',",
						"          source_created_date = toTimestamp(CREATED, 'yyyy.MM.dd HH:mm:ss'),",
						"          source_updated_date = toTimestamp(UPDATED, 'yyyy.MM.dd HH:mm:ss'),",
						"          dw_created_date = currentUTC(),",
						"          dw_updated_date = currentUTC(),",
						"          grade_id = GRADEID,",
						"          grade_no = GRADENO,",
						"          code = CODE,",
						"          name = NAME) ~> transform1",
						"transform1 select(mapColumn(",
						"          grade_id,",
						"          grade_no,",
						"          code,",
						"          name,",
						"          is_active,",
						"          source_system_code,",
						"          source_created_date,",
						"          source_updated_date,",
						"          dw_created_date,",
						"          dw_updated_date",
						"     ),",
						"     skipDuplicateMapInputs: false,",
						"     skipDuplicateMapOutputs: false) ~> select1",
						"select1 alterRow(upsertIf(!isNull(grade_id))) ~> alterRow1",
						"alterRow1 sink(allowSchemaDrift: true,",
						"     validateSchema: true,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:true,",
						"     upsertable:true,",
						"     keys:['grade_id'],",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> sink1"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/Dataset_Source')]",
				"[concat(variables('factoryId'), '/datasets/Dataset_Sink')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/dwh_df_silevel')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "Dataset_Source",
								"type": "DatasetReference"
							},
							"name": "source1"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "Dataset_Sink",
								"type": "DatasetReference"
							},
							"name": "sinkDimLevel"
						}
					],
					"transformations": [
						{
							"name": "transform1"
						},
						{
							"name": "select1"
						},
						{
							"name": "alterRow1"
						}
					],
					"scriptLines": [
						"source(output(",
						"          LEVELID as long,",
						"          CODE as string,",
						"          NAME as string,",
						"          ISACTIVE as string,",
						"          CREATED as string,",
						"          CREATEDBY as string,",
						"          UPDATED as string,",
						"          UPDATEDBY as string,",
						"          IPADDRESS as string,",
						"          MACADDRESS as string,",
						"          TSTAMP as timestamp,",
						"          MASTERID as long,",
						"          ISMASTER as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> source1",
						"source1 derive(source_system_code = '0',",
						"          source_created_date = toTimestamp(CREATED, 'yyyy.MM.dd HH:mm:ss'),",
						"          source_updated_date = toTimestamp(UPDATED, 'yyyy.MM.dd HH:mm:ss'),",
						"          dw_created_date = currentUTC(),",
						"          dw_updated_date = currentUTC(),",
						"          level_id = LEVELID,",
						"          is_active = toInteger(1),",
						"          level_name = NAME,",
						"          level_code = CODE) ~> transform1",
						"transform1 select(skipDuplicateMapInputs: false,",
						"     skipDuplicateMapOutputs: false) ~> select1",
						"select1 alterRow(upsertIf(!isNull(level_id))) ~> alterRow1",
						"alterRow1 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:true,",
						"     upsertable:true,",
						"     keys:['level_id'],",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> sinkDimLevel"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/Dataset_Source')]",
				"[concat(variables('factoryId'), '/datasets/Dataset_Sink')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/default')]",
			"type": "Microsoft.DataFactory/factories/managedVirtualNetworks",
			"apiVersion": "2018-06-01",
			"properties": {},
			"dependsOn": []
		}
	]
}