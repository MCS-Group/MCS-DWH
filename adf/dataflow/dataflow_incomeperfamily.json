{
	"name": "dataflow_incomeperfamily",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "Adls_Json_Raw",
						"type": "DatasetReference"
					},
					"name": "source1"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "ADLS_Raw_CSV",
						"type": "DatasetReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "select1"
				},
				{
					"name": "flatten3"
				},
				{
					"name": "derivedColumn3"
				},
				{
					"name": "parse1"
				},
				{
					"name": "derivedColumn1"
				},
				{
					"name": "flatten4"
				}
			],
			"scriptLines": [
				"source(output(",
				"          class as string,",
				"          dimension as (ContentsCode as (category as (index as (EliminatedValue as boolean), label as (EliminatedValue as string), unit as (EliminatedValue as (base as string, decimals as short))), extension as (elimination as boolean), label as string), {Орлогын төрөл} as (category as (index as ({0} as boolean), label as ({0} as string)), extension as (elimination as boolean, show as string), label as string), {Суурьшил} as (category as (index as ({0} as boolean), label as ({0} as string)), extension as (elimination as boolean, show as string), label as string), {Улирал} as (category as (index as ({0} as boolean, {1} as boolean, {10} as short, {11} as short, {12} as short, {13} as short, {14} as short, {15} as short, {16} as short, {17} as short, {18} as short, {19} as short, {2} as short, {20} as short, {21} as short, {22} as short, {23} as short, {24} as short, {25} as short, {26} as short, {27} as short, {28} as short, {29} as short, {3} as short, {30} as short, {31} as short, {32} as short, {33} as short, {34} as short, {35} as short, {36} as short, {37} as short, {38} as short, {39} as short, {4} as short, {40} as short, {41} as short, {42} as short, {43} as short, {44} as short, {45} as short, {46} as short, {47} as short, {48} as short, {49} as short, {5} as short, {50} as short, {51} as short, {52} as short, {53} as short, {54} as short, {55} as short, {56} as short, {57} as short, {58} as short, {59} as short, {6} as short, {60} as short, {61} as short, {62} as short, {63} as short, {64} as short, {65} as short, {66} as short, {67} as short, {68} as short, {69} as short, {7} as short, {70} as short, {71} as short, {72} as short, {73} as short, {74} as short, {75} as short, {76} as short, {77} as short, {78} as short, {79} as short, {8} as short, {80} as short, {81} as short, {82} as short, {9} as short), label as ({0} as string, {1} as string, {10} as string, {11} as string, {12} as string, {13} as string, {14} as string, {15} as string, {16} as string, {17} as string, {18} as string, {19} as string, {2} as string, {20} as string, {21} as string, {22} as string, {23} as string, {24} as string, {25} as string, {26} as string, {27} as string, {28} as string, {29} as string, {3} as string, {30} as string, {31} as string, {32} as string, {33} as string, {34} as string, {35} as string, {36} as string, {37} as string, {38} as string, {39} as string, {4} as string, {40} as string, {41} as string, {42} as string, {43} as string, {44} as string, {45} as string, {46} as string, {47} as string, {48} as string, {49} as string, {5} as string, {50} as string, {51} as string, {52} as string, {53} as string, {54} as string, {55} as string, {56} as string, {57} as string, {58} as string, {59} as string, {6} as string, {60} as string, {61} as string, {62} as string, {63} as string, {64} as string, {65} as string, {66} as string, {67} as string, {68} as string, {69} as string, {7} as string, {70} as string, {71} as string, {72} as string, {73} as string, {74} as string, {75} as string, {76} as string, {77} as string, {78} as string, {79} as string, {8} as string, {80} as string, {81} as string, {82} as string, {9} as string)), extension as (elimination as boolean, show as string), label as string)),",
				"          extension as (contact as (raw as string)[], noteMandatory as ({0} as boolean), px as (aggregallowed as boolean, decimals as boolean, language as string, matrix as string, {official-statistics} as boolean, {subject-code} as string, tableid as string)),",
				"          id as string[],",
				"          label as string,",
				"          note as string[],",
				"          size as short[],",
				"          source as string,",
				"          updated as timestamp,",
				"          value as double[],",
				"          version as double",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     documentForm: 'documentPerLine') ~> source1",
				"source1 select(mapColumn(",
				"          indexMap = dimension.{Улирал}.category.index,",
				"          labelMap = dimension.{Улирал}.category.label,",
				"          value",
				"     ),",
				"     skipDuplicateMapInputs: false,",
				"     skipDuplicateMapOutputs: false) ~> select1",
				"derivedColumn3 foldDown(unroll(value),",
				"     mapColumn(",
				"          dimension,",
				"          value,",
				"          sar",
				"     ),",
				"     skipDuplicateMapInputs: false,",
				"     skipDuplicateMapOutputs: false) ~> flatten3",
				"parse1 derive(sar = array(dimension.{Сар}.category.label)) ~> derivedColumn3",
				"source1 parse(dimension = dimension.{Улирал}.category.index ? [string, integer],",
				"     format: 'json',",
				"     documentForm: 'arrayOfDocuments') ~> parse1",
				"flatten4 derive(indices = array(indexMap),",
				"          labels = array(labelMap)) ~> derivedColumn1",
				"select1 foldDown(unroll(value, value),",
				"     mapColumn(",
				"          indexMap,",
				"          labelMap,",
				"          value",
				"     ),",
				"     skipDuplicateMapInputs: false,",
				"     skipDuplicateMapOutputs: false) ~> flatten4",
				"flatten3 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     umask: 0022,",
				"     preCommands: [],",
				"     postCommands: [],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> sink1"
			]
		}
	}
}